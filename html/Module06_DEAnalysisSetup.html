<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2023-09-29" />

<title>Differential Expression (DE) Introduction</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_Sequence_QC.html">Sequence QC</a>
    </li>
    <li>
      <a href="Module02b_Trimming.html">Trimming</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03a_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module03b_Alignment.html">Alignment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module04_Alignment_QC_and_Quantification.html">Alignment QC and Quantification</a>
    </li>
    <li>
      <a href="Module05_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">DE Introduction</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DE Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">DE Normalization and Modeling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">DE Testing</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visualization</a>
    </li>
    <li>
      <a href="Module12_DEAnnotations.html">DE Annotation</a>
    </li>
    <li>
      <a href="R_bonus_content.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Differential Expression (DE)
Introduction</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2023-09-29</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<p>In this module, we will learn:</p>
<ul>
<li>How to set up a differential expression analysis, using reproducible
research principles<br />
</li>
<li>What is DESeq2 and why it is widely used for differential expression
comparisons</li>
<li>How to load and review gene count data</li>
</ul>
<p><br></p>
<div id="differential-expression-workflow"
class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Differential Expression Workflow</h1>
<p>Today we will proceed through key steps in a differential expression
analysis, starting from a count table that’s similar to what you
generated in the first half of the workshop and one of the outputs
included in the <a
href="https://brcf.medicine.umich.edu/cores/advanced-genomics/data-delivery/">data
that the Advanced Genomics Core delivers</a> for RNA-seq libraries.</p>
<p><img src="images/wayfinder/wayfinder-DEAnalysisSetup.png" alt="wayfinder" style="width: 1000px;"/></p>
</div>
<div id="getting-started-in-rstudio" class="section level1">
<h1>Getting Started in RStudio</h1>
<div id="log-on-to-rstudio-server" class="section level2">
<h2>Log on to RStudio Server</h2>
<p>Open a web browser to the following URL: <a
href="http://bfx-workshop01.med.umich.edu">http://bfx-workshop01.med.umich.edu</a></p>
<p>You should now be looking at a page that will allow you to login to
the RStudio server:</p>
<p><img src="images/rstudio_login_screen.png" alt="rstudio default session" style="width: 1000px;"/></p>
<p>Enter your user credentials and click <kbd>Sign In</kbd>. The
credentials are the same used earlier in the workshop and were provided
via an email entitled “UM BioinfCore Workshop Login”.</p>
<p>However, if you forget yours, a helper can retrieve it for you if you
ask in Slack. You should now see the RStudio interface:</p>
<p><img src="images/rstudio_session_default.png" alt="rstudio default session" style="width:1000px;"/></p>
<p><br></p>
</div>
<div id="what-are-we-working-towards" class="section level2">
<h2>What are we working towards?</h2>
<p>To refresh ourselves on the interface of RStudio, look in the lower
right pane, that has a list of files and folders. Click on the
<code>RSD_R</code> folder and then click on the
<code>WelcomeToRSD.R</code> script to open it.</p>
<p>There should now be four panes in your RStudio window, with the
<code>WelcomeToRSD</code> script in the upper left pane, this is the
“Source” or “Scripts” pane. It displays the code that we will write to
perform our analysis.</p>
<p><img src="images/WelcomeScriptOpened.png" alt="rstudio default session" style="width:1000px;"/></p>
<p>In the Scripts pane, there is a line of icons, towards the right side
of the pane there is a <kbd>Run</kbd> button. First highlight all the
code in the Source pane, and then click <kbd>Run</kbd>.</p>
<p><br></p>
<p><strong>Checkpoint</strong></p>
<p>What just happened?</p>
<ol style="list-style-type: decimal">
<li><p>We see in that our code has been run in the Console panel,
including some warning messages.</p></li>
<li><p>We see that a number of objects were created in our Environment
panel including an object named <code>DE_results</code>.</p></li>
<li><p>We see that the Plot tab now has a volcano plot displayed - Note:
if the plot is not displayed, you may need to expand the right panel
boundary before re-running the last line of the script</p></li>
</ol>
<p><strong>What does this volcano plot show?</strong></p>
<p><em>Now that we have an idea of what we are working towards, any
questions?</em></p>
<p><br> <br></p>
</div>
<div id="create-an-rstudio-project" class="section level2">
<h2>Create an RStudio Project</h2>
<p>Just like in Computational Foundation workshop, let’s start our
analysis by creating a project where we can store our data, scripts and
outputs.</p>
<ol style="list-style-type: decimal">
<li>To create a project, go to the <kbd>File</kbd> menu, and click
<kbd>New Project…</kbd>. The following window will appear:</li>
</ol>
<p><img src="images/new_project_window.png" alt="new project window" style="width: 600px;"/></p>
<ol start="2" style="list-style-type: decimal">
<li><p>In this window, select <kbd>Existing Directory</kbd>. For
“Project working directory”, click <kbd>Browse…</kbd>, select the
“RSD_R” folder, and click <kbd>Choose</kbd>. This will use the
<code>/home/workshop/user/RSD_R</code> folder as the project
directory.</p></li>
<li><p>Finally click <kbd>Create Project</kbd>. In the “Files” tab of
your output pane (more about the RStudio layout in a moment), you should
see an RStudio project file, <strong>RSD_R.Rproj</strong>. All RStudio
projects end with the “<strong>.Rproj</strong>” file extension.</p></li>
</ol>
<p>Note that there is already a <code>data/</code> folder which contains
the data we will use for these lessons.</p>
</div>
<div id="creating-an-r-script" class="section level2">
<h2>Creating an R script</h2>
<p>Let’s create an R script file:</p>
<ul>
<li>Click the <kbd>File</kbd> menu and select <kbd>New File</kbd> and
then <kbd>R Script</kbd>.</li>
<li>Before we go any further, save your script by clicking the save/disk
icon that is in the bar above the first line in the script editor, or
click the <kbd>File</kbd> menu and select <kbd>Save</kbd>.</li>
<li>In the “Save File” window that opens, select <kbd>New Folder</kbd>.
Name it <strong>“scripts”</strong>.</li>
<li>Finally, name your file <strong>“diffex”</strong> in the “File name”
field.</li>
</ul>
<p>The new script <strong>diffex.R</strong> is now in the
<code>scripts</code> folder. You can see that by clicking the
<code>scripts</code> folder in the “Files” pane. And you can go back up
to the main project folder by clicking the <code>..</code> to the right
of the up arrow in the “Files” pane. By convention, R scripts end with
the file extension <strong>.R</strong>.</p>
</div>
<div id="file-organization-reproducible-research"
class="section level2">
<h2>File organization &amp; reproducible research</h2>
<p>Part of any successful bioinformatics analysis is documentation and
data stewardship, which are important aspects of “reproducible research”
(see: <a
href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1000424">Nobel,
2009</a>).</p>
<p>To follow best practices for file organization for reproducible
research, we should make distinct locations for:</p>
<ul>
<li>Raw data</li>
<li>Code</li>
<li>Output</li>
</ul>
<p>To organize our files , we’ll create some more directories in the
<code>RSD_R</code> folder which is now our project root and current
working directory. We can already see that there a <code>data/</code>
folder and we just created the <code>scripts/</code> folder with the
RStudio GUI. Let’s create an <code>outputs/</code> folder using the
<code>dir.create()</code> function in R.</p>
<pre class="r"><code>dir.create(&#39;outputs&#39;)
dir.create(&#39;outputs/figures&#39;)
dir.create(&#39;outputs/tables&#39;)</code></pre>
<p><strong>Checkpoint</strong>: <em>Please use the green ‘check’ if you
have saved your code file and see the <code>data</code>,
<code>scripts</code>, and <code>outputs</code> directories in the
<code>RSD_R</code> folder and the red ‘x’ if you do not.</em></p>
<blockquote>
<h2 id="reminder-rstudio-code-execution"
class="unlisted unnumbered">Reminder: RStudio code execution</h2>
<p><kbd>Ctrl</kbd>+<kbd>Enter</kbd> is a standard shortcut in RStudio to
send the current line (or selected lines) to the console. If you see
<code>&gt;</code> in the Console, then R has executed the command. If
you see a <code>+</code>, this means that the command is not complete, R
thinks there is more to your command. You can use the <kmd>esc</kmd> to
get out of this state.</p>
</blockquote>
<blockquote>
<h2 id="reminder-object-naming-conventions"
class="unlisted unnumbered">Reminder: Object naming conventions</h2>
<ul>
<li>Cannot start with numbers</li>
<li>Cannot include dashes</li>
<li>Cannot have spaces</li>
<li>Should not be identical to a named function</li>
<li>Dots and underscores can separate parts of names, alternatively
CamelCase accomplishes this</li>
</ul>
</blockquote>
<hr />
</div>
</div>
<div id="tools-for-differential-gene-expression-analysis"
class="section level1">
<h1>Tools for Differential Gene Expression analysis</h1>
<p>As discussed during the webinar, bulk RNA-seq can be used to test for
differential expression between conditions or treatments, using
statistical approaches that are appropriate for biological data.</p>
<p>While there are several tools that can be used for differential
expression comparisons, we will use <a
href="https://bioconductor.org/packages/release/bioc/html/DESeq2.html">DESeq2</a>
in our analysis today.</p>
<p>DESeq2 is one of two tools, along with <a
href="https://bioconductor.org/packages/release/bioc/html/edgeR.html">edgeR</a>,
considered <a
href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-91">‘best
practice’</a> for differential expression comparisons. Both tools apply
similar methods that account for the “shape” of data expected for
RNA-seq and are fairly stringent in calling differentially expressed
genes, lowering the risk of investigating “false positive” genes
(e.g. genes that don’t actually have different expression between
treatment groups and therefore are not relevant to the biological
process).</p>
<p>Additionally, DESeq2 also has an <a
href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">excellent
vignette</a> from Love, Anders, and Huber, from which our workflow is
partially adapted, and is a good resource when analyzing your own data
(see also: <a href="https://doi.org/10.1186/s13059-014-0550-8">Love,
Anders, and Huber. <em>Genome Biology</em>. 2014.</a>).</p>
<div id="deseq2-assumptions-and-requirements" class="section level2">
<h2>DESeq2 assumptions and requirements</h2>
<p>A key assumption of DESeq2 is that <em>biological variance is much
greater than technical variance</em> (which should be true if <a
href="https://www.txgen.tamu.edu/faq/rna-isolation-best-practices/">best
practices</a> for <a
href="https://www.biocompare.com/Bench-Tips/128790-Four-Tips-for-Perfecting-RNA-Isolation/">quality
RNA isolation</a> are followed, including DNase treatment!).</p>
<p>Since calculating variance is key to the statistical approach used
for DESeq2, if we tried to compare treatment groups with only one sample
each, we would get an error (as shown in <a
href="https://support.bioconductor.org/p/89746/">this blog post</a>).
Without replicates, there can’t be statistical significance
(e.g. p-values), but <em>qualitative</em> approaches are an option, like
looking at the top expressed genes after normalization.</p>
<details>
<summary>
<em>Click for additional resources regarding statistical testing and
tool comparison for RNA-seq data</em>
</summary>
To learn more about statistical testing and what distributions best
model the behavior of RNA-seq data, a good resource is this <a
href="https://www.youtube.com/watch?v=HK7WKsL3c2w&amp;feature=youtu.be">EdX
lecture by Rafael Irizarry</a> or this <a
href="https://www.youtube.com/watch?v=C8RNvWu7pAw">lecture by Kasper
Hansen</a>. Another helpful guide is this <a
href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0103207">Comparative
Study for Differential Expression Analysis by Zhang et al.</a> from
2014.
</details>
<p><br></p>
<blockquote>
<h2 id="exercise">Exercise</h2>
<ul>
<li>Post a question that was NOT addressed but that you hope we will
address in the later modules <strong>OR</strong></li>
<li>Add a thumbs up to your favorite comment(s) to upvote it</li>
</ul>
</blockquote>
<hr />
</div>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<div id="load-packages" class="section level2">
<h2>Load Packages</h2>
<p>Several packages have already been installed on the server, so we can
load them into our R session now. To do that we’ll use the
<code>library</code> function to load the required packages.</p>
<pre class="r"><code>library(DESeq2)
library(ggplot2)
library(tidyr)
library(dplyr)
library(matrixStats)
library(ggrepel)
library(pheatmap)
library(RColorBrewer)
library(data.table)</code></pre>
<p><em>Note: We expect to see some red messages in your console while
these packages are loading</em></p>
<p>R/RStudio [AKA Posit] has great resources for getting help, including
<a href="https://posit.co/resources/cheatsheets/">code ‘cheatsheets’</a>
and package vignettes, like for <a
href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidyr</a>.</p>
<p>Since we loaded the libraries into our R session, we can see
documentation out using the <code>?</code> operator.</p>
<pre class="r"><code>?`DESeq2-package`</code></pre>
<p><strong>Checkpoint</strong>: <em>If you see the R documentation for
DESeq2 pop up in your ‘help’ panel on the right, please indicate with
the green ‘check’ button. If not please use the red ‘x’ button.</em></p>
</div>
<div id="read-counts" class="section level2">
<h2>Read Counts</h2>
<p>Another key assumption for DESeq2 is that the analysis will start
with <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#why-un-normalized-counts">un-normalized
counts</a>.</p>
<p>To begin we’ll read in a <strong>raw</strong> count data file,
<code>gene_expected_count.txt</code> which is similar to what would be
generated in the alignment steps (and what you would receive from AGC).
We’ll discuss a few normalizations that can be helpful for understanding
broad patterns in our expression data, but raw data <strong>should
always</strong> be used as an input for DESeq2.</p>
<pre class="r"><code>count_table = read.table(&quot;data/gene_expected_count.txt&quot;, header = TRUE, row.names = 1)</code></pre>
<pre class="r"><code>head(count_table, n=2) # look at the top of the table</code></pre>
<pre><code>                   sample_A sample_B sample_C sample_D sample_E sample_F
ENSMUSG00000000001     1041      905     1296     3481     1283     1921
ENSMUSG00000000003        0        0        0        0        0        0</code></pre>
<p>Now that the file is read into R, note that we’ve created a data
frame that includes ‘gene ids’ in ENSEMBL format as rownames and count
data from twelve different samples.</p>
<p>How many genes were included in our reference? We can get a sense of
the size of our data with the <code>str</code> function.</p>
<pre class="r"><code>str(count_table) # look at the size &amp; structure of the table</code></pre>
<pre><code>&#39;data.frame&#39;:   55492 obs. of  6 variables:
 $ sample_A: int  1041 0 1043 1819 19 18 14972 1 888 402 ...
 $ sample_B: int  905 0 1232 914 11 1 14768 0 607 483 ...
 $ sample_C: int  1296 0 1664 1618 18 4 21026 0 911 744 ...
 $ sample_D: int  3481 0 2690 8618 48 24 22962 0 1689 898 ...
 $ sample_E: int  1283 0 1825 1350 37 1 22263 0 738 811 ...
 $ sample_F: int  1921 0 2720 1222 29 1 23622 0 1180 1261 ...</code></pre>
<p>One important consideration for RNA-seq data is how many genes we
measured in our data and how well we measured them. Both are impacted by
sequencing depth or the number of reads generated per sample.</p>
<p>Generally, for human and mouse experiments the recommendation is
30-40 million reads per sample to capture both highly expressed
(abundant) and lowly expressed (rarer) transcripts in the sample,
assuming ~25,000 protein-coding genes would be expected for a polyA
(mRNA targeting) library prep. However, as the image from Illumina below
shows, sequencing depth has less of an impact than number of replicates
in detecting differentially expressed genes (DEGs).</p>
<div class="float">
<img src="images/de_replicates_img.png" style="width:50.0%"
alt="Illumina’s differential expression recovery across replicate number and sequencing depth" />
<div class="figcaption">Illumina’s differential expression recovery
across replicate number and sequencing depth</div>
</div>
<p><br></p>
<p>How many reads were generated per sample in our data? We can use the
<code>summarize_all</code> function from the dplyr package to determine
the number of reads or “depth” per sample.</p>
<pre class="r"><code>count_table %&gt;% summarize_all(sum)</code></pre>
<pre><code>  sample_A sample_B sample_C sample_D sample_E sample_F
1 30149372 27849704 39153147 49383769 33895207 39253330</code></pre>
</div>
</div>
<div id="getting-help" class="section level1">
<h1>Getting help</h1>
<p>How did we know to use the <code>summarize_all</code> function to sum
each column?</p>
<p>R and RStudio have a strong community component so, as mentioned in
Computational Foundations, if you are getting an error or wondering how
to make a command work or how to perform a specific task, there is
likely already a solution out there. Search engines are your friend,
which is exactly how we found <a
href="https://stackoverflow.com/questions/28873057/sum-across-multiple-columns-with-dplyr">that
approach</a></p>
<p>It can sometimes be a challenge to figure out <em>what to search
for</em>, so some key parts of a successful search are:</p>
<ul>
<li>Package or command run</li>
<li><code>R</code> or <code>Bioconductor</code></li>
<li>The error message if there is one</li>
<li>Version information</li>
</ul>
<p>How to get session information to aid in a search:</p>
<pre class="r"><code>sessionInfo()</code></pre>
<p>Highly recommend using resources like <a
href="https://support.bioconductor.org/">Bioconductor Support</a>, <a
href="https://www.biostars.org/">Biostars</a>, and <a
href="https://stackoverflow.com/questions/tagged/r">Stack Overflow</a>,
including threads on specific packages or common bioinformatic
tasks.</p>
<p>I personally use one or more of these resources <strong>every
day</strong>.</p>
<p>10x Genomics also has a helpful <a
href="https://www.10xgenomics.com/resources/analysis-guides/10-tips-for-biologists-learning-bioinformatics">10
tips for biologists learning bioinformatics</a> included in their
resources.</p>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Set up our compute environment</li>
<li>Learned about the DESeq2 package</li>
<li>Read in a raw count table and saved it as a data frame</li>
</ul>
<p>Now that we have our count data processed, we can move on to
“unblinding” our data, as the sample names are unique identifiers
generated by a sequencing center and not very informative as far as our
experimental conditions.</p>
<hr />
</div>
<div id="optional-content" class="section level1">
<h1>Optional content</h1>
<p>An important note is that there are several bonus content sections on
the instruction pages, like the two below that we will not be covering
in this workshop, but that may have useful context or be helpful when
you review this material.</p>
<details>
<summary>
<em>Click for alternative DESeq2 input options for RSEM outputs</em>
</summary>
The package <code>tximport</code> is another option<a
href="https://support.bioconductor.org/p/90672/">recommended the DESeq2
authors</a> to read in the RSEM expected_counts, as this package allows
for the average transcript length per gene to be used in the DE analysis
and, as <a href="https://support.bioconductor.org/p/88763/">described by
the author</a>, the <code>tximport-to-DESeqDataSet</code> constructor
function round the non-integer data generated by RSEM to whole numbers.
</details>
<br>
<details>
<summary>
<em>Click for comparison of RNA-seq data and microarray data</em>
</summary>
<p>With <a
href="https://www.illumina.com/science/technology/next-generation-sequencing/microarray-rna-seq-comparison.html">higher
sensitivity, greater flexiblity, and decreasing cost</a>, sequencing has
largely replaced microarray assays for measuring gene expression. A key
difference between the platforms is that microarrays measure intensities
and are therefore <em>continous</em> data while the count data from
sequencing is <em>discrete</em>. A more detailed comparison between
microarrays and sequencing technologies/analysis is outlined in <a
href="https://online.stat.psu.edu/stat555/node/30/">the online materials
for Penn State’s STAT555 course</a></p>
</details>
<p><br></p>
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<p>Training resources used to develop materials:</p>
<ul>
<li>HBC DGE setup: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/01_DGE_setup_and_overview.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/01_DGE_setup_and_overview.html</a></li>
<li>HBC Count Normalization: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html</a></li>
<li>DESeq2 standard vignette: <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html"
class="uri">http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html</a></li>
<li>DESeq2 beginners vignette: <a
href="https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf"
class="uri">https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf</a></li>
<li>Bioconductor RNA-seq Workflows: <a
href="https://www.bioconductor.org/help/course-materials/2015/LearnBioconductorFeb2015/B02.1_RNASeq.html"
class="uri">https://www.bioconductor.org/help/course-materials/2015/LearnBioconductorFeb2015/B02.1_RNASeq.html</a></li>
<li>CCDL Gastric cancer training materials: <a
href="https://alexslemonade.github.io/training-modules/RNA-seq/03-gastric_cancer_exploratory.nb.html"
class="uri">https://alexslemonade.github.io/training-modules/RNA-seq/03-gastric_cancer_exploratory.nb.html</a></li>
<li>CCDL Neuroblastoma training materials: <a
href="https://alexslemonade.github.io/training-modules/RNA-seq/05-nb_cell_line_DESeq2.nb.html"
class="uri">https://alexslemonade.github.io/training-modules/RNA-seq/05-nb_cell_line_DESeq2.nb.html</a></li>
</ul>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="Module05_Additional_Details.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a href="Module07_DESeq2Init.html">Next
lesson</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGlmZmVyZW50aWFsIEV4cHJlc3Npb24gKERFKSBJbnRyb2R1Y3Rpb24iCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIGluY2x1ZGVzOgogICAgICAgICAgICAgICAgaW5faGVhZGVyOiBoZWFkZXIuaHRtbAogICAgICAgICAgICB0aGVtZTogcGFwZXIKICAgICAgICAgICAgdG9jOiB0cnVlCiAgICAgICAgICAgIHRvY19kZXB0aDogNAogICAgICAgICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgICAgICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMThweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxMnB4Cn0KPC9zdHlsZT4KCmBgYHtyLCBpbmNsdWRlID0gRkFMU0V9CnNvdXJjZSgiLi4vYmluL2NodW5rLW9wdGlvbnMuUiIpCmtuaXRyX2ZpZ19wYXRoKCIwNi0iKQpgYGAKCkluIHRoaXMgbW9kdWxlLCB3ZSB3aWxsIGxlYXJuOgoKKiBIb3cgdG8gc2V0IHVwIGEgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gYW5hbHlzaXMsIHVzaW5nIHJlcHJvZHVjaWJsZSByZXNlYXJjaCBwcmluY2lwbGVzICAKKiBXaGF0IGlzIERFU2VxMiBhbmQgd2h5IGl0IGlzIHdpZGVseSB1c2VkIGZvciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29ucwoqIEhvdyB0byBsb2FkIGFuZCByZXZpZXcgZ2VuZSBjb3VudCBkYXRhCgo8YnI+CgojIERpZmZlcmVudGlhbCBFeHByZXNzaW9uIFdvcmtmbG93IHsudW5saXN0ZWQgLnVubnVtYmVyZWR9CgpUb2RheSB3ZSB3aWxsIHByb2NlZWQgdGhyb3VnaCBrZXkgc3RlcHMgaW4gYSBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBhbmFseXNpcywgc3RhcnRpbmcgZnJvbSBhIGNvdW50IHRhYmxlIHRoYXQncyBzaW1pbGFyIHRvIHdoYXQgeW91IGdlbmVyYXRlZCBpbiB0aGUgZmlyc3QgaGFsZiBvZiB0aGUgd29ya3Nob3AgYW5kIG9uZSBvZiB0aGUgb3V0cHV0cyBpbmNsdWRlZCBpbiB0aGUgW2RhdGEgdGhhdCB0aGUgQWR2YW5jZWQgR2Vub21pY3MgQ29yZSBkZWxpdmVyc10oaHR0cHM6Ly9icmNmLm1lZGljaW5lLnVtaWNoLmVkdS9jb3Jlcy9hZHZhbmNlZC1nZW5vbWljcy9kYXRhLWRlbGl2ZXJ5LykgZm9yIFJOQS1zZXEgbGlicmFyaWVzLgoKPGltZyBzcmM9ImltYWdlcy93YXlmaW5kZXIvd2F5ZmluZGVyLURFQW5hbHlzaXNTZXR1cC5wbmciIGFsdD0id2F5ZmluZGVyIiBzdHlsZT0id2lkdGg6IDEwMDBweDsiLz4KCiMgR2V0dGluZyBTdGFydGVkIGluIFJTdHVkaW8KCiMjIExvZyBvbiB0byBSU3R1ZGlvIFNlcnZlcgoKT3BlbiBhIHdlYiBicm93c2VyIHRvIHRoZSBmb2xsb3dpbmcgVVJMOiBbaHR0cDovL2JmeC13b3Jrc2hvcDAxLm1lZC51bWljaC5lZHVdKGh0dHA6Ly9iZngtd29ya3Nob3AwMS5tZWQudW1pY2guZWR1KQoKWW91IHNob3VsZCBub3cgYmUgbG9va2luZyBhdCBhIHBhZ2UgdGhhdCB3aWxsIGFsbG93IHlvdSB0byBsb2dpbiB0byB0aGUgUlN0dWRpbyBzZXJ2ZXI6Cgo8aW1nIHNyYz0iaW1hZ2VzL3JzdHVkaW9fbG9naW5fc2NyZWVuLnBuZyIgYWx0PSJyc3R1ZGlvIGRlZmF1bHQgc2Vzc2lvbiIgc3R5bGU9IndpZHRoOiAxMDAwcHg7Ii8+CgpFbnRlciB5b3VyIHVzZXIgY3JlZGVudGlhbHMgYW5kIGNsaWNrIDxrYmQ+U2lnbiBJbjwva2JkPi4gVGhlIGNyZWRlbnRpYWxzIGFyZSB0aGUgc2FtZSB1c2VkIGVhcmxpZXIgaW4gdGhlIHdvcmtzaG9wIGFuZCB3ZXJlIHByb3ZpZGVkIHZpYSBhbiBlbWFpbCBlbnRpdGxlZCAiVU0gQmlvaW5mQ29yZSBXb3Jrc2hvcCBMb2dpbiIuCgpIb3dldmVyLCBpZiB5b3UgZm9yZ2V0IHlvdXJzLCBhIGhlbHBlciBjYW4gcmV0cmlldmUgaXQgZm9yIHlvdSBpZiB5b3UgYXNrIGluIFNsYWNrLiBZb3Ugc2hvdWxkIG5vdyBzZWUgdGhlIFJTdHVkaW8gaW50ZXJmYWNlOgoKPGltZyBzcmM9ImltYWdlcy9yc3R1ZGlvX3Nlc3Npb25fZGVmYXVsdC5wbmciIGFsdD0icnN0dWRpbyBkZWZhdWx0IHNlc3Npb24iIHN0eWxlPSJ3aWR0aDoxMDAwcHg7Ii8+Cgo8YnI+CgojIyBXaGF0IGFyZSB3ZSB3b3JraW5nIHRvd2FyZHM/CgpUbyByZWZyZXNoIG91cnNlbHZlcyBvbiB0aGUgaW50ZXJmYWNlIG9mIFJTdHVkaW8sIGxvb2sgaW4gdGhlIGxvd2VyIHJpZ2h0IHBhbmUsIHRoYXQgaGFzIGEgbGlzdCBvZiBmaWxlcyBhbmQgZm9sZGVycy4gQ2xpY2sgb24gdGhlIGBSU0RfUmAgZm9sZGVyIGFuZCB0aGVuIGNsaWNrIG9uIHRoZSBgV2VsY29tZVRvUlNELlJgIHNjcmlwdCB0byBvcGVuIGl0LgoKVGhlcmUgc2hvdWxkIG5vdyBiZSBmb3VyIHBhbmVzIGluIHlvdXIgUlN0dWRpbyB3aW5kb3csIHdpdGggdGhlIGBXZWxjb21lVG9SU0RgIHNjcmlwdCBpbiB0aGUgdXBwZXIgbGVmdCBwYW5lLCB0aGlzIGlzIHRoZSAiU291cmNlIiBvciAiU2NyaXB0cyIgcGFuZS4gSXQgZGlzcGxheXMgdGhlIGNvZGUgdGhhdCB3ZSB3aWxsIHdyaXRlIHRvIHBlcmZvcm0gb3VyIGFuYWx5c2lzLgoKPGltZyBzcmM9ImltYWdlcy9XZWxjb21lU2NyaXB0T3BlbmVkLnBuZyIgYWx0PSJyc3R1ZGlvIGRlZmF1bHQgc2Vzc2lvbiIgc3R5bGU9IndpZHRoOjEwMDBweDsiLz4KCkluIHRoZSBTY3JpcHRzIHBhbmUsIHRoZXJlIGlzIGEgbGluZSBvZiBpY29ucywgdG93YXJkcyB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgcGFuZSB0aGVyZSBpcyBhIDxrYmQ+UnVuPC9rYmQ+IGJ1dHRvbi4gRmlyc3QgaGlnaGxpZ2h0IGFsbCB0aGUgY29kZSBpbiB0aGUgU291cmNlIHBhbmUsIGFuZCB0aGVuIGNsaWNrIDxrYmQ+UnVuPC9rYmQ+LgoKPGJyPgoKKipDaGVja3BvaW50KioKCldoYXQganVzdCBoYXBwZW5lZD8KCjEuIFdlIHNlZSBpbiB0aGF0IG91ciBjb2RlIGhhcyBiZWVuIHJ1biBpbiB0aGUgQ29uc29sZSBwYW5lbCwgaW5jbHVkaW5nIHNvbWUgd2FybmluZyBtZXNzYWdlcy4KCjEuIFdlIHNlZSB0aGF0IGEgbnVtYmVyIG9mIG9iamVjdHMgd2VyZSBjcmVhdGVkIGluIG91ciBFbnZpcm9ubWVudCBwYW5lbCBpbmNsdWRpbmcgYW4gb2JqZWN0IG5hbWVkIGBERV9yZXN1bHRzYC4KCjEuIFdlIHNlZSB0aGF0IHRoZSBQbG90IHRhYiBub3cgaGFzIGEgdm9sY2FubyBwbG90IGRpc3BsYXllZCAtIE5vdGU6IGlmIHRoZSBwbG90IGlzIG5vdCBkaXNwbGF5ZWQsIHlvdSBtYXkgbmVlZCB0byBleHBhbmQgdGhlIHJpZ2h0IHBhbmVsIGJvdW5kYXJ5IGJlZm9yZSByZS1ydW5uaW5nIHRoZSBsYXN0IGxpbmUgb2YgdGhlIHNjcmlwdAoKKipXaGF0IGRvZXMgdGhpcyB2b2xjYW5vIHBsb3Qgc2hvdz8qKgoKKk5vdyB0aGF0IHdlIGhhdmUgYW4gaWRlYSBvZiB3aGF0IHdlIGFyZSB3b3JraW5nIHRvd2FyZHMsIGFueSBxdWVzdGlvbnM/KgoKPGJyPgo8YnI+CgojIyBDcmVhdGUgYW4gUlN0dWRpbyBQcm9qZWN0CgpKdXN0IGxpa2UgaW4gQ29tcHV0YXRpb25hbCBGb3VuZGF0aW9uIHdvcmtzaG9wLCBsZXQncyBzdGFydCBvdXIgYW5hbHlzaXMgYnkgY3JlYXRpbmcgYSBwcm9qZWN0IHdoZXJlIHdlIGNhbiBzdG9yZSBvdXIgZGF0YSwgc2NyaXB0cyBhbmQgb3V0cHV0cy4KCjEuIFRvIGNyZWF0ZSBhIHByb2plY3QsIGdvIHRvIHRoZSA8a2JkPkZpbGU8L2tiZD4gbWVudSwgYW5kIGNsaWNrIDxrYmQ+TmV3IFByb2plY3QuLi48L2tiZD4uIFRoZSBmb2xsb3dpbmcgd2luZG93IHdpbGwgYXBwZWFyOgoKPGltZyBzcmM9ImltYWdlcy9uZXdfcHJvamVjdF93aW5kb3cucG5nIiBhbHQ9Im5ldyBwcm9qZWN0IHdpbmRvdyIgc3R5bGU9IndpZHRoOiA2MDBweDsiLz4KCjIuIEluIHRoaXMgd2luZG93LCBzZWxlY3QgPGtiZD5FeGlzdGluZyBEaXJlY3Rvcnk8L2tiZD4uIEZvciAiUHJvamVjdCB3b3JraW5nIGRpcmVjdG9yeSIsIGNsaWNrIDxrYmQ+QnJvd3NlLi4uPC9rYmQ+LCBzZWxlY3QgdGhlICJSU0RfUiIgZm9sZGVyLCBhbmQgY2xpY2sgPGtiZD5DaG9vc2U8L2tiZD4uIFRoaXMgd2lsbCB1c2UgdGhlIGAvaG9tZS93b3Jrc2hvcC91c2VyL1JTRF9SYCBmb2xkZXIgYXMgdGhlIHByb2plY3QgZGlyZWN0b3J5LgoKMy4gRmluYWxseSBjbGljayA8a2JkPkNyZWF0ZSBQcm9qZWN0PC9rYmQ+LiBJbiB0aGUgIkZpbGVzIiB0YWIgb2YgeW91ciBvdXRwdXQgcGFuZSAobW9yZSBhYm91dCB0aGUgUlN0dWRpbyBsYXlvdXQgaW4gYSBtb21lbnQpLCB5b3Ugc2hvdWxkIHNlZSBhbiBSU3R1ZGlvIHByb2plY3QgZmlsZSwgKipSU0RfUi5ScHJvaioqLiBBbGwgUlN0dWRpbyBwcm9qZWN0cyBlbmQgd2l0aCB0aGUgIioqLlJwcm9qKioiIGZpbGUgZXh0ZW5zaW9uLgoKTm90ZSB0aGF0IHRoZXJlIGlzIGFscmVhZHkgYSBgZGF0YS9gIGZvbGRlciB3aGljaCBjb250YWlucyB0aGUgZGF0YSB3ZSB3aWxsIHVzZSBmb3IgdGhlc2UgbGVzc29ucy4KCiMjIENyZWF0aW5nIGFuIFIgc2NyaXB0CgpMZXQncyBjcmVhdGUgYW4gUiBzY3JpcHQgZmlsZToKCi0gQ2xpY2sgdGhlIDxrYmQ+RmlsZTwva2JkPiBtZW51IGFuZCBzZWxlY3QgPGtiZD5OZXcgRmlsZTwva2JkPiBhbmQgdGhlbiA8a2JkPlIgU2NyaXB0PC9rYmQ+LgotIEJlZm9yZSB3ZSBnbyBhbnkgZnVydGhlciwgc2F2ZSB5b3VyIHNjcmlwdCBieSBjbGlja2luZyB0aGUgc2F2ZS9kaXNrIGljb24gdGhhdCBpcyBpbiB0aGUgYmFyIGFib3ZlIHRoZSBmaXJzdCBsaW5lIGluIHRoZSBzY3JpcHQgZWRpdG9yLCBvciBjbGljayB0aGUgPGtiZD5GaWxlPC9rYmQ+IG1lbnUgYW5kIHNlbGVjdCA8a2JkPlNhdmU8L2tiZD4uCi0gSW4gdGhlICJTYXZlIEZpbGUiIHdpbmRvdyB0aGF0IG9wZW5zLCBzZWxlY3QgPGtiZD5OZXcgRm9sZGVyPC9rYmQ+LiBOYW1lIGl0ICoqInNjcmlwdHMiKiouCi0gRmluYWxseSwgbmFtZSB5b3VyIGZpbGUgKioiZGlmZmV4IioqIGluIHRoZSAiRmlsZSBuYW1lIiBmaWVsZC4KClRoZSBuZXcgc2NyaXB0ICoqZGlmZmV4LlIqKiBpcyBub3cgaW4gdGhlIGBzY3JpcHRzYCBmb2xkZXIuIFlvdSBjYW4gc2VlIHRoYXQgYnkgY2xpY2tpbmcgdGhlIGBzY3JpcHRzYCBmb2xkZXIgaW4gdGhlICJGaWxlcyIgcGFuZS4gQW5kIHlvdSBjYW4gZ28gYmFjayB1cCB0byB0aGUgbWFpbiBwcm9qZWN0IGZvbGRlciBieSBjbGlja2luZyB0aGUgYC4uYCB0byB0aGUgcmlnaHQgb2YgdGhlIHVwIGFycm93IGluIHRoZSAiRmlsZXMiIHBhbmUuIEJ5IGNvbnZlbnRpb24sIFIgc2NyaXB0cyBlbmQgd2l0aCB0aGUgZmlsZSBleHRlbnNpb24gKiouUioqLgoKCiMjIEZpbGUgb3JnYW5pemF0aW9uICYgcmVwcm9kdWNpYmxlIHJlc2VhcmNoCgpQYXJ0IG9mIGFueSBzdWNjZXNzZnVsIGJpb2luZm9ybWF0aWNzIGFuYWx5c2lzIGlzIGRvY3VtZW50YXRpb24gYW5kIGRhdGEgc3Rld2FyZHNoaXAsIHdoaWNoIGFyZSBpbXBvcnRhbnQgYXNwZWN0cyBvZiAicmVwcm9kdWNpYmxlIHJlc2VhcmNoIiAoc2VlOiBbTm9iZWwsIDIwMDldKGh0dHBzOi8vam91cm5hbHMucGxvcy5vcmcvcGxvc2NvbXBiaW9sL2FydGljbGU/aWQ9MTAuMTM3MS9qb3VybmFsLnBjYmkuMTAwMDQyNCkpLgoKVG8gZm9sbG93IGJlc3QgcHJhY3RpY2VzIGZvciBmaWxlIG9yZ2FuaXphdGlvbiBmb3IgcmVwcm9kdWNpYmxlIHJlc2VhcmNoLCB3ZSBzaG91bGQgbWFrZSBkaXN0aW5jdCBsb2NhdGlvbnMgZm9yOgoKKiBSYXcgZGF0YQoqIENvZGUKKiBPdXRwdXQKCgpUbyBvcmdhbml6ZSBvdXIgZmlsZXMgLCB3ZSdsbCBjcmVhdGUgc29tZSBtb3JlIGRpcmVjdG9yaWVzIGluIHRoZSBgUlNEX1JgIGZvbGRlciB3aGljaCBpcyBub3cgb3VyIHByb2plY3Qgcm9vdCBhbmQgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeS4gV2UgY2FuIGFscmVhZHkgc2VlIHRoYXQgdGhlcmUgYSBgZGF0YS9gIGZvbGRlciBhbmQgd2UganVzdCBjcmVhdGVkIHRoZSBgc2NyaXB0cy9gIGZvbGRlciB3aXRoIHRoZSBSU3R1ZGlvIEdVSS4gTGV0J3MgY3JlYXRlIGFuIGBvdXRwdXRzL2AgZm9sZGVyIHVzaW5nIHRoZSBgZGlyLmNyZWF0ZSgpYCBmdW5jdGlvbiBpbiBSLgoKYGBge3IgY3JlYXRlX2RpcnMsIGV2YWwgPSBGQUxTRX0KZGlyLmNyZWF0ZSgnb3V0cHV0cycpCmRpci5jcmVhdGUoJ291dHB1dHMvZmlndXJlcycpCmRpci5jcmVhdGUoJ291dHB1dHMvdGFibGVzJykKYGBgCgoqKkNoZWNrcG9pbnQqKjogKlBsZWFzZSB1c2UgdGhlIGdyZWVuICdjaGVjaycgaWYgeW91IGhhdmUgc2F2ZWQgeW91ciBjb2RlIGZpbGUgYW5kIHNlZSB0aGUgYGRhdGFgLCBgc2NyaXB0c2AsIGFuZCBgb3V0cHV0c2AgZGlyZWN0b3JpZXMgaW4gdGhlIGBSU0RfUmAgZm9sZGVyIGFuZCB0aGUgcmVkICd4JyBpZiB5b3UgZG8gbm90LioKCj4gIyMgUmVtaW5kZXI6IFJTdHVkaW8gY29kZSBleGVjdXRpb24gey51bmxpc3RlZCAudW5udW1iZXJlZH0KPgo+IDxrYmQ+Q3RybDwva2JkPis8a2JkPkVudGVyPC9rYmQ+IGlzIGEgc3RhbmRhcmQgc2hvcnRjdXQgaW4gUlN0dWRpbyB0byBzZW5kIHRoZSBjdXJyZW50IGxpbmUgKG9yIHNlbGVjdGVkIGxpbmVzKSB0byB0aGUgY29uc29sZS4gSWYgeW91IHNlZSBgPmAgaW4gdGhlIENvbnNvbGUsIHRoZW4gUiBoYXMgZXhlY3V0ZWQgdGhlIGNvbW1hbmQuIElmIHlvdSBzZWUgYSBgK2AsIHRoaXMgbWVhbnMgdGhhdCB0aGUgY29tbWFuZCBpcyBub3QgY29tcGxldGUsIFIgdGhpbmtzIHRoZXJlIGlzIG1vcmUgdG8geW91ciBjb21tYW5kLiBZb3UgY2FuIHVzZSB0aGUgPGttZD5lc2M8L2ttZD4gdG8gZ2V0IG91dCBvZiB0aGlzIHN0YXRlLgoKPiAjIyBSZW1pbmRlcjogT2JqZWN0IG5hbWluZyBjb252ZW50aW9ucyB7LnVubGlzdGVkIC51bm51bWJlcmVkfQo+ICogQ2Fubm90IHN0YXJ0IHdpdGggbnVtYmVycwo+ICogQ2Fubm90IGluY2x1ZGUgZGFzaGVzCj4gKiBDYW5ub3QgaGF2ZSBzcGFjZXMKPiAqIFNob3VsZCBub3QgYmUgaWRlbnRpY2FsIHRvIGEgbmFtZWQgZnVuY3Rpb24KPiAqIERvdHMgYW5kIHVuZGVyc2NvcmVzIGNhbiBzZXBhcmF0ZSBwYXJ0cyBvZiBuYW1lcywgYWx0ZXJuYXRpdmVseSBDYW1lbENhc2UgYWNjb21wbGlzaGVzIHRoaXMKCi0tLS0KCiMgVG9vbHMgZm9yIERpZmZlcmVudGlhbCBHZW5lIEV4cHJlc3Npb24gYW5hbHlzaXMKCkFzIGRpc2N1c3NlZCBkdXJpbmcgdGhlIHdlYmluYXIsIGJ1bGsgUk5BLXNlcSBjYW4gYmUgdXNlZCB0byB0ZXN0IGZvciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBiZXR3ZWVuIGNvbmRpdGlvbnMgb3IgdHJlYXRtZW50cywgdXNpbmcgc3RhdGlzdGljYWwgYXBwcm9hY2hlcyB0aGF0IGFyZSBhcHByb3ByaWF0ZSBmb3IgYmlvbG9naWNhbCBkYXRhLgoKV2hpbGUgdGhlcmUgYXJlIHNldmVyYWwgdG9vbHMgdGhhdCBjYW4gYmUgdXNlZCBmb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gY29tcGFyaXNvbnMsIHdlIHdpbGwgdXNlIFtERVNlcTJdKGh0dHBzOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvaHRtbC9ERVNlcTIuaHRtbCkgaW4gb3VyIGFuYWx5c2lzIHRvZGF5LgoKREVTZXEyIGlzIG9uZSBvZiB0d28gdG9vbHMsIGFsb25nIHdpdGggW2VkZ2VSXShodHRwczovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvcmVsZWFzZS9iaW9jL2h0bWwvZWRnZVIuaHRtbCksIGNvbnNpZGVyZWQgWydiZXN0IHByYWN0aWNlJ10oaHR0cHM6Ly9ibWNiaW9pbmZvcm1hdGljcy5iaW9tZWRjZW50cmFsLmNvbS9hcnRpY2xlcy8xMC4xMTg2LzE0NzEtMjEwNS0xNC05MSkgZm9yIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGNvbXBhcmlzb25zLiBCb3RoIHRvb2xzIGFwcGx5IHNpbWlsYXIgbWV0aG9kcyB0aGF0IGFjY291bnQgZm9yIHRoZSAic2hhcGUiIG9mIGRhdGEgZXhwZWN0ZWQgZm9yIFJOQS1zZXEgYW5kIGFyZSBmYWlybHkgc3RyaW5nZW50IGluIGNhbGxpbmcgZGlmZmVyZW50aWFsbHkgZXhwcmVzc2VkIGdlbmVzLCBsb3dlcmluZyB0aGUgcmlzayBvZiBpbnZlc3RpZ2F0aW5nICJmYWxzZSBwb3NpdGl2ZSIgZ2VuZXMgKGUuZy4gZ2VuZXMgdGhhdCBkb24ndCBhY3R1YWxseSBoYXZlIGRpZmZlcmVudCBleHByZXNzaW9uIGJldHdlZW4gdHJlYXRtZW50IGdyb3VwcyBhbmQgdGhlcmVmb3JlIGFyZSBub3QgcmVsZXZhbnQgdG8gdGhlIGJpb2xvZ2ljYWwgcHJvY2VzcykuCgpBZGRpdGlvbmFsbHksIERFU2VxMiBhbHNvIGhhcyBhbiBbZXhjZWxsZW50IHZpZ25ldHRlXShodHRwczovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvcmVsZWFzZS9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwpCmZyb20gTG92ZSwgQW5kZXJzLCBhbmQgSHViZXIsIGZyb20gd2hpY2ggb3VyIHdvcmtmbG93IGlzIHBhcnRpYWxseSBhZGFwdGVkLCBhbmQgaXMgYSBnb29kIHJlc291cmNlIHdoZW4gYW5hbHl6aW5nIHlvdXIgb3duIGRhdGEKKHNlZSBhbHNvOiBbTG92ZSwgQW5kZXJzLCBhbmQgSHViZXIuIF9HZW5vbWUgQmlvbG9neV8uIDIwMTQuXShodHRwczovL2RvaS5vcmcvMTAuMTE4Ni9zMTMwNTktMDE0LTA1NTAtOCkpLgoKCiMjIERFU2VxMiBhc3N1bXB0aW9ucyBhbmQgcmVxdWlyZW1lbnRzCgpBIGtleSBhc3N1bXB0aW9uIG9mIERFU2VxMiBpcyB0aGF0ICpiaW9sb2dpY2FsIHZhcmlhbmNlIGlzIG11Y2ggZ3JlYXRlciB0aGFuIHRlY2huaWNhbCB2YXJpYW5jZSogKHdoaWNoIHNob3VsZCBiZSB0cnVlIGlmIFtiZXN0IHByYWN0aWNlc10oaHR0cHM6Ly93d3cudHhnZW4udGFtdS5lZHUvZmFxL3JuYS1pc29sYXRpb24tYmVzdC1wcmFjdGljZXMvKSBmb3IgW3F1YWxpdHkgUk5BIGlzb2xhdGlvbl0oaHR0cHM6Ly93d3cuYmlvY29tcGFyZS5jb20vQmVuY2gtVGlwcy8xMjg3OTAtRm91ci1UaXBzLWZvci1QZXJmZWN0aW5nLVJOQS1Jc29sYXRpb24vKSBhcmUgZm9sbG93ZWQsIGluY2x1ZGluZyBETmFzZSB0cmVhdG1lbnQhKS4KClNpbmNlIGNhbGN1bGF0aW5nIHZhcmlhbmNlIGlzIGtleSB0byB0aGUgc3RhdGlzdGljYWwgYXBwcm9hY2ggdXNlZCBmb3IgREVTZXEyLCBpZiB3ZSB0cmllZCB0byBjb21wYXJlIHRyZWF0bWVudCBncm91cHMgd2l0aCBvbmx5IG9uZSBzYW1wbGUgZWFjaCwgd2Ugd291bGQgZ2V0IGFuIGVycm9yIChhcyBzaG93biBpbiBbdGhpcyBibG9nIHBvc3RdKGh0dHBzOi8vc3VwcG9ydC5iaW9jb25kdWN0b3Iub3JnL3AvODk3NDYvKSkuIFdpdGhvdXQgcmVwbGljYXRlcywgdGhlcmUgY2FuJ3QgYmUgc3RhdGlzdGljYWwgc2lnbmlmaWNhbmNlIChlLmcuIHAtdmFsdWVzKSwgYnV0ICpxdWFsaXRhdGl2ZSogYXBwcm9hY2hlcyBhcmUgYW4gb3B0aW9uLCBsaWtlIGxvb2tpbmcgYXQgdGhlIHRvcCBleHByZXNzZWQgZ2VuZXMgYWZ0ZXIgbm9ybWFsaXphdGlvbi4KCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkNsaWNrIGZvciBhZGRpdGlvbmFsIHJlc291cmNlcyByZWdhcmRpbmcgc3RhdGlzdGljYWwgdGVzdGluZyBhbmQgdG9vbCBjb21wYXJpc29uIGZvciBSTkEtc2VxIGRhdGEqPC9zdW1tYXJ5PgogICAgVG8gbGVhcm4gbW9yZSBhYm91dCBzdGF0aXN0aWNhbCB0ZXN0aW5nIGFuZCB3aGF0IGRpc3RyaWJ1dGlvbnMgYmVzdCBtb2RlbCB0aGUgYmVoYXZpb3Igb2YgUk5BLXNlcSBkYXRhLCBhIGdvb2QgcmVzb3VyY2UgaXMgdGhpcyBbRWRYIGxlY3R1cmUgYnkgUmFmYWVsIElyaXphcnJ5XShodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PUhLN1dLc0wzYzJ3JmZlYXR1cmU9eW91dHUuYmUpIG9yIHRoaXMgW2xlY3R1cmUgYnkgS2FzcGVyIEhhbnNlbl0oaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1DOFJOdld1N3BBdykuIEFub3RoZXIgaGVscGZ1bCBndWlkZSBpcyB0aGlzIFtDb21wYXJhdGl2ZSBTdHVkeSBmb3IgRGlmZmVyZW50aWFsIEV4cHJlc3Npb24gQW5hbHlzaXMgYnkgWmhhbmcgZXQgYWwuXShodHRwczovL2pvdXJuYWxzLnBsb3Mub3JnL3Bsb3NvbmUvYXJ0aWNsZT9pZD0xMC4xMzcxL2pvdXJuYWwucG9uZS4wMTAzMjA3KSBmcm9tIDIwMTQuCjwvZGV0YWlscz4KPGJyPgoKPiAjIyBFeGVyY2lzZQo+Cj4gLSBQb3N0IGEgcXVlc3Rpb24gdGhhdCB3YXMgTk9UIGFkZHJlc3NlZCBidXQgdGhhdCB5b3UgaG9wZSB3ZSB3aWxsIGFkZHJlc3MgaW4gdGhlIGxhdGVyIG1vZHVsZXMgKipPUioqCj4gLSBBZGQgYSB0aHVtYnMgdXAgdG8geW91ciBmYXZvcml0ZSBjb21tZW50KHMpIHRvIHVwdm90ZSBpdAoKLS0tLQoKIyBHZXR0aW5nIHN0YXJ0ZWQKCiMjIExvYWQgUGFja2FnZXMKClNldmVyYWwgcGFja2FnZXMgaGF2ZSBhbHJlYWR5IGJlZW4gaW5zdGFsbGVkIG9uIHRoZSBzZXJ2ZXIsIHNvIHdlIGNhbiBsb2FkIHRoZW0gaW50byBvdXIgUiBzZXNzaW9uIG5vdy4gVG8gZG8gdGhhdCB3ZSdsbCB1c2UgdGhlIGBsaWJyYXJ5YCBmdW5jdGlvbiB0byBsb2FkIHRoZSByZXF1aXJlZCBwYWNrYWdlcy4KCmBgYHtyIE1vZHVsZXMsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9IEZBTFNFLCBldmFsPVRSVUV9CmxpYnJhcnkoREVTZXEyKQpsaWJyYXJ5KGdncGxvdDIpCmxpYnJhcnkodGlkeXIpCmxpYnJhcnkoZHBseXIpCmxpYnJhcnkobWF0cml4U3RhdHMpCmxpYnJhcnkoZ2dyZXBlbCkKbGlicmFyeShwaGVhdG1hcCkKbGlicmFyeShSQ29sb3JCcmV3ZXIpCmxpYnJhcnkoZGF0YS50YWJsZSkKYGBgCgoqTm90ZTogV2UgZXhwZWN0IHRvIHNlZSBzb21lIHJlZCBtZXNzYWdlcyBpbiB5b3VyIGNvbnNvbGUgd2hpbGUgdGhlc2UgcGFja2FnZXMgYXJlIGxvYWRpbmcqCgpSL1JTdHVkaW8gW0FLQSBQb3NpdF0gaGFzIGdyZWF0IHJlc291cmNlcyBmb3IgZ2V0dGluZyBoZWxwLCBpbmNsdWRpbmcgW2NvZGUgJ2NoZWF0c2hlZXRzJ10oaHR0cHM6Ly9wb3NpdC5jby9yZXNvdXJjZXMvY2hlYXRzaGVldHMvKSBhbmQgcGFja2FnZSB2aWduZXR0ZXMsIGxpa2UgZm9yIFt0aWR5cl0oaHR0cHM6Ly9jcmFuLnItcHJvamVjdC5vcmcvd2ViL3BhY2thZ2VzL3RpZHlyL3ZpZ25ldHRlcy90aWR5LWRhdGEuaHRtbCkuCgpTaW5jZSB3ZSBsb2FkZWQgdGhlIGxpYnJhcmllcyBpbnRvIG91ciBSIHNlc3Npb24sIHdlIGNhbiBzZWUgZG9jdW1lbnRhdGlvbiBvdXQgdXNpbmcgdGhlIGA/YCBvcGVyYXRvci4KYGBge3IgQ2hlY2tEb2N1bWVudGFpb259Cj9gREVTZXEyLXBhY2thZ2VgCmBgYAoKKipDaGVja3BvaW50Kio6ICpJZiB5b3Ugc2VlIHRoZSBSIGRvY3VtZW50YXRpb24gZm9yIERFU2VxMiBwb3AgdXAgaW4geW91ciAnaGVscCcgcGFuZWwgb24gdGhlIHJpZ2h0LCBwbGVhc2UgaW5kaWNhdGUgd2l0aCB0aGUgZ3JlZW4gJ2NoZWNrJyBidXR0b24uIElmIG5vdCBwbGVhc2UgdXNlIHRoZSByZWQgJ3gnIGJ1dHRvbi4qCgojIyBSZWFkIENvdW50cwoKQW5vdGhlciBrZXkgYXNzdW1wdGlvbiBmb3IgREVTZXEyIGlzIHRoYXQgdGhlIGFuYWx5c2lzIHdpbGwgc3RhcnQgd2l0aCBbdW4tbm9ybWFsaXplZCBjb3VudHNdKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCN3aHktdW4tbm9ybWFsaXplZC1jb3VudHMpLgoKVG8gYmVnaW4gd2UnbGwgcmVhZCBpbiBhICoqcmF3KiogY291bnQgZGF0YSBmaWxlLCBgZ2VuZV9leHBlY3RlZF9jb3VudC50eHRgIHdoaWNoIGlzIHNpbWlsYXIgdG8gd2hhdCB3b3VsZCBiZSBnZW5lcmF0ZWQgaW4gdGhlIGFsaWdubWVudCBzdGVwcyAoYW5kIHdoYXQgeW91IHdvdWxkIHJlY2VpdmUgZnJvbSBBR0MpLiBXZSdsbCBkaXNjdXNzIGEgZmV3IG5vcm1hbGl6YXRpb25zIHRoYXQgY2FuIGJlIGhlbHBmdWwgZm9yIHVuZGVyc3RhbmRpbmcgYnJvYWQgcGF0dGVybnMgaW4gb3VyIGV4cHJlc3Npb24gZGF0YSwgYnV0IHJhdyBkYXRhICoqc2hvdWxkIGFsd2F5cyoqIGJlIHVzZWQgYXMgYW4gaW5wdXQgZm9yIERFU2VxMi4KCmBgYHtyIERhdGFUYWJsZSwgZXZhbD1UUlVFLCBlY2hvPUZBTFNFfQojIyBuZWVkIHRvIGluY2x1ZGUgcGF0aHMgcmVsYXRpdmUgdG8gc2l0ZSBidWlsZCBsb2NhdGlvbnMgYnV0IGtlZXAgY29kZSBibG9jayBoaWRkZW4KY291bnRfdGFibGUgPSByZWFkLnRhYmxlKCIuLi9kYXRhL1JfZGF0YS9nZW5lX2V4cGVjdGVkX2NvdW50LnR4dCIsIGhlYWRlciA9IFRSVUUsIHJvdy5uYW1lcyA9IDEpCmBgYAoKYGBge3IgRGF0YVRhYmxlMiwgZXZhbD1GQUxTRX0KY291bnRfdGFibGUgPSByZWFkLnRhYmxlKCJkYXRhL2dlbmVfZXhwZWN0ZWRfY291bnQudHh0IiwgaGVhZGVyID0gVFJVRSwgcm93Lm5hbWVzID0gMSkKYGBgCgpgYGB7ciBEYXRhVGFibGVDaGVjaywgZXZhbD1UUlVFfQpoZWFkKGNvdW50X3RhYmxlLCBuPTIpICMgbG9vayBhdCB0aGUgdG9wIG9mIHRoZSB0YWJsZQpgYGAKCk5vdyB0aGF0IHRoZSBmaWxlIGlzIHJlYWQgaW50byBSLCBub3RlIHRoYXQgd2UndmUgY3JlYXRlZCBhIGRhdGEgZnJhbWUgdGhhdCBpbmNsdWRlcyAnZ2VuZSBpZHMnIGluIEVOU0VNQkwgZm9ybWF0IGFzIHJvd25hbWVzIGFuZCBjb3VudCBkYXRhIGZyb20gdHdlbHZlIGRpZmZlcmVudCBzYW1wbGVzLgoKSG93IG1hbnkgZ2VuZXMgd2VyZSBpbmNsdWRlZCBpbiBvdXIgcmVmZXJlbmNlPyBXZSBjYW4gZ2V0IGEgc2Vuc2Ugb2YgdGhlIHNpemUgb2Ygb3VyIGRhdGEgd2l0aCB0aGUgYHN0cmAgZnVuY3Rpb24uCmBgYHtyIERhdGFUYWJsZUNoZWNrMiwgZXZhbD1UUlVFfQpzdHIoY291bnRfdGFibGUpICMgbG9vayBhdCB0aGUgc2l6ZSAmIHN0cnVjdHVyZSBvZiB0aGUgdGFibGUKYGBgCgoKT25lIGltcG9ydGFudCBjb25zaWRlcmF0aW9uIGZvciBSTkEtc2VxIGRhdGEgaXMgaG93IG1hbnkgZ2VuZXMgd2UgbWVhc3VyZWQgaW4gb3VyIGRhdGEgYW5kIGhvdyB3ZWxsIHdlIG1lYXN1cmVkIHRoZW0uIEJvdGggYXJlIGltcGFjdGVkIGJ5IHNlcXVlbmNpbmcgZGVwdGggb3IgdGhlIG51bWJlciBvZiByZWFkcyBnZW5lcmF0ZWQgcGVyIHNhbXBsZS4KCkdlbmVyYWxseSwgZm9yIGh1bWFuIGFuZCBtb3VzZSBleHBlcmltZW50cyB0aGUgcmVjb21tZW5kYXRpb24gaXMgMzAtNDAgbWlsbGlvbiByZWFkcyBwZXIgc2FtcGxlIHRvIGNhcHR1cmUgYm90aCBoaWdobHkgZXhwcmVzc2VkIChhYnVuZGFudCkgYW5kIGxvd2x5IGV4cHJlc3NlZCAocmFyZXIpIHRyYW5zY3JpcHRzIGluIHRoZSBzYW1wbGUsIGFzc3VtaW5nIH4yNSwwMDAgcHJvdGVpbi1jb2RpbmcgZ2VuZXMgd291bGQgYmUgZXhwZWN0ZWQgZm9yIGEgcG9seUEgKG1STkEgdGFyZ2V0aW5nKSBsaWJyYXJ5IHByZXAuIEhvd2V2ZXIsIGFzIHRoZSBpbWFnZSBmcm9tIElsbHVtaW5hIGJlbG93IHNob3dzLCBzZXF1ZW5jaW5nIGRlcHRoIGhhcyBsZXNzIG9mIGFuIGltcGFjdCB0aGFuIG51bWJlciBvZiByZXBsaWNhdGVzIGluIGRldGVjdGluZyBkaWZmZXJlbnRpYWxseSBleHByZXNzZWQgZ2VuZXMgKERFR3MpLgoKIVtJbGx1bWluYSdzIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIHJlY292ZXJ5IGFjcm9zcyByZXBsaWNhdGUgbnVtYmVyIGFuZCBzZXF1ZW5jaW5nIGRlcHRoXShpbWFnZXMvZGVfcmVwbGljYXRlc19pbWcucG5nKXt3aWR0aD01MCV9Cgo8YnI+CgpIb3cgbWFueSByZWFkcyB3ZXJlIGdlbmVyYXRlZCBwZXIgc2FtcGxlIGluIG91ciBkYXRhPyBXZSBjYW4gdXNlIHRoZSBgc3VtbWFyaXplX2FsbGAgZnVuY3Rpb24gZnJvbSB0aGUgZHBseXIgcGFja2FnZSB0byBkZXRlcm1pbmUgdGhlIG51bWJlciBvZiByZWFkcyBvciAiZGVwdGgiIHBlciBzYW1wbGUuCgpgYGB7ciBTdW1tYXJpemVSZWFkcywgZXZhbD1UUlVFfQpjb3VudF90YWJsZSAlPiUgc3VtbWFyaXplX2FsbChzdW0pCmBgYAoKIyBHZXR0aW5nIGhlbHAKCkhvdyBkaWQgd2Uga25vdyB0byB1c2UgdGhlIGBzdW1tYXJpemVfYWxsYCBmdW5jdGlvbiB0byBzdW0gZWFjaCBjb2x1bW4/CgpSIGFuZCBSU3R1ZGlvIGhhdmUgYSBzdHJvbmcgY29tbXVuaXR5IGNvbXBvbmVudCBzbywgYXMgbWVudGlvbmVkIGluIENvbXB1dGF0aW9uYWwgRm91bmRhdGlvbnMsIGlmIHlvdSBhcmUgZ2V0dGluZyBhbiBlcnJvciBvciB3b25kZXJpbmcgaG93IHRvIG1ha2UgYSBjb21tYW5kIHdvcmsgb3IgaG93IHRvIHBlcmZvcm0gYSBzcGVjaWZpYyB0YXNrLCB0aGVyZSBpcyBsaWtlbHkgYWxyZWFkeSBhIHNvbHV0aW9uIG91dCB0aGVyZS4gU2VhcmNoIGVuZ2luZXMgYXJlIHlvdXIgZnJpZW5kLCB3aGljaCBpcyBleGFjdGx5IGhvdyB3ZSBmb3VuZCBbdGhhdCBhcHByb2FjaF0oaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjg4NzMwNTcvc3VtLWFjcm9zcy1tdWx0aXBsZS1jb2x1bW5zLXdpdGgtZHBseXIpCgpJdCBjYW4gc29tZXRpbWVzIGJlIGEgY2hhbGxlbmdlIHRvIGZpZ3VyZSBvdXQgKndoYXQgdG8gc2VhcmNoIGZvciosIHNvIHNvbWUga2V5IHBhcnRzIG9mIGEgc3VjY2Vzc2Z1bCBzZWFyY2ggYXJlOgoKKiBQYWNrYWdlIG9yIGNvbW1hbmQgcnVuCiogYFJgIG9yIGBCaW9jb25kdWN0b3JgCiogVGhlIGVycm9yIG1lc3NhZ2UgaWYgdGhlcmUgaXMgb25lCiogVmVyc2lvbiBpbmZvcm1hdGlvbgoKSG93IHRvIGdldCBzZXNzaW9uIGluZm9ybWF0aW9uIHRvIGFpZCBpbiBhIHNlYXJjaDoKYGBge3IgU2Vzc2lvbiBpbmZvLCBldmFsID0gRkFMU0UsIG1lc3NhZ2UgPSBGQUxTRX0Kc2Vzc2lvbkluZm8oKQpgYGAKCkhpZ2hseSByZWNvbW1lbmQgdXNpbmcgcmVzb3VyY2VzIGxpa2UgW0Jpb2NvbmR1Y3RvciBTdXBwb3J0XShodHRwczovL3N1cHBvcnQuYmlvY29uZHVjdG9yLm9yZy8pLCBbQmlvc3RhcnNdKGh0dHBzOi8vd3d3LmJpb3N0YXJzLm9yZy8pLCBhbmQgW1N0YWNrIE92ZXJmbG93XShodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy90YWdnZWQvciksIGluY2x1ZGluZyB0aHJlYWRzIG9uIHNwZWNpZmljIHBhY2thZ2VzIG9yIGNvbW1vbiBiaW9pbmZvcm1hdGljIHRhc2tzLgoKSSBwZXJzb25hbGx5IHVzZSBvbmUgb3IgbW9yZSBvZiB0aGVzZSByZXNvdXJjZXMgKipldmVyeSBkYXkqKi4KCjEweCBHZW5vbWljcyBhbHNvIGhhcyBhIGhlbHBmdWwgWzEwIHRpcHMgZm9yIGJpb2xvZ2lzdHMgbGVhcm5pbmcgIGJpb2luZm9ybWF0aWNzXShodHRwczovL3d3dy4xMHhnZW5vbWljcy5jb20vcmVzb3VyY2VzL2FuYWx5c2lzLWd1aWRlcy8xMC10aXBzLWZvci1iaW9sb2dpc3RzLWxlYXJuaW5nLWJpb2luZm9ybWF0aWNzKSBpbmNsdWRlZCBpbiB0aGVpciByZXNvdXJjZXMuCgojIFN1bW1hcnkKCkluIHRoaXMgc2VjdGlvbiwgd2U6CgoqIFNldCB1cCBvdXIgY29tcHV0ZSBlbnZpcm9ubWVudAoqIExlYXJuZWQgYWJvdXQgdGhlIERFU2VxMiBwYWNrYWdlCiogUmVhZCBpbiBhIHJhdyBjb3VudCB0YWJsZSBhbmQgc2F2ZWQgaXQgYXMgYSBkYXRhIGZyYW1lCgpOb3cgdGhhdCB3ZSBoYXZlIG91ciBjb3VudCBkYXRhIHByb2Nlc3NlZCwgd2UgY2FuIG1vdmUgb24gdG8gInVuYmxpbmRpbmciIG91ciBkYXRhLCBhcyB0aGUgc2FtcGxlIG5hbWVzIGFyZSB1bmlxdWUgaWRlbnRpZmllcnMgZ2VuZXJhdGVkIGJ5IGEgc2VxdWVuY2luZyBjZW50ZXIgYW5kIG5vdCB2ZXJ5IGluZm9ybWF0aXZlIGFzIGZhciBhcyBvdXIgZXhwZXJpbWVudGFsIGNvbmRpdGlvbnMuCgotLS0KCiMgT3B0aW9uYWwgY29udGVudAoKQW4gaW1wb3J0YW50IG5vdGUgaXMgdGhhdCB0aGVyZSBhcmUgc2V2ZXJhbCBib251cyBjb250ZW50IHNlY3Rpb25zIG9uIHRoZSBpbnN0cnVjdGlvbiBwYWdlcywgbGlrZSB0aGUgdHdvIGJlbG93IHRoYXQgd2Ugd2lsbCBub3QgYmUgY292ZXJpbmcgaW4gdGhpcyB3b3Jrc2hvcCwgYnV0IHRoYXQgbWF5IGhhdmUgdXNlZnVsIGNvbnRleHQgb3IgYmUgaGVscGZ1bCB3aGVuIHlvdSByZXZpZXcgdGhpcyBtYXRlcmlhbC4KCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkNsaWNrIGZvciBhbHRlcm5hdGl2ZSBERVNlcTIgaW5wdXQgb3B0aW9ucyBmb3IgUlNFTSBvdXRwdXRzKjwvc3VtbWFyeT4KICAgIFRoZSBwYWNrYWdlIGB0eGltcG9ydGAgaXMgYW5vdGhlciBvcHRpb25bcmVjb21tZW5kZWQgdGhlIERFU2VxMiAgYXV0aG9yc10oaHR0cHM6Ly9zdXBwb3J0LmJpb2NvbmR1Y3Rvci5vcmcvcC85MDY3Mi8pIHRvIHJlYWQgaW4gdGhlIFJTRU0gZXhwZWN0ZWRfY291bnRzLCBhcyB0aGlzICBwYWNrYWdlIGFsbG93cyBmb3IgdGhlIGF2ZXJhZ2UgdHJhbnNjcmlwdCBsZW5ndGggcGVyIGdlbmUgdG8gYmUgdXNlZCBpbiB0aGUgREUgYW5hbHlzaXMgYW5kLCBhcyBbZGVzY3JpYmVkIGJ5IHRoZSBhdXRob3JdKGh0dHBzOi8vc3VwcG9ydC5iaW9jb25kdWN0b3Iub3JnL3AvODg3NjMvKSwgdGhlIGB0eGltcG9ydC10by1ERVNlcURhdGFTZXRgIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHJvdW5kIHRoZSBub24taW50ZWdlciBkYXRhIGdlbmVyYXRlZCBieSBSU0VNIHRvIHdob2xlIG51bWJlcnMuCjwvZGV0YWlscz4KPGJyPgo8ZGV0YWlscz4KICAgIDxzdW1tYXJ5PipDbGljayBmb3IgY29tcGFyaXNvbiBvZiBSTkEtc2VxIGRhdGEgYW5kIG1pY3JvYXJyYXkgZGF0YSo8L3N1bW1hcnk+CiAgICBXaXRoIFtoaWdoZXIgc2Vuc2l0aXZpdHksIGdyZWF0ZXIgZmxleGlibGl0eSwgYW5kIGRlY3JlYXNpbmcgY29zdF0oaHR0cHM6Ly93d3cuaWxsdW1pbmEuY29tL3NjaWVuY2UvdGVjaG5vbG9neS9uZXh0LWdlbmVyYXRpb24tc2VxdWVuY2luZy9taWNyb2FycmF5LXJuYS1zZXEtY29tcGFyaXNvbi5odG1sKSwgc2VxdWVuY2luZyBoYXMgbGFyZ2VseSByZXBsYWNlZCBtaWNyb2FycmF5IGFzc2F5cyBmb3IgbWVhc3VyaW5nIGdlbmUgZXhwcmVzc2lvbi4gQSBrZXkgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBwbGF0Zm9ybXMgaXMgdGhhdCBtaWNyb2FycmF5cyBtZWFzdXJlIGludGVuc2l0aWVzIGFuZCBhcmUgdGhlcmVmb3JlICpjb250aW5vdXMqIGRhdGEgd2hpbGUgdGhlIGNvdW50IGRhdGEgZnJvbSBzZXF1ZW5jaW5nIGlzICpkaXNjcmV0ZSouIEEgbW9yZSBkZXRhaWxlZCBjb21wYXJpc29uIGJldHdlZW4gbWljcm9hcnJheXMgYW5kIHNlcXVlbmNpbmcgdGVjaG5vbG9naWVzL2FuYWx5c2lzIGlzIG91dGxpbmVkIGluIFt0aGUgb25saW5lIG1hdGVyaWFscyBmb3IgUGVubiBTdGF0ZSdzIFNUQVQ1NTUgY291cnNlXShodHRwczovL29ubGluZS5zdGF0LnBzdS5lZHUvc3RhdDU1NS9ub2RlLzMwLykKCjwvZGV0YWlscz4KPGJyPgoKIyBTb3VyY2VzCgpUcmFpbmluZyByZXNvdXJjZXMgdXNlZCB0byBkZXZlbG9wIG1hdGVyaWFsczoKCiogSEJDIERHRSBzZXR1cDogaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDFfREdFX3NldHVwX2FuZF9vdmVydmlldy5odG1sCiogSEJDIENvdW50IE5vcm1hbGl6YXRpb246IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzAyX0RHRV9jb3VudF9ub3JtYWxpemF0aW9uLmh0bWwKKiBERVNlcTIgc3RhbmRhcmQgdmlnbmV0dGU6IGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbAoqIERFU2VxMiBiZWdpbm5lcnMgdmlnbmV0dGU6IGh0dHBzOi8vYmlvYy5pc20uYWMuanAvcGFja2FnZXMvMi4xNC9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvYmVnaW5uZXIucGRmCiogQmlvY29uZHVjdG9yIFJOQS1zZXEgV29ya2Zsb3dzOiBodHRwczovL3d3dy5iaW9jb25kdWN0b3Iub3JnL2hlbHAvY291cnNlLW1hdGVyaWFscy8yMDE1L0xlYXJuQmlvY29uZHVjdG9yRmViMjAxNS9CMDIuMV9STkFTZXEuaHRtbAoqIENDREwgR2FzdHJpYyBjYW5jZXIgdHJhaW5pbmcgbWF0ZXJpYWxzOiBodHRwczovL2FsZXhzbGVtb25hZGUuZ2l0aHViLmlvL3RyYWluaW5nLW1vZHVsZXMvUk5BLXNlcS8wMy1nYXN0cmljX2NhbmNlcl9leHBsb3JhdG9yeS5uYi5odG1sCiogQ0NETCBOZXVyb2JsYXN0b21hIHRyYWluaW5nIG1hdGVyaWFsczogaHR0cHM6Ly9hbGV4c2xlbW9uYWRlLmdpdGh1Yi5pby90cmFpbmluZy1tb2R1bGVzL1JOQS1zZXEvMDUtbmJfY2VsbF9saW5lX0RFU2VxMi5uYi5odG1sCgoKYGBge3IgV3JpdGVPdXQuUkRhdGEsIGV2YWw9VFJVRSwgZWNobz1GQUxTRSwgbWVzc2FnZT1GQUxTRX0KI0hpZGRlbiBjb2RlIGJsb2NrIHRvIHdyaXRlIG91dCBkYXRhIGZvciBrbml0dGluZwoKIyBkaXIuY3JlYXRlKCJyZGF0YSIsIHNob3dXYXJuaW5ncz1GQUxTRSkKIyBzYXZlLmltYWdlKGZpbGUgPSAicmRhdGEvUnVubmluZ0RhdGEuUkRhdGEiKQojIEhvdyB0byBsb2FkIGZvciBuZXh0IHNlZ21lbnQKIyBsb2FkKCJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKLS0tCgpUaGVzZSBtYXRlcmlhbHMgaGF2ZSBiZWVuIGFkYXB0ZWQgYW5kIGV4dGVuZGVkIGZyb20gbWF0ZXJpYWxzIGxpc3RlZCBhYm92ZS4gVGhlc2UgYXJlIG9wZW4gYWNjZXNzIG1hdGVyaWFscyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIFtDcmVhdGl2ZSBDb21tb25zIEF0dHJpYnV0aW9uIGxpY2Vuc2UgKENDIEJZIDQuMCldKGh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzQuMC8pLCB3aGljaCBwZXJtaXRzIHVucmVzdHJpY3RlZCB1c2UsIGRpc3RyaWJ1dGlvbiwgYW5kIHJlcHJvZHVjdGlvbiBpbiBhbnkgbWVkaXVtLCBwcm92aWRlZCB0aGUgb3JpZ2luYWwgYXV0aG9yIGFuZCBzb3VyY2UgYXJlIGNyZWRpdGVkLgoKPGJyLz4KPGJyLz4KPGhyLz4KfCBbUHJldmlvdXMgbGVzc29uXShNb2R1bGUwNV9BZGRpdGlvbmFsX0RldGFpbHMuaHRtbCkgfCBbVG9wIG9mIHRoaXMgbGVzc29uXSgjdG9wKSB8IFtOZXh0IGxlc3Nvbl0oTW9kdWxlMDdfREVTZXEySW5pdC5odG1sKSB8CnwgOi0tLSB8IDotLS0tOiB8IC0tLTogfA==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module06_DEAnalysisSetup.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
