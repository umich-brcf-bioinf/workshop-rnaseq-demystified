<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />


<title>Alignment</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_Sequence_QC.html">Sequence QC</a>
    </li>
    <li>
      <a href="Module02b_Trimming.html">Trimming</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03a_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module03b_Alignment.html">Alignment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module04_Alignment_QC_and_Quantification.html">Alignment QC and Quantification</a>
    </li>
    <li>
      <a href="Module05_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">DE Introduction</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DE Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">DE Normalization and Modeling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">DE Testing</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visualization</a>
    </li>
    <li>
      <a href="Module12_DEAnnotations.html">DE Annotation</a>
    </li>
    <li>
      <a href="R_bonus_content.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Alignment</h1>
<h4 class="author">UM Bioinformatics Core</h4>

</div>


<style type="text/css">
body{ /* Normal  */
      font-size: 14pt;
  }
pre {
  font-size: 12pt
}
</style>
<p>In this module, we will learn:</p>
<ul>
<li>the concept of splice-aware alignments</li>
<li>the two steps needed to run RSEM+STAR</li>
<li>details of SAM and BAM files, and RSEM outputs</li>
</ul>
<div id="differential-expression-workflow" class="section level1">
<h1>Differential Expression Workflow</h1>
<p>We’ll discuss the alignment and gene quantification steps which
gather the necessary data that we will need prior to testing for
differential expression, the topic of Day 2.</p>
<p><img src="images/wayfinder/wayfinder-Alignment.png" /> <br> <br> <br>
<br></p>
</div>
<div id="alignment-and-gene-quantification" class="section level1">
<h1>Alignment and Gene Quantification</h1>
<p>The FASTQ files of raw sequenced reads are untethered from any notion
of where they came from in the genome, and which transcribed genes the
sequence belongs to. The alignment and gene quantification steps fill in
that gap and allow us to proceed with the question we are really
interested in: Which genes are differentially expressed between groups
of samples?</p>
<p>We will use RSEM (<a
href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-323">paper</a>
and <a href="https://github.com/deweylab/RSEM">GitHub</a>) combined with
STAR Aligner (<a
href="https://academic.oup.com/bioinformatics/article/29/1/15/272537">paper</a>
and <a href="https://github.com/alexdobin/STAR">GitHub</a>) to
accomplish the task of read mapping and gene quantifcation
simultaneously.</p>
<div id="star" class="section level2">
<h2>STAR</h2>
<p>The “Spliced Transcripts Alignment to a Reference” (STAR) Aligner is
aware of splice-sites of transcripts and is able to align reads that
span them. The figure below illustrates the difference between
splice-unaware aligners (e.g. Bowtie2) and splice-aware aligners
(e.g. STAR).</p>
<p>Some benefits of splice-aware aligners include:</p>
<ul>
<li>Fewer reads are discarded for lack of alignments, leading to more
accurate gene quantification.</li>
<li>Direct evidence of isoform usage is possible.</li>
</ul>
<p>We should note that the default parameters for STAR are optimized for
<strong>mammalian genomes</strong>.</p>
<center>
<div class="float">
<img src="images/splice_aware.png" alt="Splice-aware alignment" />
<div class="figcaption">Splice-aware alignment</div>
</div>
<p>Credit: <a
href="https://raw.githubusercontent.com/hbctraining/Intro-to-rnaseq-hpc-O2/master/lectures/Sequence_alignment.pdf"
class="uri">https://raw.githubusercontent.com/hbctraining/Intro-to-rnaseq-hpc-O2/master/lectures/Sequence_alignment.pdf</a></p>
</center>
</div>
<div id="rsem" class="section level2">
<h2>RSEM</h2>
<p>RSEM (RNA-seq by Expectation Maximization) determines gene and
isoform abundance using an expectation maximization (EM) algorithm to
determine the probability that any particular read originated from a
particular transcript. From there, gene-level quantification is reported
by effectively collapsing the isoform quantifications over all isoforms
belonging to the gene.</p>
<p>The primary issue that RSEM attempts to solve is that reads can align
to multiple isoforms (when, for example, they share an exon), and that
creates ambiguity in deciding which isoform a read gets assigned to for
quantification. RSEM uses the EM algorithm described above to handle
this ambiguity appropriately.</p>
</div>
</div>
<div id="running-rsemstar" class="section level1">
<h1>Running RSEM+STAR</h1>
<p>RSEM can be run with just two commands: the first
<code>rsem-prepare-reference</code> (<a
href="https://deweylab.github.io/RSEM/rsem-prepare-reference.html">manual</a>)
builds an index for STAR and RSEM to use, and the second
<code>rsem-calculate-expression</code> (<a
href="https://deweylab.github.io/RSEM/rsem-calculate-expression.html">manual</a>)
does the alignment and gene quantification.</p>
<p>We’ll explore the expected outputs from these commands and discuss
their contents, before creating our own reference and aligning reads
with our example data.</p>
<div id="rsem-prepare-reference-details" class="section level2">
<h2><code>rsem-prepare-reference</code> Details</h2>
<p>The purpose of <code>rsem-prepare-reference</code> is to create a
reference index for alignment. A reference index is essentially a lookup
table that speeds up the finding of sequence matches for alignment. In
the case of a splice-aware aligner, the reference index is also aware of
the various splice junctions at locations in the gene model, and a
subset of reads will map across these. This allows us to infer isoform
usage later on.</p>
<p><code>rsem-prepare-reference</code> will use a FASTA file and a GTF
as inputs, and it will produce a number of large files which make up the
index. RSEM has the flexible capability of supporting multiple different
aligners. We’ll be using STAR. The output files therefore contain items
from the indexing process of STAR and RSEM. These files allow for the
fast and efficient search and retrieval of sequence and gene-model
information during alignment and quantification. The outputs will look
like the following:</p>
<pre><code>GRCm38.102.chr19reduced.chrlist
GRCm38.102.chr19reduced.grp
GRCm38.102.chr19reduced.idx.fa
GRCm38.102.chr19reduced.n2g.idx.fa
GRCm38.102.chr19reduced.seq
GRCm38.102.chr19reduced.ti
GRCm38.102.chr19reduced.transcripts.fa
Genome
Log.out
SA
SAindex
chrLength.txt
chrName.txt
chrNameLength.txt
chrStart.txt
exonGeTrInfo.tab
exonInfo.tab
geneInfo.tab
genomeParameters.txt
sjdbInfo.txt
sjdbList.fromGTF.out.tab
sjdbList.out.tab
transcriptInfo.tab</code></pre>
</div>
<div id="rsem-calculate-expression-details" class="section level2">
<h2><code>rsem-calculate-expression</code> Details</h2>
<p>After preparing the reference index, we can do alignment and
quantification with the <code>rsem-calculate-expression</code> command
(<a
href="https://deweylab.github.io/RSEM/rsem-calculate-expression.html">here</a>
is a link to the manual). For our inputs, we will be using our FASTQ
reads and the path to the reference index that we create.</p>
<p>There are numerous outputs, which are laid out in the following
table:</p>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sample_N.genome.bam</code></td>
<td>The alignments in genomic coordinates. Used for visualization in a
genome browser such as <a
href="https://software.broadinstitute.org/software/igv/">IGV</a>.</td>
</tr>
<tr class="even">
<td><code>sample_N.transcript.bam</code></td>
<td>The alignments in transcriptomic coordinates. Not used for this
workshop.</td>
</tr>
<tr class="odd">
<td><code>sample_N.genes.results</code></td>
<td>Gene-level results to be used in downstream DE analysis.</td>
</tr>
<tr class="even">
<td><code>sample_N.isoforms.results</code></td>
<td>Isoform-level results. Not used for this workshop.</td>
</tr>
</tbody>
</table>
<p>The two results we will use most often from RSEM+STAR are the
gene-level quantifications (<code>sample_N.genes.results</code>) and the
alignments in genome-coordinates (<code>sample_N.genome.bam</code>).
Each sample for which we run RSEM+STAR will have these output files
named after the sample.</p>
<div id="genome-alignments" class="section level3">
<h3>Genome Alignments</h3>
<p>The <code>sample_N.genome.bam</code> alignments file is a special,
compressed, version of a SAM file (sequence alignment/map). In order to
view it, we have to use a special program called <a
href="https://www.htslib.org/doc/samtools.html"><code>samtools</code></a>.</p>
<p>If we were to peek inside of <code>sample_N.genome.bam</code>, we
would see many columns of data. By using <code>samtools</code>, we will
be able to view the columns in plain text (SAM format). The mandatory
columns in SAM format are shown in the following table from the <a
href="https://samtools.github.io/hts-specs/SAMv1.pdf">official SAM/BAM
format specification</a>.</p>
<p><img src="images/sam_columns.png" width="800" /></p>
<p>The SAM format gives information about where each read maps to in the
genome (one read per line), and has information about that mapping.</p>
</div>
<div id="gene-level-quantification" class="section level3">
<h3>Gene-level Quantification</h3>
<p>If we were to look at the top 3 lines of
<code>sample_N.genes.results</code>, we see it is a plain-text file
separated by tabs where each row is a gene, and the columns are
described the first row.</p>
<table>
<colgroup>
<col width="26%" />
<col width="73%" />
</colgroup>
<thead>
<tr class="header">
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>gene_id</td>
<td>The ID from the gene model GTF.</td>
</tr>
<tr class="even">
<td>transcript_id(s)</td>
<td>The transcript IDs corresponding to the gene in the gene model
GTF.</td>
</tr>
<tr class="odd">
<td>length</td>
<td>The weighted average of its transcripts’ lengths.</td>
</tr>
<tr class="even">
<td>effective_length</td>
<td>The weighted average, over its transcripts, of the mean number of
positions from which a fragment may start within the sequence of
transcript.</td>
</tr>
<tr class="odd">
<td>expected_count</td>
<td>The sum, over all transcripts, of the estimated counts from the EM
algorithm.</td>
</tr>
<tr class="even">
<td>TPM</td>
<td>Transcript per million, a relative measure of transcript abundance
where the sum of all TPMs is 1 million.</td>
</tr>
<tr class="odd">
<td>FPKM</td>
<td>Fragments per kilobase of transcript per million mapped reads.</td>
</tr>
</tbody>
</table>
<p>The <code>genes.results</code> files for each sample can be directly
imported into DESeq2 using the <a
href="https://bioconductor.org/packages/release/bioc/vignettes/tximport/inst/doc/tximport.html#rsem"><code>tximport</code></a>
R Bioconductor package.</p>
<p>Alternatively, we can combine these results into a count matrix. The
count matrix can be very useful, since it contains summary-level data in
a widely supported format, this makes it great for sharing and as input
into different analyses.</p>
</div>
</div>
<div id="rsem-prepare-reference-exercise" class="section level2">
<h2>RSEM Prepare Reference Exercise:</h2>
<ol style="list-style-type: decimal">
<li>View the help page for rsem-prepare-reference</li>
<li>Create a command that will index our example genome, but do not run
it</li>
</ol>
<pre><code># View the help file
rsem-prepare-reference -h
# Create/execute the prepare-reference command
rsem-prepare-reference --gtf ../refs/GRCm38.102.chr19reduced.gtf --star --num-threads 1 ../refs/GRCm38.102.chr19reduced.fa ../refs/GRCm38.102.chr19reduced</code></pre>
</div>
<div id="rsem-calculate-expression-exercise" class="section level2">
<h2>RSEM Calculate Expression Exercise:</h2>
<ol style="list-style-type: decimal">
<li>View the help page for rsem-calculate-expression</li>
<li>Create a command to execute RSEM / STAR alignment and quantification
for one of our samples</li>
</ol>
<pre><code># First create a directory for the aligned results
mkdir out_rsem
# Construct an RSEM command to align sample_A to our reference
rsem-calculate-expression --star --num-threads 1 --star-gzipped-read-file --star-output-genome-bam --keep-intermediate-files out_trimmed/sample_A_R1.trimmed.fastq.gz ../refs/GRCm38.102.chr19reduced out_rsem/sample_A</code></pre>
<p><br> <br></p>
</div>
<div id="aligning-all-samples-exercise" class="section level2">
<h2>Aligning All Samples Exercise:</h2>
<p>Before starting our alignment exercise, we should make sure that we
are on the same page. Follow the link below:</p>
<p><a href="Module03b_breakout02_sol.html">Link to alignment
exercise</a></p>
<p><br> <br></p>
<hr />
<p>These materials have been adapted and extended from materials created
by the <a href="http://bioinformatics.sph.harvard.edu/">Harvard Chan
Bioinformatics Core (HBC)</a>. These are open access materials
distributed under the terms of the <a
href="http://creativecommons.org/licenses/by/4.0/">Creative Commons
Attribution license (CC BY 4.0)</a>, which permits unrestricted use,
distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="Module03a_Reference_Genomes.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a
href="Module04_Alignment_QC_and_Quantification.html">Next
lesson</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQWxpZ25tZW50IgphdXRob3I6ICJVTSBCaW9pbmZvcm1hdGljcyBDb3JlIgpvdXRwdXQ6CiAgICAgICAgaHRtbF9kb2N1bWVudDoKICAgICAgICAgICAgaW5jbHVkZXM6CiAgICAgICAgICAgICAgICBpbl9oZWFkZXI6IGhlYWRlci5odG1sCiAgICAgICAgICAgIHRoZW1lOiBwYXBlcgogICAgICAgICAgICB0b2M6IHRydWUKICAgICAgICAgICAgdG9jX2RlcHRoOiA0CiAgICAgICAgICAgIHRvY19mbG9hdDogdHJ1ZQogICAgICAgICAgICBudW1iZXJfc2VjdGlvbnM6IGZhbHNlCiAgICAgICAgICAgIGZpZ19jYXB0aW9uOiB0cnVlCiAgICAgICAgICAgIG1hcmtkb3duOiBHRk0KICAgICAgICAgICAgY29kZV9kb3dubG9hZDogdHJ1ZQotLS0KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KYm9keXsgLyogTm9ybWFsICAqLwogICAgICBmb250LXNpemU6IDE0cHQ7CiAgfQpwcmUgewogIGZvbnQtc2l6ZTogMTJwdAp9Cjwvc3R5bGU+CgpJbiB0aGlzIG1vZHVsZSwgd2Ugd2lsbCBsZWFybjoKCiogdGhlIGNvbmNlcHQgb2Ygc3BsaWNlLWF3YXJlIGFsaWdubWVudHMKKiB0aGUgdHdvIHN0ZXBzIG5lZWRlZCB0byBydW4gUlNFTStTVEFSCiogZGV0YWlscyBvZiBTQU0gYW5kIEJBTSBmaWxlcywgYW5kIFJTRU0gb3V0cHV0cwoKIyBEaWZmZXJlbnRpYWwgRXhwcmVzc2lvbiBXb3JrZmxvdwoKV2UnbGwgZGlzY3VzcyB0aGUgYWxpZ25tZW50IGFuZCBnZW5lIHF1YW50aWZpY2F0aW9uIHN0ZXBzIHdoaWNoIGdhdGhlciB0aGUgbmVjZXNzYXJ5IGRhdGEgdGhhdCB3ZSB3aWxsIG5lZWQgcHJpb3IgdG8gdGVzdGluZyBmb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24sIHRoZSB0b3BpYyBvZiBEYXkgMi4KCiFbXShpbWFnZXMvd2F5ZmluZGVyL3dheWZpbmRlci1BbGlnbm1lbnQucG5nKQo8YnI+Cjxicj4KPGJyPgo8YnI+CgojIEFsaWdubWVudCBhbmQgR2VuZSBRdWFudGlmaWNhdGlvbgoKVGhlIEZBU1RRIGZpbGVzIG9mIHJhdyBzZXF1ZW5jZWQgcmVhZHMgYXJlIHVudGV0aGVyZWQgZnJvbSBhbnkgbm90aW9uIG9mIHdoZXJlIHRoZXkgY2FtZSBmcm9tIGluIHRoZSBnZW5vbWUsIGFuZCB3aGljaCB0cmFuc2NyaWJlZCBnZW5lcyB0aGUgc2VxdWVuY2UgYmVsb25ncyB0by4gVGhlIGFsaWdubWVudCBhbmQgZ2VuZSBxdWFudGlmaWNhdGlvbiBzdGVwcyBmaWxsIGluIHRoYXQgZ2FwIGFuZCBhbGxvdyB1cyB0byBwcm9jZWVkIHdpdGggdGhlIHF1ZXN0aW9uIHdlIGFyZSByZWFsbHkgaW50ZXJlc3RlZCBpbjogV2hpY2ggZ2VuZXMgYXJlIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBiZXR3ZWVuIGdyb3VwcyBvZiBzYW1wbGVzPwoKV2Ugd2lsbCB1c2UgUlNFTSAoW3BhcGVyXShodHRwczovL2JtY2Jpb2luZm9ybWF0aWNzLmJpb21lZGNlbnRyYWwuY29tL2FydGljbGVzLzEwLjExODYvMTQ3MS0yMTA1LTEyLTMyMykgYW5kIFtHaXRIdWJdKGh0dHBzOi8vZ2l0aHViLmNvbS9kZXdleWxhYi9SU0VNKSkgY29tYmluZWQgd2l0aCBTVEFSIEFsaWduZXIgKFtwYXBlcl0oaHR0cHM6Ly9hY2FkZW1pYy5vdXAuY29tL2Jpb2luZm9ybWF0aWNzL2FydGljbGUvMjkvMS8xNS8yNzI1MzcpIGFuZCBbR2l0SHViXShodHRwczovL2dpdGh1Yi5jb20vYWxleGRvYmluL1NUQVIpKSB0byBhY2NvbXBsaXNoIHRoZSB0YXNrIG9mIHJlYWQgbWFwcGluZyBhbmQgZ2VuZSBxdWFudGlmY2F0aW9uIHNpbXVsdGFuZW91c2x5LgoKIyMgU1RBUgoKVGhlICJTcGxpY2VkIFRyYW5zY3JpcHRzIEFsaWdubWVudCB0byBhIFJlZmVyZW5jZSIgKFNUQVIpIEFsaWduZXIgaXMgYXdhcmUgb2Ygc3BsaWNlLXNpdGVzIG9mIHRyYW5zY3JpcHRzIGFuZCBpcyBhYmxlIHRvIGFsaWduIHJlYWRzIHRoYXQgc3BhbiB0aGVtLiBUaGUgZmlndXJlIGJlbG93IGlsbHVzdHJhdGVzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gc3BsaWNlLXVuYXdhcmUgYWxpZ25lcnMgKGUuZy4gQm93dGllMikgYW5kIHNwbGljZS1hd2FyZSBhbGlnbmVycyAoZS5nLiBTVEFSKS4KClNvbWUgYmVuZWZpdHMgb2Ygc3BsaWNlLWF3YXJlIGFsaWduZXJzIGluY2x1ZGU6CgoqIEZld2VyIHJlYWRzIGFyZSBkaXNjYXJkZWQgZm9yIGxhY2sgb2YgYWxpZ25tZW50cywgbGVhZGluZyB0byBtb3JlIGFjY3VyYXRlIGdlbmUgcXVhbnRpZmljYXRpb24uCiogRGlyZWN0IGV2aWRlbmNlIG9mIGlzb2Zvcm0gdXNhZ2UgaXMgcG9zc2libGUuCgpXZSBzaG91bGQgbm90ZSB0aGF0IHRoZSBkZWZhdWx0IHBhcmFtZXRlcnMgZm9yIFNUQVIgYXJlIG9wdGltaXplZCBmb3IgKiptYW1tYWxpYW4gZ2Vub21lcyoqLgoKPGNlbnRlcj4KCiFbU3BsaWNlLWF3YXJlIGFsaWdubWVudF0oaW1hZ2VzL3NwbGljZV9hd2FyZS5wbmcpCgpDcmVkaXQ6IGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9oYmN0cmFpbmluZy9JbnRyby10by1ybmFzZXEtaHBjLU8yL21hc3Rlci9sZWN0dXJlcy9TZXF1ZW5jZV9hbGlnbm1lbnQucGRmCgo8L2NlbnRlcj4KCiMjIFJTRU0KClJTRU0gKFJOQS1zZXEgYnkgRXhwZWN0YXRpb24gTWF4aW1pemF0aW9uKSBkZXRlcm1pbmVzIGdlbmUgYW5kIGlzb2Zvcm0gYWJ1bmRhbmNlIHVzaW5nIGFuIGV4cGVjdGF0aW9uIG1heGltaXphdGlvbiAoRU0pIGFsZ29yaXRobSB0byBkZXRlcm1pbmUgdGhlIHByb2JhYmlsaXR5IHRoYXQgYW55IHBhcnRpY3VsYXIgcmVhZCBvcmlnaW5hdGVkIGZyb20gYSBwYXJ0aWN1bGFyIHRyYW5zY3JpcHQuIEZyb20gdGhlcmUsIGdlbmUtbGV2ZWwgcXVhbnRpZmljYXRpb24gaXMgcmVwb3J0ZWQgYnkgZWZmZWN0aXZlbHkgY29sbGFwc2luZyB0aGUgaXNvZm9ybSBxdWFudGlmaWNhdGlvbnMgb3ZlciBhbGwgaXNvZm9ybXMgYmVsb25naW5nIHRvIHRoZSBnZW5lLgoKVGhlIHByaW1hcnkgaXNzdWUgdGhhdCBSU0VNIGF0dGVtcHRzIHRvIHNvbHZlIGlzIHRoYXQgcmVhZHMgY2FuIGFsaWduIHRvIG11bHRpcGxlIGlzb2Zvcm1zICh3aGVuLCBmb3IgZXhhbXBsZSwgdGhleSBzaGFyZSBhbiBleG9uKSwgYW5kIHRoYXQgY3JlYXRlcyBhbWJpZ3VpdHkgaW4gZGVjaWRpbmcgd2hpY2ggaXNvZm9ybSBhIHJlYWQgZ2V0cyBhc3NpZ25lZCB0byBmb3IgcXVhbnRpZmljYXRpb24uIFJTRU0gdXNlcyB0aGUgRU0gYWxnb3JpdGhtIGRlc2NyaWJlZCBhYm92ZSB0byBoYW5kbGUgdGhpcyBhbWJpZ3VpdHkgYXBwcm9wcmlhdGVseS4KCiMgUnVubmluZyBSU0VNK1NUQVIKClJTRU0gY2FuIGJlIHJ1biB3aXRoIGp1c3QgdHdvIGNvbW1hbmRzOiB0aGUgZmlyc3QgYHJzZW0tcHJlcGFyZS1yZWZlcmVuY2VgIChbbWFudWFsXShodHRwczovL2Rld2V5bGFiLmdpdGh1Yi5pby9SU0VNL3JzZW0tcHJlcGFyZS1yZWZlcmVuY2UuaHRtbCkpIGJ1aWxkcyBhbiBpbmRleCBmb3IgU1RBUiBhbmQgUlNFTSB0byB1c2UsIGFuZCB0aGUgc2Vjb25kIGByc2VtLWNhbGN1bGF0ZS1leHByZXNzaW9uYCAoW21hbnVhbF0oaHR0cHM6Ly9kZXdleWxhYi5naXRodWIuaW8vUlNFTS9yc2VtLWNhbGN1bGF0ZS1leHByZXNzaW9uLmh0bWwpKSBkb2VzIHRoZSBhbGlnbm1lbnQgYW5kIGdlbmUgcXVhbnRpZmljYXRpb24uCgpXZSdsbCBleHBsb3JlIHRoZSBleHBlY3RlZCBvdXRwdXRzIGZyb20gdGhlc2UgY29tbWFuZHMgYW5kIGRpc2N1c3MgdGhlaXIgY29udGVudHMsIGJlZm9yZSBjcmVhdGluZyBvdXIgb3duIHJlZmVyZW5jZSBhbmQgYWxpZ25pbmcgcmVhZHMgd2l0aCBvdXIgZXhhbXBsZSBkYXRhLgoKIyMgYHJzZW0tcHJlcGFyZS1yZWZlcmVuY2VgIERldGFpbHMKCiBUaGUgcHVycG9zZSBvZiBgcnNlbS1wcmVwYXJlLXJlZmVyZW5jZWAgaXMgdG8gY3JlYXRlIGEgcmVmZXJlbmNlIGluZGV4IGZvciBhbGlnbm1lbnQuIEEgcmVmZXJlbmNlIGluZGV4IGlzIGVzc2VudGlhbGx5IGEgbG9va3VwIHRhYmxlIHRoYXQgc3BlZWRzIHVwIHRoZSBmaW5kaW5nIG9mIHNlcXVlbmNlIG1hdGNoZXMgZm9yIGFsaWdubWVudC4gSW4gdGhlIGNhc2Ugb2YgYSBzcGxpY2UtYXdhcmUgYWxpZ25lciwgdGhlIHJlZmVyZW5jZSBpbmRleCBpcyBhbHNvIGF3YXJlIG9mIHRoZSB2YXJpb3VzIHNwbGljZSBqdW5jdGlvbnMgYXQgbG9jYXRpb25zIGluIHRoZSBnZW5lIG1vZGVsLCBhbmQgYSBzdWJzZXQgb2YgcmVhZHMgd2lsbCBtYXAgYWNyb3NzIHRoZXNlLiBUaGlzIGFsbG93cyB1cyB0byBpbmZlciBpc29mb3JtIHVzYWdlIGxhdGVyIG9uLgoKYHJzZW0tcHJlcGFyZS1yZWZlcmVuY2VgIHdpbGwgdXNlIGEgRkFTVEEgZmlsZSBhbmQgYSBHVEYgYXMgaW5wdXRzLCBhbmQgaXQgd2lsbCBwcm9kdWNlIGEgbnVtYmVyIG9mIGxhcmdlIGZpbGVzIHdoaWNoIG1ha2UgdXAgdGhlIGluZGV4LiBSU0VNIGhhcyB0aGUgZmxleGlibGUgY2FwYWJpbGl0eSBvZiBzdXBwb3J0aW5nIG11bHRpcGxlIGRpZmZlcmVudCBhbGlnbmVycy4gV2UnbGwgYmUgdXNpbmcgU1RBUi4gVGhlIG91dHB1dCBmaWxlcyB0aGVyZWZvcmUgY29udGFpbiBpdGVtcyBmcm9tIHRoZSBpbmRleGluZyBwcm9jZXNzIG9mIFNUQVIgYW5kIFJTRU0uIFRoZXNlIGZpbGVzIGFsbG93IGZvciB0aGUgZmFzdCBhbmQgZWZmaWNpZW50IHNlYXJjaCBhbmQgcmV0cmlldmFsIG9mIHNlcXVlbmNlIGFuZCBnZW5lLW1vZGVsIGluZm9ybWF0aW9uIGR1cmluZyBhbGlnbm1lbnQgYW5kIHF1YW50aWZpY2F0aW9uLiBUaGUgb3V0cHV0cyB3aWxsIGxvb2sgbGlrZSB0aGUgZm9sbG93aW5nOgoKICAgIEdSQ20zOC4xMDIuY2hyMTlyZWR1Y2VkLmNocmxpc3QKICAgIEdSQ20zOC4xMDIuY2hyMTlyZWR1Y2VkLmdycAogICAgR1JDbTM4LjEwMi5jaHIxOXJlZHVjZWQuaWR4LmZhCiAgICBHUkNtMzguMTAyLmNocjE5cmVkdWNlZC5uMmcuaWR4LmZhCiAgICBHUkNtMzguMTAyLmNocjE5cmVkdWNlZC5zZXEKICAgIEdSQ20zOC4xMDIuY2hyMTlyZWR1Y2VkLnRpCiAgICBHUkNtMzguMTAyLmNocjE5cmVkdWNlZC50cmFuc2NyaXB0cy5mYQogICAgR2Vub21lCiAgICBMb2cub3V0CiAgICBTQQogICAgU0FpbmRleAogICAgY2hyTGVuZ3RoLnR4dAogICAgY2hyTmFtZS50eHQKICAgIGNock5hbWVMZW5ndGgudHh0CiAgICBjaHJTdGFydC50eHQKICAgIGV4b25HZVRySW5mby50YWIKICAgIGV4b25JbmZvLnRhYgogICAgZ2VuZUluZm8udGFiCiAgICBnZW5vbWVQYXJhbWV0ZXJzLnR4dAogICAgc2pkYkluZm8udHh0CiAgICBzamRiTGlzdC5mcm9tR1RGLm91dC50YWIKICAgIHNqZGJMaXN0Lm91dC50YWIKICAgIHRyYW5zY3JpcHRJbmZvLnRhYgoKIyMgYHJzZW0tY2FsY3VsYXRlLWV4cHJlc3Npb25gIERldGFpbHMKCkFmdGVyIHByZXBhcmluZyB0aGUgcmVmZXJlbmNlIGluZGV4LCB3ZSBjYW4gZG8gYWxpZ25tZW50IGFuZCBxdWFudGlmaWNhdGlvbiB3aXRoIHRoZSBgcnNlbS1jYWxjdWxhdGUtZXhwcmVzc2lvbmAgY29tbWFuZCAoW2hlcmVdKGh0dHBzOi8vZGV3ZXlsYWIuZ2l0aHViLmlvL1JTRU0vcnNlbS1jYWxjdWxhdGUtZXhwcmVzc2lvbi5odG1sKSBpcyBhIGxpbmsgdG8gdGhlIG1hbnVhbCkuIEZvciBvdXIgaW5wdXRzLCB3ZSB3aWxsIGJlIHVzaW5nIG91ciBGQVNUUSByZWFkcyBhbmQgdGhlIHBhdGggdG8gdGhlIHJlZmVyZW5jZSBpbmRleCB0aGF0IHdlIGNyZWF0ZS4KClRoZXJlIGFyZSBudW1lcm91cyBvdXRwdXRzLCB3aGljaCBhcmUgbGFpZCBvdXQgaW4gdGhlIGZvbGxvd2luZyB0YWJsZToKCnwgRmlsZSB8IERlc2NyaXB0aW9uIHwKfCAtLS0tIHwgLS0tLS0tLS0tLS0gfAp8IGBzYW1wbGVfTi5nZW5vbWUuYmFtYCB8IFRoZSBhbGlnbm1lbnRzIGluIGdlbm9taWMgY29vcmRpbmF0ZXMuIFVzZWQgZm9yIHZpc3VhbGl6YXRpb24gaW4gYSBnZW5vbWUgYnJvd3NlciBzdWNoIGFzIFtJR1ZdKGh0dHBzOi8vc29mdHdhcmUuYnJvYWRpbnN0aXR1dGUub3JnL3NvZnR3YXJlL2lndi8pLiB8CnwgYHNhbXBsZV9OLnRyYW5zY3JpcHQuYmFtYCB8IFRoZSBhbGlnbm1lbnRzIGluIHRyYW5zY3JpcHRvbWljIGNvb3JkaW5hdGVzLiBOb3QgdXNlZCBmb3IgdGhpcyB3b3Jrc2hvcC4gfAp8IGBzYW1wbGVfTi5nZW5lcy5yZXN1bHRzYCB8IEdlbmUtbGV2ZWwgcmVzdWx0cyB0byBiZSB1c2VkIGluIGRvd25zdHJlYW0gREUgYW5hbHlzaXMuIHwKfCBgc2FtcGxlX04uaXNvZm9ybXMucmVzdWx0c2AgfCBJc29mb3JtLWxldmVsIHJlc3VsdHMuIE5vdCB1c2VkIGZvciB0aGlzIHdvcmtzaG9wLiB8CgoKVGhlIHR3byByZXN1bHRzIHdlIHdpbGwgdXNlIG1vc3Qgb2Z0ZW4gZnJvbSBSU0VNK1NUQVIgYXJlIHRoZSBnZW5lLWxldmVsIHF1YW50aWZpY2F0aW9ucyAoYHNhbXBsZV9OLmdlbmVzLnJlc3VsdHNgKSBhbmQgdGhlIGFsaWdubWVudHMgaW4gZ2Vub21lLWNvb3JkaW5hdGVzIChgc2FtcGxlX04uZ2Vub21lLmJhbWApLiBFYWNoIHNhbXBsZSBmb3Igd2hpY2ggd2UgcnVuIFJTRU0rU1RBUiB3aWxsIGhhdmUgdGhlc2Ugb3V0cHV0IGZpbGVzIG5hbWVkIGFmdGVyIHRoZSBzYW1wbGUuCgojIyMgR2Vub21lIEFsaWdubWVudHMKClRoZSBgc2FtcGxlX04uZ2Vub21lLmJhbWAgYWxpZ25tZW50cyBmaWxlIGlzIGEgc3BlY2lhbCwgY29tcHJlc3NlZCwgdmVyc2lvbiBvZiBhIFNBTSBmaWxlIChzZXF1ZW5jZSBhbGlnbm1lbnQvbWFwKS4gSW4gb3JkZXIgdG8gdmlldyBpdCwgd2UgaGF2ZSB0byB1c2UgYSBzcGVjaWFsIHByb2dyYW0gY2FsbGVkIFtgc2FtdG9vbHNgXShodHRwczovL3d3dy5odHNsaWIub3JnL2RvYy9zYW10b29scy5odG1sKS4KCklmIHdlIHdlcmUgdG8gcGVlayBpbnNpZGUgb2YgYHNhbXBsZV9OLmdlbm9tZS5iYW1gLCB3ZSB3b3VsZCBzZWUgbWFueSBjb2x1bW5zIG9mIGRhdGEuIEJ5IHVzaW5nIGBzYW10b29sc2AsIHdlIHdpbGwgYmUgYWJsZSB0byB2aWV3IHRoZSBjb2x1bW5zIGluIHBsYWluIHRleHQgKFNBTSBmb3JtYXQpLiBUaGUgbWFuZGF0b3J5IGNvbHVtbnMgaW4gU0FNIGZvcm1hdCBhcmUgc2hvd24gaW4gdGhlIGZvbGxvd2luZyB0YWJsZSBmcm9tIHRoZSBbb2ZmaWNpYWwgU0FNL0JBTSBmb3JtYXQgc3BlY2lmaWNhdGlvbl0oaHR0cHM6Ly9zYW10b29scy5naXRodWIuaW8vaHRzLXNwZWNzL1NBTXYxLnBkZikuCgo8aW1nIHNyYz0iaW1hZ2VzL3NhbV9jb2x1bW5zLnBuZyIgd2lkdGg9IjgwMCIgLz4KClRoZSBTQU0gZm9ybWF0IGdpdmVzIGluZm9ybWF0aW9uIGFib3V0IHdoZXJlIGVhY2ggcmVhZCBtYXBzIHRvIGluIHRoZSBnZW5vbWUgKG9uZSByZWFkIHBlciBsaW5lKSwgYW5kIGhhcyBpbmZvcm1hdGlvbiBhYm91dCB0aGF0IG1hcHBpbmcuCgojIyMgR2VuZS1sZXZlbCBRdWFudGlmaWNhdGlvbgoKSWYgd2Ugd2VyZSB0byBsb29rIGF0IHRoZSB0b3AgMyBsaW5lcyBvZiBgc2FtcGxlX04uZ2VuZXMucmVzdWx0c2AsIHdlIHNlZSBpdCBpcyBhIHBsYWluLXRleHQgZmlsZSBzZXBhcmF0ZWQgYnkgdGFicyB3aGVyZSBlYWNoIHJvdyBpcyBhIGdlbmUsIGFuZCB0aGUgY29sdW1ucyBhcmUgZGVzY3JpYmVkIHRoZSBmaXJzdCByb3cuCgoKfCBDb2x1bW4gfCBEZXNjcmlwdGlvbiB8CnwgLS0tLSB8IC0tLS0tLS0tLS0tIHwKfCBnZW5lX2lkIHwgVGhlIElEIGZyb20gdGhlIGdlbmUgbW9kZWwgR1RGLiB8CnwgdHJhbnNjcmlwdF9pZChzKSB8IFRoZSB0cmFuc2NyaXB0IElEcyBjb3JyZXNwb25kaW5nIHRvIHRoZSBnZW5lIGluIHRoZSBnZW5lIG1vZGVsIEdURi4gfAp8IGxlbmd0aCB8IFRoZSB3ZWlnaHRlZCBhdmVyYWdlIG9mIGl0cyB0cmFuc2NyaXB0cycgbGVuZ3Rocy4gfAp8IGVmZmVjdGl2ZV9sZW5ndGggfCBUaGUgd2VpZ2h0ZWQgYXZlcmFnZSwgb3ZlciBpdHMgdHJhbnNjcmlwdHMsIG9mIHRoZSBtZWFuIG51bWJlciBvZiBwb3NpdGlvbnMgZnJvbSB3aGljaCBhIGZyYWdtZW50IG1heSBzdGFydCB3aXRoaW4gdGhlIHNlcXVlbmNlIG9mIHRyYW5zY3JpcHQuIHwKfCBleHBlY3RlZF9jb3VudCB8IFRoZSBzdW0sIG92ZXIgYWxsIHRyYW5zY3JpcHRzLCBvZiB0aGUgZXN0aW1hdGVkIGNvdW50cyBmcm9tIHRoZSBFTSBhbGdvcml0aG0uIHwKfCBUUE0gfCBUcmFuc2NyaXB0IHBlciBtaWxsaW9uLCBhIHJlbGF0aXZlIG1lYXN1cmUgb2YgdHJhbnNjcmlwdCBhYnVuZGFuY2Ugd2hlcmUgdGhlIHN1bSBvZiBhbGwgVFBNcyBpcyAxIG1pbGxpb24uIHwKfCBGUEtNIHwgRnJhZ21lbnRzIHBlciBraWxvYmFzZSBvZiB0cmFuc2NyaXB0IHBlciBtaWxsaW9uIG1hcHBlZCByZWFkcy4gfAoKClRoZSBgZ2VuZXMucmVzdWx0c2AgZmlsZXMgZm9yIGVhY2ggc2FtcGxlIGNhbiBiZSBkaXJlY3RseSBpbXBvcnRlZCBpbnRvIERFU2VxMiB1c2luZyB0aGUgW2B0eGltcG9ydGBdKGh0dHBzOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvdmlnbmV0dGVzL3R4aW1wb3J0L2luc3QvZG9jL3R4aW1wb3J0Lmh0bWwjcnNlbSkgUiBCaW9jb25kdWN0b3IgcGFja2FnZS4KCkFsdGVybmF0aXZlbHksIHdlIGNhbiBjb21iaW5lIHRoZXNlIHJlc3VsdHMgaW50byBhIGNvdW50IG1hdHJpeC4gVGhlIGNvdW50IG1hdHJpeCBjYW4gYmUgdmVyeSB1c2VmdWwsIHNpbmNlIGl0IGNvbnRhaW5zIHN1bW1hcnktbGV2ZWwgZGF0YSBpbiBhIHdpZGVseSBzdXBwb3J0ZWQgZm9ybWF0LCB0aGlzIG1ha2VzIGl0IGdyZWF0IGZvciBzaGFyaW5nIGFuZCBhcyBpbnB1dCBpbnRvIGRpZmZlcmVudCBhbmFseXNlcy4KCgojIyBSU0VNIFByZXBhcmUgUmVmZXJlbmNlIEV4ZXJjaXNlOgoKMS4gVmlldyB0aGUgaGVscCBwYWdlIGZvciByc2VtLXByZXBhcmUtcmVmZXJlbmNlCjIuIENyZWF0ZSBhIGNvbW1hbmQgdGhhdCB3aWxsIGluZGV4IG91ciBleGFtcGxlIGdlbm9tZSwgYnV0IGRvIG5vdCBydW4gaXQKCmBgYAojIFZpZXcgdGhlIGhlbHAgZmlsZQpyc2VtLXByZXBhcmUtcmVmZXJlbmNlIC1oCiMgQ3JlYXRlL2V4ZWN1dGUgdGhlIHByZXBhcmUtcmVmZXJlbmNlIGNvbW1hbmQKcnNlbS1wcmVwYXJlLXJlZmVyZW5jZSAtLWd0ZiAuLi9yZWZzL0dSQ20zOC4xMDIuY2hyMTlyZWR1Y2VkLmd0ZiAtLXN0YXIgLS1udW0tdGhyZWFkcyAxIC4uL3JlZnMvR1JDbTM4LjEwMi5jaHIxOXJlZHVjZWQuZmEgLi4vcmVmcy9HUkNtMzguMTAyLmNocjE5cmVkdWNlZApgYGAKCgojIyBSU0VNIENhbGN1bGF0ZSBFeHByZXNzaW9uIEV4ZXJjaXNlOgoKMS4gVmlldyB0aGUgaGVscCBwYWdlIGZvciByc2VtLWNhbGN1bGF0ZS1leHByZXNzaW9uCjIuIENyZWF0ZSBhIGNvbW1hbmQgdG8gZXhlY3V0ZSBSU0VNIC8gU1RBUiBhbGlnbm1lbnQgYW5kIHF1YW50aWZpY2F0aW9uIGZvciBvbmUgb2Ygb3VyIHNhbXBsZXMKCmBgYAojIEZpcnN0IGNyZWF0ZSBhIGRpcmVjdG9yeSBmb3IgdGhlIGFsaWduZWQgcmVzdWx0cwpta2RpciBvdXRfcnNlbQojIENvbnN0cnVjdCBhbiBSU0VNIGNvbW1hbmQgdG8gYWxpZ24gc2FtcGxlX0EgdG8gb3VyIHJlZmVyZW5jZQpyc2VtLWNhbGN1bGF0ZS1leHByZXNzaW9uIC0tc3RhciAtLW51bS10aHJlYWRzIDEgLS1zdGFyLWd6aXBwZWQtcmVhZC1maWxlIC0tc3Rhci1vdXRwdXQtZ2Vub21lLWJhbSAtLWtlZXAtaW50ZXJtZWRpYXRlLWZpbGVzIG91dF90cmltbWVkL3NhbXBsZV9BX1IxLnRyaW1tZWQuZmFzdHEuZ3ogLi4vcmVmcy9HUkNtMzguMTAyLmNocjE5cmVkdWNlZCBvdXRfcnNlbS9zYW1wbGVfQQpgYGAKPGJyPgo8YnI+CgojIyBBbGlnbmluZyBBbGwgU2FtcGxlcyBFeGVyY2lzZToKCkJlZm9yZSBzdGFydGluZyBvdXIgYWxpZ25tZW50IGV4ZXJjaXNlLCB3ZSBzaG91bGQgbWFrZSBzdXJlIHRoYXQgd2UgYXJlIG9uIHRoZSBzYW1lIHBhZ2UuIEZvbGxvdyB0aGUgbGluayBiZWxvdzoKCltMaW5rIHRvIGFsaWdubWVudCBleGVyY2lzZV0oTW9kdWxlMDNiX2JyZWFrb3V0MDJfc29sLmh0bWwpCgo8YnI+Cjxicj4KCi0tLQoKVGhlc2UgbWF0ZXJpYWxzIGhhdmUgYmVlbiBhZGFwdGVkIGFuZCBleHRlbmRlZCBmcm9tIG1hdGVyaWFscyBjcmVhdGVkIGJ5IHRoZSBbSGFydmFyZCBDaGFuIEJpb2luZm9ybWF0aWNzIENvcmUgKEhCQyldKGh0dHA6Ly9iaW9pbmZvcm1hdGljcy5zcGguaGFydmFyZC5lZHUvKS4gVGhlc2UgYXJlIG9wZW4gYWNjZXNzIG1hdGVyaWFscyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIFtDcmVhdGl2ZSBDb21tb25zIEF0dHJpYnV0aW9uIGxpY2Vuc2UgKENDIEJZIDQuMCldKGh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzQuMC8pLCB3aGljaCBwZXJtaXRzIHVucmVzdHJpY3RlZCB1c2UsIGRpc3RyaWJ1dGlvbiwgYW5kIHJlcHJvZHVjdGlvbiBpbiBhbnkgbWVkaXVtLCBwcm92aWRlZCB0aGUgb3JpZ2luYWwgYXV0aG9yIGFuZCBzb3VyY2UgYXJlIGNyZWRpdGVkLgoKPGJyLz4KPGJyLz4KPGhyLz4KfCBbUHJldmlvdXMgbGVzc29uXShNb2R1bGUwM2FfUmVmZXJlbmNlX0dlbm9tZXMuaHRtbCkgfCBbVG9wIG9mIHRoaXMgbGVzc29uXSgjdG9wKSB8IFtOZXh0IGxlc3Nvbl0oTW9kdWxlMDRfQWxpZ25tZW50X1FDX2FuZF9RdWFudGlmaWNhdGlvbi5odG1sKSB8CnwgOi0tLSB8IDotLS0tOiB8IC0tLTogfAo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module03b_Alignment.md");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
