<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2024-07-31" />

<title>Sample Quality Control</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_Sequence_QC.html">Sequence QC</a>
    </li>
    <li>
      <a href="Module02b_Trimming.html">Trimming</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03a_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module03b_Alignment.html">Alignment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module04_Alignment_QC_and_Quantification.html">Alignment QC and Quantification</a>
    </li>
    <li>
      <a href="Module05_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">DE Introduction</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DE Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">DE Normalization and Modeling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">DE Testing</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visualization</a>
    </li>
    <li>
      <a href="Module12_DEAnnotations.html">DE Annotation</a>
    </li>
    <li>
      <a href="R_bonus_content.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Sample Quality Control</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2024-07-31</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<p>In this module, we will learn:</p>
<ul>
<li>How to generate &amp; interpret common QC visualizations</li>
<li>Implications of batch effect or other technical variablity</li>
<li>When to revise the model used in the DESeq2 initialization</li>
</ul>
<p><br></p>
<div id="differential-expression-workflow"
class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Differential Expression Workflow</h1>
<p>Prior to testing for differential expression between our comparisons
of interest, we’ll first generate plots that will assess how well our
samples match up with our expectations (based on their treatment groups)
and what we might expect to see from our differential expression
comparisons.</p>
<p><img src="images/wayfinder/wayfinder-SampleQCViz.png"
style="width:75.0%" /></p>
<hr />
</div>
<div id="quality-control-visualizations" class="section level1">
<h1>Quality Control Visualizations</h1>
<p>We have already examined quality control assessment at the sequencing
level with <code>FastQC</code> and <code>MultiQC</code>. Now, we will
examine sample-level and gene-level quality control for our expression
data.</p>
<p>To do this, we will first assess the similarity of our samples by
using principal component analysis (PCA). This will allow us to
determine how well patterns in the data fit our expectations from the
experiments design and examine possible sources of variation.</p>
<p>Other common visualizations that we generate for our analyses include
expression heatmaps, sample correlation heatmaps, and boxplots of raw
and/or normalized counts, the code for which (due to time restrictions)
can be found as bonus content throughout the materials for today or in
the bonus content module.</p>
</div>
<div id="principal-component-analysis" class="section level1">
<h1>Principal Component Analysis</h1>
<p>A common and very useful plot for evaluating how well our samples
cluster by treatment groups are Principal Component Analysis (PCA)
plots. PCA is used to bring out patterns in large and complex datasets
using dimensionality reduction.</p>
<p>As described in more detail in <a
href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/">this
blogpost from BioTuring with a helpful step by step explaination</a>,
PCA has three key attributes:</p>
<ul>
<li>Reduces the high dimensionality of a dataset into a few
components.<br />
</li>
<li>Each principle component captures the maximum remaining variation in
a dataset (as illustrated for PC1 and PC2 in the figure below).<br />
</li>
<li>Each principle component is defined by different weights of the
original dimensions (e.g. gene expression).</li>
</ul>
<div class="float">
<img src="images/Blog_pca_6b.png"
alt="Figure from BioTuring - principle component analysis explained simply" />
<div class="figcaption">Figure from BioTuring - principle component
analysis explained simply</div>
</div>
<p>A more detailed overview of the PCA procedure is outlined in <a
href="https://hbctraining.github.io/DGE_workshop/lessons/principal_component_analysis.html">a
Harvard Chan Bioinformatic Core training module</a>, which is based on a
more thorough description presented in a <a
href="https://www.youtube.com/watch?v=_UVHneBUBW0">StatQuest’s
video</a>. Additionally, this <a
href="https://towardsdatascience.com/principal-component-analysis-3c39fbf5cb9d">TowardsDataScience
blog post</a> goes through the math behind PCAs.</p>
<div id="interpreting-pca-plots" class="section level2">
<h2>Interpreting PCA plots</h2>
<p>For most bulk RNA-seq experiments, we expect the majority of the
total variance to be explained by the first two or three principal
components. We see this in an example plot from the <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DESeq2
vignette</a>:</p>
<p><img src="images/PCA0_DESeq2Vignette.png" /></p>
<blockquote>
<h1 id="question" class="unlisted unnumbered">Question</h1>
<p>How might we interpret the variance explained by each principal
component in the context of the labeled sample points?</p>
</blockquote>
</div>
<div id="evaluating-batch-effects-or-possible-confounders"
class="section level2">
<h2>Evaluating batch effects or possible confounders</h2>
<p>PCA plots are also useful for evaluating the impact of
“uninteresting” sources of variance, like library preparation or
sequencer differences. Evidence of batch effects can sometimes be quite
obvious. Let’s look at the PCA plot from the DESeq2 vigentte again but
re-colored to highlight structure in the data.</p>
<p><img src="images/PCA1_DESeq2Vignette.png" /></p>
<p>It turns out this experiment contained samples sequenced single-end
and paired-end. If we add an attribute to the plot for the sequencing
type (paired-end vs. single-end), we see that in this example PC2 (29%
of variance) is primarily explained by this technical covariate.</p>
<p><img src="images/PCA2_DESeq2Vignette.png" /></p>
<p>However, since the samples are clearly separated by experimental
condition on PC1 <strong>and</strong> there are balanced batches, if we
saw this pattern in our data we could incorporate the technical
covariate into our model design, such as outlined in the <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#multi-factor-designs">DESeq2
vignette</a>.</p>
<details>
<summary>
<em>Click for complex design discussion</em>
</summary>
In experiments with more complex designs, such as when there are
interesecting/multiple treatment conditions, it can be less clear what
covariants are influencing expression, such as illustrated from <a
href="http://www.molmine.com/magma/global_analysis/batch_effect.html">this
documenation for a microarray analysis tool</a>. From the PCA labeled by
experimental treatment, we see that samples from the treatment group do
not cluster together and that there is high variance across all
treatment groups. <img src="images/batch_ex1b.jpg" /> However, when
the plot is color coded by the technical batches of probe labeling, we
see that the patterns in the data are better explained by batch than the
experimental conditions. <img src="images/batch_ex1c.jpg" />
</details>
<p><br></p>
</div>
</div>
<div id="create-a-pca" class="section level1">
<h1>Create a PCA</h1>
<p>We’ve already loaded the libraries we need for this module. We have
also thought ahead in the previous module and created the
<code>outputs/figures</code> and <code>outputs/tables</code>
directories.</p>
<p>Below, we will plot the rlog normalized data and generate the PCA
projections for the top 500 using the <code>plotPCA</code> function from
DESeq2, first specifying <code>condition</code> as the condition of
interest, and view the simple plot generated by the function.</p>
<pre class="r"><code># create PCA plot, labeled by condition
pca_plot = plotPCA(rld, intgroup = c(&#39;condition&#39;), ntop = 500)</code></pre>
<pre><code>using ntop=500 top features by variance</code></pre>
<pre class="r"><code>pca_plot</code></pre>
<p><img src="fig/09-PCArlog3-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>The samples don’t appear to cluster too tightly on their
<code>condition</code>, but we do observe that they separate in PC2.
With real data, it is often the case that data doesn’t cluster as well
as you’d expect, or that the covariate of interest is not associated
with the first (or second or third) principal component. That doesn’t
necessarily mean the experiment is a failure, but it does raise
questions such as “What is associated with PC1?”.</p>
<p>Next, let’s plot the same data but now labeling by the batch column
from our metadata and adding a title with <code>ggtitle</code>:</p>
<pre class="r"><code># create PCA plot with batches labeled
pca_plot_batch = plotPCA(rld, intgroup = c(&#39;batch&#39;), ntop = 500) + ggtitle(&quot;Batch labeled - iron deficiency data&quot;)</code></pre>
<pre><code>using ntop=500 top features by variance</code></pre>
<pre class="r"><code>pca_plot_batch</code></pre>
<p><img src="fig/09-BatchPCA-1.png" width="816" style="display: block; margin: auto;" /></p>
<blockquote>
<h2 id="check-in-and-looking-forward"
class="unlisted unnumbered">Check-in and looking forward</h2>
<p>Based on this plot, should we reconsider our original model that only
included the <code>condition</code> column?**</p>
</blockquote>
<p>Next, let’s save these plot as files in our
<code>outputs/figures</code> folder to revisit later. Since both plots
are <code>ggplot</code> objects – you can see this with
<code>class(pca_plot)</code>– we can use <code>ggsave()</code>.</p>
<pre class="r"><code># save PCA plots to file
ggsave(
    filename = file.path(&#39;outputs&#39;, &#39;figures&#39;, &#39;PCA_rlog_condition.pdf&#39;),
    plot = pca_plot_batch,
    width = 6, height = 6, units = &#39;in&#39;)

ggsave(
    filename = file.path(&#39;outputs&#39;, &#39;figures&#39;, &#39;PCA_rlog_batch.pdf&#39;),
    plot = pca_plot_batch,
    width = 6, height = 6, units = &#39;in&#39;)</code></pre>
<p><strong>Checkpoint</strong>: <em>If you generated and saved the
<code>pca_plot</code> PCA plot, please indicate with the green ‘check’
button. Otherwise, please use the red ‘x’ button in your zoom reaction
panel and post any commands AND error messages to slack.</em></p>
<p>While the <code>pca_plot</code> object is a <code>ggplot</code>- we
can also assign the underlying data generated by the
<code>plotPCA</code> function to an object to make plot customization
easier as well as calculate the percent variance of each component</p>
<pre class="r"><code># create table of underlying PCA data that can be used for more customized plots
pcaData &lt;- plotPCA(rld, intgroup=c(&quot;condition&quot;), returnData=TRUE)</code></pre>
<pre><code>using ntop=500 top features by variance</code></pre>
<pre class="r"><code>percentVar &lt;- round(100 * attr(pcaData, &quot;percentVar&quot;)) # store PC axes (% variance)

head(pcaData) # see the data</code></pre>
<pre><code>                PC1       PC2     group condition     name
sample_A  -5.842793 -9.228278   control   control sample_A
sample_B   6.184870 -2.568785   control   control sample_B
sample_C   5.317918 -2.683508   control   control sample_C
sample_D -18.170356  5.027729 deficient deficient sample_D
sample_E   5.116193  1.010066 deficient deficient sample_E
sample_F   7.394167  8.442776 deficient deficient sample_F</code></pre>
<pre class="r"><code>str(pcaData) # check the structure</code></pre>
<pre><code>&#39;data.frame&#39;:   6 obs. of  5 variables:
 $ PC1      : num  -5.84 6.18 5.32 -18.17 5.12 ...
 $ PC2      : num  -9.23 -2.57 -2.68 5.03 1.01 ...
 $ group    : Factor w/ 2 levels &quot;control&quot;,&quot;deficient&quot;: 1 1 1 2 2 2
 $ condition: Factor w/ 2 levels &quot;control&quot;,&quot;deficient&quot;: 1 1 1 2 2 2
 $ name     : chr  &quot;sample_A&quot; &quot;sample_B&quot; &quot;sample_C&quot; &quot;sample_D&quot; ...
 - attr(*, &quot;percentVar&quot;)= num [1:2] 0.582 0.223</code></pre>
<p>With this table of PCA statistics, we can use what we learned at the
end of the Computational Foundations Workshop to customize plot as we
might see necessary.</p>
<p><strong>What are some modifications we might want to make?</strong>
[use slack poll to rank]:</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Change the overall theme of the plot</li>
<li>Add an informative plot title to make interpretation/sharing
easier</li>
<li>Add labels to show which samples correspond to which points</li>
<li>Make our color palette color-blind friendly</li>
<li>Use shape instead of color of the points to indicate groups on the
PCA plot</li>
</ul>
<p><br></p>
<div id="customizing-a-pca" class="section level2">
<h2>Customizing a PCA</h2>
<p>Before working independently on an exercise, we’ll work together to
build a command to plot our <code>pcaData</code> with more familiar
<code>ggplot2</code> syntax.</p>
<p>In this example, we’ll still use color to indicate our groups but
we’ll customize the plot to have the same black and white theme that we
used in Computational Foundations and add an informative title. Recall
that <code>ggplot2</code> adds plot components in layers, and we can add
additional layers with the <code>+</code> sign.</p>
<pre class="r"><code># create custom plot object
PCACustom &lt;- ggplot(pcaData, aes(PC1, PC2, color=condition)) +
  geom_point(size=3) +
  coord_fixed() +
  theme_bw() + 
  labs(title = &quot;PC1 and PC2 for iron deficient mouse samples&quot;)

# add percentVar labels to *displayed plot*
PCACustom + 
  xlab(paste0(&quot;PC1: &quot;,percentVar[1],&quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;,percentVar[2],&quot;% variance&quot;))</code></pre>
<p><img src="fig/09-PCACustomDemo-1.png" width="816" style="display: block; margin: auto;" /></p>
<pre class="r"><code># add percentVar labels to *stored plot object*
PCACustom2 &lt;- PCACustom + 
  xlab(paste0(&quot;PC1: &quot;,percentVar[1],&quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;,percentVar[2],&quot;% variance&quot;))</code></pre>
<p>Now we have our PCA plotted with ggplot functions that might look
more familiar.</p>
<blockquote>
<h2 id="independent-exercise---customize-a-pca">Independent Exercise -
Customize a PCA</h2>
<p>(10-15 minutes)</p>
<p>Like earlier - we’ll plan to work independently in the main room.
This is a time to read function documentation, test out ideas, make
mistakes, and use a search engine to look up errors or possible example
solutions. Please post any questions or errors that arise to slack.
We’ll review possible solutions together at the end.</p>
<p>Try doing the following to the <code>pca_plot</code>, starting with
the “most popular” request and moving on to other customizations if you
have time:</p>
<ul>
<li>Add a title and subtitle to the plot</li>
<li>Update the color palette to be color-blind friendly</li>
<li>Add labels to show which samples correspond to which points</li>
<li>Use shape instead of color to indicate groups on the PCA plot.</li>
<li><em>Challenge</em>: Change the legend title to “Iron Status”.</li>
</ul>
<p><a href="Module09a_breakout.html">Link to exercise</a></p>
</blockquote>
<details>
<summary>
Possible solutions to exercise prompts
</summary>
<p>Here are examples of some possible approaches:</p>
<ul>
<li>Add a title and subtitle to the ggplot plot</li>
</ul>
<pre class="r"><code># add title and subtitle
PCACustom2 + 
  labs(title = &quot;Iron Supplemented Mice&quot;, subtitle = &quot;PCA of top 500 genes&quot;)</code></pre>
<ul>
<li>Add labels to show which samples correspond to which points</li>
</ul>
<pre class="r"><code># display with labels
PCACustom2 + 
  geom_text_repel(aes(label = name), 
                  point.padding = 0.5, 
                  box.padding = 0.5)</code></pre>
<ul>
<li>Make our color palette more color-blind friendly</li>
</ul>
<pre class="r"><code># look at pre-made color palettes from RColorBrewer
display.brewer.all(colorblindFriendly = TRUE)
# use RColorBrewer palette
PCACustom2 + 
  scale_colour_brewer(palette = &quot;Set2&quot;)

# OR customize using manual color palette
# The R Cookbook palette with grey:
cbPalette &lt;- c(&quot;#999999&quot;, &quot;#E69F00&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;, &quot;#0072B2&quot;, &quot;#D55E00&quot;, &quot;#CC79A7&quot;)

# To use for line and point colors, add manual color scaling with custom palette
PCACustom2 + 
  scale_colour_manual(values=cbPalette[2:3])</code></pre>
<ul>
<li>Use shape instead of color to indicate groups on the PCA plot.</li>
</ul>
<pre class="r"><code># generate new aesthetic mapping (with default shapes selected)
ggplot(pcaData, aes(PC1, PC2, shape=condition)) +
  geom_point(size=3) +
  coord_fixed() +
  theme_bw() + 
  xlab(paste0(&quot;PC1: &quot;,percentVar[1],&quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;,percentVar[2],&quot;% variance&quot;))

# generate new aesthetic mapping (with manually selected shapes)
ggplot(pcaData, aes(PC1, PC2, shape=condition)) +
  geom_point(size=3) +
  scale_shape_manual(values = c(1, 4)) +
  coord_fixed() +
  theme_bw() + 
  xlab(paste0(&quot;PC1: &quot;,percentVar[1],&quot;% variance&quot;)) +
  ylab(paste0(&quot;PC2: &quot;,percentVar[2],&quot;% variance&quot;))</code></pre>
<ul>
<li><em>Challenge</em>: Change the legend title to “Iron Status”</li>
</ul>
<pre class="r"><code>#  customize label for colour mapping
PCACustom2 + 
  guides(colour=guide_legend(title=&quot;Iron supplementation status&quot;)) 

# alternatively specify label for aesthetic mapping
PCACustom2 + 
  labs(colour=&quot;Iron supplementation status&quot;)</code></pre>
</details>
<p><br></p>
<hr />
</div>
</div>
<div id="download-plots" class="section level1">
<h1>Download plots</h1>
<p>Rstudio server allows us to download files through the interactive
file panel on the right side. If we navigate into the plot subfolder and
select the <code>PCAplot_rlog_condition.pdf</code> or the file, we can
then click the blue gear symbol labeled <code>More</code> and select
<code>Export...</code>. We should see a prompt regarding the name of the
file and if we click <code>Download</code> the file should show up in
your local “Downloads” folder.</p>
</div>
<div id="optional-content" class="section level1">
<h1>Optional content</h1>
<details>
<summary>
<em>Click for example code for generating a ScreePlot visualization of
variance across all principle components</em>
</summary>
<p>A screeplot is a way to visualize the variance explained by all
principal components. To generate a scree plot, the PCA results need to
be used independently of plotting, such as described by <a
href="https://statquest.org/pca-clearly-explained/">this statquest
post</a> and replicated below.</p>
<pre class="r"><code># generate PCA loadings
pcaLoadings = prcomp(t(assay(rld)), scale. = TRUE)

## get the scree information
pca.var = pcaLoadings$sdev^2
scree = pca.var/sum(pca.var)
barplot((scree[1:10]*100), main=&quot;Scree Plot&quot;, xlab=&quot;Principal Component&quot;, ylab=&quot;Percent Variation&quot;)</code></pre>
<p><img src="fig/09-ScreePlot-1.png" width="816" style="display: block; margin: auto;" /></p>
We can see that the majority (~65%) of the variance across our samples
is explained by the first three principal components, giving us some
additional confidence regarding the quality of our data. In these scree
plot examples from BioTuring, the plot on the left fits what we would
expect for a dataset with high signal from the experimental treatment,
where the majority of the variance is explained by the first few
principal components. The plot on the right illustrates a scenario where
the variance is distributed across many components, which could be due
to low signal from the experimental treatment, complex experimental
design, or confounding factors. image: <img
src="images/proportion-of-variance-blog-horz.jpg" />
</details>
<p><br></p>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Discussed variance within treatment groups</li>
<li>Discussed technical artifacts, including batches</li>
<li>Learned to generate PCA plots</li>
</ul>
<hr />
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<ul>
<li>HBC QC tutorial: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/03_DGE_QC_analysis.html</a></li>
<li>Detailed Heatmap tutorial from Galaxy: <a
href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html"
class="uri">https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html</a></li>
<li>PCA Overview: <a
href="https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/"
class="uri">https://blog.bioturing.com/2018/06/14/principal-component-analysis-explained-simply/</a></li>
</ul>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="Module08_DESeq2DE.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a href="Module10_DEComparisons.html">Next
lesson</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiU2FtcGxlIFF1YWxpdHkgQ29udHJvbCIKYXV0aG9yOiAiVU0gQmlvaW5mb3JtYXRpY3MgQ29yZSIKZGF0ZTogImByIFN5cy5EYXRlKClgIgpvdXRwdXQ6CiAgICAgICAgaHRtbF9kb2N1bWVudDoKICAgICAgICAgICAgaW5jbHVkZXM6CiAgICAgICAgICAgICAgICBpbl9oZWFkZXI6IGhlYWRlci5odG1sCiAgICAgICAgICAgIHRoZW1lOiBwYXBlcgogICAgICAgICAgICB0b2M6IHRydWUKICAgICAgICAgICAgdG9jX2RlcHRoOiA0CiAgICAgICAgICAgIHRvY19mbG9hdDogdHJ1ZQogICAgICAgICAgICBudW1iZXJfc2VjdGlvbnM6IGZhbHNlCiAgICAgICAgICAgIGZpZ19jYXB0aW9uOiB0cnVlCiAgICAgICAgICAgIG1hcmtkb3duOiBHRk0KICAgICAgICAgICAgY29kZV9kb3dubG9hZDogdHJ1ZQotLS0KCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CmJvZHksIHRkIHsKICAgZm9udC1zaXplOiAxOHB4Owp9CmNvZGUucnsKICBmb250LXNpemU6IDEycHg7Cn0KcHJlIHsKICBmb250LXNpemU6IDEycHgKfQo8L3N0eWxlPgoKYGBge3IsIGluY2x1ZGUgPSBGQUxTRX0Kc291cmNlKCIuLi9iaW4vY2h1bmstb3B0aW9ucy5SIikKa25pdHJfZmlnX3BhdGgoIjA5LSIpCmBgYAoKSW4gdGhpcyBtb2R1bGUsIHdlIHdpbGwgbGVhcm46CgoqIEhvdyB0byBnZW5lcmF0ZSAmIGludGVycHJldCBjb21tb24gUUMgdmlzdWFsaXphdGlvbnMKKiBJbXBsaWNhdGlvbnMgb2YgYmF0Y2ggZWZmZWN0IG9yIG90aGVyIHRlY2huaWNhbCB2YXJpYWJsaXR5CiogV2hlbiB0byByZXZpc2UgdGhlIG1vZGVsIHVzZWQgaW4gdGhlIERFU2VxMiBpbml0aWFsaXphdGlvbgoKCjxicj4KCmBgYHtyIE1vZHVsZXMsIGV2YWw9VFJVRSwgZWNobz1GQUxTRSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KbGlicmFyeShERVNlcTIpCmxpYnJhcnkoZ2dwbG90MikKbGlicmFyeSh0aWR5cikKbGlicmFyeShkcGx5cikKbGlicmFyeShtYXRyaXhTdGF0cykKbGlicmFyeShnZ3JlcGVsKQpsaWJyYXJ5KHBoZWF0bWFwKQpsaWJyYXJ5KFJDb2xvckJyZXdlcikKIyBsb2FkKCJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKIyBEaWZmZXJlbnRpYWwgRXhwcmVzc2lvbiBXb3JrZmxvdyB7LnVubGlzdGVkIC51bm51bWJlcmVkfQoKUHJpb3IgdG8gdGVzdGluZyBmb3IgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gYmV0d2VlbiBvdXIgY29tcGFyaXNvbnMgb2YgaW50ZXJlc3QsIHdlJ2xsIGZpcnN0IGdlbmVyYXRlIHBsb3RzIHRoYXQgd2lsbCBhc3Nlc3MgaG93IHdlbGwgb3VyIHNhbXBsZXMgbWF0Y2ggdXAgd2l0aCBvdXIgZXhwZWN0YXRpb25zIChiYXNlZCBvbiB0aGVpciB0cmVhdG1lbnQgZ3JvdXBzKSBhbmQgd2hhdCB3ZSBtaWdodCBleHBlY3QgdG8gc2VlIGZyb20gb3VyIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIGNvbXBhcmlzb25zLgoKIVtdKC4vaW1hZ2VzL3dheWZpbmRlci93YXlmaW5kZXItU2FtcGxlUUNWaXoucG5nKXt3aWR0aD03NSV9CgotLS0KCiMgUXVhbGl0eSBDb250cm9sIFZpc3VhbGl6YXRpb25zCgpXZSBoYXZlIGFscmVhZHkgZXhhbWluZWQgcXVhbGl0eSBjb250cm9sIGFzc2Vzc21lbnQgYXQgdGhlIHNlcXVlbmNpbmcgbGV2ZWwgd2l0aCBgRmFzdFFDYCBhbmQgYE11bHRpUUNgLiBOb3csIHdlIHdpbGwgZXhhbWluZSBzYW1wbGUtbGV2ZWwgYW5kIGdlbmUtbGV2ZWwgcXVhbGl0eSBjb250cm9sIGZvciBvdXIgZXhwcmVzc2lvbiBkYXRhLgoKVG8gZG8gdGhpcywgd2Ugd2lsbCBmaXJzdCBhc3Nlc3MgdGhlIHNpbWlsYXJpdHkgb2Ygb3VyIHNhbXBsZXMgYnkgdXNpbmcgcHJpbmNpcGFsIGNvbXBvbmVudCBhbmFseXNpcyAoUENBKS4gVGhpcyB3aWxsIGFsbG93IHVzIHRvIGRldGVybWluZSBob3cgd2VsbCBwYXR0ZXJucyBpbiB0aGUgZGF0YSBmaXQgb3VyIGV4cGVjdGF0aW9ucyBmcm9tIHRoZSBleHBlcmltZW50cyBkZXNpZ24gYW5kIGV4YW1pbmUgcG9zc2libGUgc291cmNlcyBvZiB2YXJpYXRpb24uCgpPdGhlciBjb21tb24gdmlzdWFsaXphdGlvbnMgdGhhdCB3ZSBnZW5lcmF0ZSBmb3Igb3VyIGFuYWx5c2VzIGluY2x1ZGUgZXhwcmVzc2lvbiBoZWF0bWFwcywgc2FtcGxlIGNvcnJlbGF0aW9uIGhlYXRtYXBzLCBhbmQgYm94cGxvdHMgb2YgcmF3IGFuZC9vciBub3JtYWxpemVkIGNvdW50cywgdGhlIGNvZGUgZm9yIHdoaWNoIChkdWUgdG8gdGltZSByZXN0cmljdGlvbnMpIGNhbiBiZSBmb3VuZCBhcyBib251cyBjb250ZW50IHRocm91Z2hvdXQgdGhlIG1hdGVyaWFscyBmb3IgdG9kYXkgb3IgaW4gdGhlIGJvbnVzIGNvbnRlbnQgbW9kdWxlLgoKIyBQcmluY2lwYWwgQ29tcG9uZW50IEFuYWx5c2lzCgpBIGNvbW1vbiBhbmQgdmVyeSB1c2VmdWwgcGxvdCBmb3IgZXZhbHVhdGluZyBob3cgd2VsbCBvdXIgc2FtcGxlcyBjbHVzdGVyIGJ5IHRyZWF0bWVudCBncm91cHMgYXJlIFByaW5jaXBhbCBDb21wb25lbnQgQW5hbHlzaXMgKFBDQSkgcGxvdHMuIFBDQSBpcyB1c2VkIHRvIGJyaW5nIG91dCBwYXR0ZXJucyBpbiBsYXJnZSBhbmQgY29tcGxleCBkYXRhc2V0cyB1c2luZyBkaW1lbnNpb25hbGl0eSByZWR1Y3Rpb24uCgpBcyBkZXNjcmliZWQgaW4gbW9yZSBkZXRhaWwgaW4gW3RoaXMgYmxvZ3Bvc3QgZnJvbSBCaW9UdXJpbmcgd2l0aCBhIGhlbHBmdWwgc3RlcCBieSBzdGVwIGV4cGxhaW5hdGlvbiBdKGh0dHBzOi8vYmxvZy5iaW90dXJpbmcuY29tLzIwMTgvMDYvMTQvcHJpbmNpcGFsLWNvbXBvbmVudC1hbmFseXNpcy1leHBsYWluZWQtc2ltcGx5LyksIFBDQSBoYXMgdGhyZWUga2V5IGF0dHJpYnV0ZXM6CgoqIFJlZHVjZXMgdGhlIGhpZ2ggZGltZW5zaW9uYWxpdHkgb2YgYSBkYXRhc2V0IGludG8gYSBmZXcgY29tcG9uZW50cy4gIAoqIEVhY2ggcHJpbmNpcGxlIGNvbXBvbmVudCBjYXB0dXJlcyB0aGUgbWF4aW11bSByZW1haW5pbmcgdmFyaWF0aW9uIGluIGEgZGF0YXNldCAoYXMgaWxsdXN0cmF0ZWQgZm9yIFBDMSBhbmQgUEMyIGluIHRoZSBmaWd1cmUgYmVsb3cpLiAgCiogRWFjaCBwcmluY2lwbGUgY29tcG9uZW50IGlzIGRlZmluZWQgYnkgZGlmZmVyZW50IHdlaWdodHMgb2YgdGhlIG9yaWdpbmFsIGRpbWVuc2lvbnMgKGUuZy4gZ2VuZSBleHByZXNzaW9uKS4gIAoKIVtGaWd1cmUgZnJvbSBCaW9UdXJpbmcgLSBwcmluY2lwbGUgY29tcG9uZW50IGFuYWx5c2lzIGV4cGxhaW5lZCBzaW1wbHldKC4vaW1hZ2VzL0Jsb2dfcGNhXzZiLnBuZykKCgpBIG1vcmUgZGV0YWlsZWQgb3ZlcnZpZXcgb2YgdGhlIFBDQSBwcm9jZWR1cmUgaXMgb3V0bGluZWQgaW4gW2EgSGFydmFyZCBDaGFuIEJpb2luZm9ybWF0aWMgQ29yZSB0cmFpbmluZyBtb2R1bGVdKGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zL3ByaW5jaXBhbF9jb21wb25lbnRfYW5hbHlzaXMuaHRtbCksIHdoaWNoIGlzIGJhc2VkIG9uIGEgbW9yZSB0aG9yb3VnaCBkZXNjcmlwdGlvbiBwcmVzZW50ZWQgaW4gYSBbU3RhdFF1ZXN04oCZcyB2aWRlb10oaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1fVVZIbmVCVUJXMCkuIEFkZGl0aW9uYWxseSwgdGhpcyBbVG93YXJkc0RhdGFTY2llbmNlIGJsb2cgcG9zdF0oaHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL3ByaW5jaXBhbC1jb21wb25lbnQtYW5hbHlzaXMtM2MzOWZiZjVjYjlkKSBnb2VzIHRocm91Z2ggdGhlIG1hdGggYmVoaW5kIFBDQXMuCgoKIyMgSW50ZXJwcmV0aW5nIFBDQSBwbG90cwoKRm9yIG1vc3QgYnVsayBSTkEtc2VxIGV4cGVyaW1lbnRzLCB3ZSBleHBlY3QgdGhlIG1ham9yaXR5IG9mIHRoZSB0b3RhbCB2YXJpYW5jZSB0byBiZSBleHBsYWluZWQgYnkgdGhlIGZpcnN0IHR3byBvciB0aHJlZSBwcmluY2lwYWwgY29tcG9uZW50cy4gV2Ugc2VlIHRoaXMgaW4gYW4gZXhhbXBsZSBwbG90IGZyb20gdGhlIFtERVNlcTIgdmlnbmV0dGVdKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCk6CgohW10oLi9pbWFnZXMvUENBMF9ERVNlcTJWaWduZXR0ZS5wbmcpCgo+ICMgUXVlc3Rpb24gey51bmxpc3RlZCAudW5udW1iZXJlZH0KPgo+IEhvdyBtaWdodCB3ZSBpbnRlcnByZXQgdGhlIHZhcmlhbmNlIGV4cGxhaW5lZCBieSBlYWNoIHByaW5jaXBhbCBjb21wb25lbnQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGxhYmVsZWQgc2FtcGxlIHBvaW50cz8KCgojIyBFdmFsdWF0aW5nIGJhdGNoIGVmZmVjdHMgb3IgcG9zc2libGUgY29uZm91bmRlcnMKClBDQSBwbG90cyBhcmUgYWxzbyB1c2VmdWwgZm9yIGV2YWx1YXRpbmcgdGhlIGltcGFjdCBvZiAidW5pbnRlcmVzdGluZyIgc291cmNlcyBvZiB2YXJpYW5jZSwgbGlrZSBsaWJyYXJ5IHByZXBhcmF0aW9uIG9yIHNlcXVlbmNlciBkaWZmZXJlbmNlcy4gRXZpZGVuY2Ugb2YgYmF0Y2ggZWZmZWN0cyBjYW4gc29tZXRpbWVzIGJlIHF1aXRlIG9idmlvdXMuIExldCdzIGxvb2sgYXQgdGhlIFBDQSBwbG90IGZyb20gdGhlIERFU2VxMiB2aWdlbnR0ZSBhZ2FpbiBidXQgcmUtY29sb3JlZCB0byBoaWdobGlnaHQgc3RydWN0dXJlIGluIHRoZSBkYXRhLgoKIVtdKC4vaW1hZ2VzL1BDQTFfREVTZXEyVmlnbmV0dGUucG5nKQoKSXQgdHVybnMgb3V0IHRoaXMgZXhwZXJpbWVudCBjb250YWluZWQgc2FtcGxlcyBzZXF1ZW5jZWQgc2luZ2xlLWVuZCBhbmQgcGFpcmVkLWVuZC4gSWYgd2UgYWRkIGFuIGF0dHJpYnV0ZSB0byB0aGUgcGxvdCBmb3IgdGhlIHNlcXVlbmNpbmcgdHlwZSAocGFpcmVkLWVuZCB2cy4gc2luZ2xlLWVuZCksIHdlIHNlZSB0aGF0IGluIHRoaXMgZXhhbXBsZSBQQzIgKDI5JSBvZiB2YXJpYW5jZSkgaXMgcHJpbWFyaWx5IGV4cGxhaW5lZCBieSB0aGlzIHRlY2huaWNhbCBjb3ZhcmlhdGUuCgohW10oLi9pbWFnZXMvUENBMl9ERVNlcTJWaWduZXR0ZS5wbmcpCgpIb3dldmVyLCBzaW5jZSB0aGUgc2FtcGxlcyBhcmUgY2xlYXJseSBzZXBhcmF0ZWQgYnkgZXhwZXJpbWVudGFsIGNvbmRpdGlvbiBvbiBQQzEgKiphbmQqKiB0aGVyZSBhcmUgYmFsYW5jZWQgYmF0Y2hlcywgaWYgd2Ugc2F3IHRoaXMgcGF0dGVybiBpbiBvdXIgZGF0YSB3ZSBjb3VsZCBpbmNvcnBvcmF0ZSB0aGUgdGVjaG5pY2FsIGNvdmFyaWF0ZSBpbnRvIG91ciBtb2RlbCBkZXNpZ24sIHN1Y2ggYXMgb3V0bGluZWQgaW4gdGhlIFtERVNlcTIgdmlnbmV0dGVdKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCNtdWx0aS1mYWN0b3ItZGVzaWducykuCgo8ZGV0YWlscz4KICAgIDxzdW1tYXJ5PipDbGljayBmb3IgY29tcGxleCBkZXNpZ24gZGlzY3Vzc2lvbio8L3N1bW1hcnk+CiAgICBJbiBleHBlcmltZW50cyB3aXRoIG1vcmUgY29tcGxleCBkZXNpZ25zLCBzdWNoIGFzIHdoZW4gdGhlcmUgYXJlIGludGVyZXNlY3RpbmcvbXVsdGlwbGUgdHJlYXRtZW50IGNvbmRpdGlvbnMsIGl0IGNhbiBiZSBsZXNzIGNsZWFyIHdoYXQgY292YXJpYW50cyBhcmUgaW5mbHVlbmNpbmcgZXhwcmVzc2lvbiwgc3VjaCBhcyBpbGx1c3RyYXRlZCBmcm9tIFt0aGlzIGRvY3VtZW5hdGlvbiBmb3IgYSBtaWNyb2FycmF5IGFuYWx5c2lzIHRvb2xdKGh0dHA6Ly93d3cubW9sbWluZS5jb20vbWFnbWEvZ2xvYmFsX2FuYWx5c2lzL2JhdGNoX2VmZmVjdC5odG1sKS4KICAgIEZyb20gdGhlIFBDQSBsYWJlbGVkIGJ5IGV4cGVyaW1lbnRhbCB0cmVhdG1lbnQsIHdlIHNlZSB0aGF0IHNhbXBsZXMgZnJvbSB0aGUgdHJlYXRtZW50IGdyb3VwIGRvIG5vdCBjbHVzdGVyIHRvZ2V0aGVyIGFuZCB0aGF0IHRoZXJlIGlzIGhpZ2ggdmFyaWFuY2UgYWNyb3NzIGFsbCB0cmVhdG1lbnQgZ3JvdXBzLgogICAgIVtdKC4vaW1hZ2VzL2JhdGNoX2V4MWIuanBnKQogICAgSG93ZXZlciwgd2hlbiB0aGUgcGxvdCBpcyBjb2xvciBjb2RlZCBieSB0aGUgdGVjaG5pY2FsIGJhdGNoZXMgb2YgcHJvYmUgbGFiZWxpbmcsIHdlIHNlZSB0aGF0IHRoZSBwYXR0ZXJucyBpbiB0aGUgZGF0YSBhcmUgYmV0dGVyIGV4cGxhaW5lZCBieSBiYXRjaCB0aGFuIHRoZSBleHBlcmltZW50YWwgY29uZGl0aW9ucy4KICAgICFbXSguL2ltYWdlcy9iYXRjaF9leDFjLmpwZykKPC9kZXRhaWxzPgo8YnI+CgojIENyZWF0ZSBhIFBDQQoKV2UndmUgYWxyZWFkeSBsb2FkZWQgdGhlIGxpYnJhcmllcyB3ZSBuZWVkIGZvciB0aGlzIG1vZHVsZS4gV2UgaGF2ZSBhbHNvIHRob3VnaHQgYWhlYWQgaW4gdGhlIHByZXZpb3VzIG1vZHVsZSBhbmQgY3JlYXRlZCB0aGUgYG91dHB1dHMvZmlndXJlc2AgYW5kIGBvdXRwdXRzL3RhYmxlc2AgZGlyZWN0b3JpZXMuCgpCZWxvdywgd2Ugd2lsbCBwbG90IHRoZSBybG9nIG5vcm1hbGl6ZWQgZGF0YSBhbmQgZ2VuZXJhdGUgdGhlIFBDQSBwcm9qZWN0aW9ucyBmb3IgdGhlIHRvcCA1MDAgdXNpbmcgdGhlIGBwbG90UENBYCBmdW5jdGlvbiBmcm9tIERFU2VxMiwgZmlyc3Qgc3BlY2lmeWluZyBgY29uZGl0aW9uYCBhcyB0aGUgY29uZGl0aW9uIG9mIGludGVyZXN0LCBhbmQgdmlldyB0aGUgc2ltcGxlIHBsb3QgZ2VuZXJhdGVkIGJ5IHRoZSBmdW5jdGlvbi4KCmBgYHtyIFBDQXJsb2czfQojIGNyZWF0ZSBQQ0EgcGxvdCwgbGFiZWxlZCBieSBjb25kaXRpb24KcGNhX3Bsb3QgPSBwbG90UENBKHJsZCwgaW50Z3JvdXAgPSBjKCdjb25kaXRpb24nKSwgbnRvcCA9IDUwMCkKcGNhX3Bsb3QKYGBgCgpUaGUgc2FtcGxlcyBkb24ndCBhcHBlYXIgdG8gY2x1c3RlciB0b28gdGlnaHRseSBvbiB0aGVpciBgY29uZGl0aW9uYCwgYnV0IHdlIGRvIG9ic2VydmUgdGhhdCB0aGV5IHNlcGFyYXRlIGluIFBDMi4gV2l0aCByZWFsIGRhdGEsIGl0IGlzIG9mdGVuIHRoZSBjYXNlIHRoYXQgZGF0YSBkb2Vzbid0IGNsdXN0ZXIgYXMgd2VsbCBhcyB5b3UnZCBleHBlY3QsIG9yIHRoYXQgdGhlIGNvdmFyaWF0ZSBvZiBpbnRlcmVzdCBpcyBub3QgYXNzb2NpYXRlZCB3aXRoIHRoZSBmaXJzdCAob3Igc2Vjb25kIG9yIHRoaXJkKSBwcmluY2lwYWwgY29tcG9uZW50LiBUaGF0IGRvZXNuJ3QgbmVjZXNzYXJpbHkgbWVhbiB0aGUgZXhwZXJpbWVudCBpcyBhIGZhaWx1cmUsIGJ1dCBpdCBkb2VzIHJhaXNlIHF1ZXN0aW9ucyBzdWNoIGFzICJXaGF0IGlzIGFzc29jaWF0ZWQgd2l0aCBQQzE/Ii4KCk5leHQsIGxldCdzIHBsb3QgdGhlIHNhbWUgZGF0YSBidXQgbm93IGxhYmVsaW5nIGJ5IHRoZSBiYXRjaCBjb2x1bW4gZnJvbSBvdXIgbWV0YWRhdGEgYW5kIGFkZGluZyBhIHRpdGxlIHdpdGggYGdndGl0bGVgOgpgYGB7ciBCYXRjaFBDQX0KIyBjcmVhdGUgUENBIHBsb3Qgd2l0aCBiYXRjaGVzIGxhYmVsZWQKcGNhX3Bsb3RfYmF0Y2ggPSBwbG90UENBKHJsZCwgaW50Z3JvdXAgPSBjKCdiYXRjaCcpLCBudG9wID0gNTAwKSArIGdndGl0bGUoIkJhdGNoIGxhYmVsZWQgLSBpcm9uIGRlZmljaWVuY3kgZGF0YSIpCnBjYV9wbG90X2JhdGNoCmBgYAoKPiAjIyBDaGVjay1pbiBhbmQgbG9va2luZyBmb3J3YXJkIHsudW5saXN0ZWQgLnVubnVtYmVyZWR9Cj4KPiBCYXNlZCBvbiB0aGlzIHBsb3QsIHNob3VsZCB3ZSByZWNvbnNpZGVyIG91ciBvcmlnaW5hbCBtb2RlbCB0aGF0IG9ubHkgaW5jbHVkZWQgdGhlIGBjb25kaXRpb25gIGNvbHVtbj8qKgoKCk5leHQsIGxldCdzIHNhdmUgdGhlc2UgcGxvdCBhcyBmaWxlcyBpbiBvdXIgYG91dHB1dHMvZmlndXJlc2AgZm9sZGVyIHRvIHJldmlzaXQgbGF0ZXIuIFNpbmNlIGJvdGggcGxvdHMgYXJlIGBnZ3Bsb3RgIG9iamVjdHMgLS0geW91IGNhbiBzZWUgdGhpcyB3aXRoIGBjbGFzcyhwY2FfcGxvdClgLS0gd2UgY2FuIHVzZSBgZ2dzYXZlKClgLgoKYGBge3Igc2F2ZV9wY2FfZ2dzYXZlLCBldmFsID0gRkFMU0V9CiMgc2F2ZSBQQ0EgcGxvdHMgdG8gZmlsZQpnZ3NhdmUoCiAgICBmaWxlbmFtZSA9IGZpbGUucGF0aCgnb3V0cHV0cycsICdmaWd1cmVzJywgJ1BDQV9ybG9nX2NvbmRpdGlvbi5wZGYnKSwKICAgIHBsb3QgPSBwY2FfcGxvdF9iYXRjaCwKICAgIHdpZHRoID0gNiwgaGVpZ2h0ID0gNiwgdW5pdHMgPSAnaW4nKQoKZ2dzYXZlKAogICAgZmlsZW5hbWUgPSBmaWxlLnBhdGgoJ291dHB1dHMnLCAnZmlndXJlcycsICdQQ0FfcmxvZ19iYXRjaC5wZGYnKSwKICAgIHBsb3QgPSBwY2FfcGxvdF9iYXRjaCwKICAgIHdpZHRoID0gNiwgaGVpZ2h0ID0gNiwgdW5pdHMgPSAnaW4nKQpgYGAKCgoKKipDaGVja3BvaW50Kio6ICpJZiB5b3UgZ2VuZXJhdGVkIGFuZCBzYXZlZCB0aGUgYHBjYV9wbG90YCBQQ0EgcGxvdCwgcGxlYXNlIGluZGljYXRlIHdpdGggdGhlIGdyZWVuICdjaGVjaycgYnV0dG9uLiBPdGhlcndpc2UsIHBsZWFzZSB1c2UgdGhlIHJlZCAneCcgYnV0dG9uIGluIHlvdXIgem9vbSByZWFjdGlvbiBwYW5lbCBhbmQgcG9zdCBhbnkgY29tbWFuZHMgQU5EIGVycm9yIG1lc3NhZ2VzIHRvIHNsYWNrLioKCgpXaGlsZSB0aGUgYHBjYV9wbG90YCBvYmplY3QgaXMgYSBgZ2dwbG90YC0gd2UgY2FuIGFsc28gYXNzaWduIHRoZSB1bmRlcmx5aW5nIGRhdGEgZ2VuZXJhdGVkIGJ5IHRoZSBgcGxvdFBDQWAgZnVuY3Rpb24gdG8gYW4gb2JqZWN0IHRvIG1ha2UgcGxvdCBjdXN0b21pemF0aW9uIGVhc2llciBhcyB3ZWxsIGFzIGNhbGN1bGF0ZSB0aGUgcGVyY2VudCB2YXJpYW5jZSBvZiBlYWNoIGNvbXBvbmVudCAKCmBgYHtyIFBDQVRhYmxlfQojIGNyZWF0ZSB0YWJsZSBvZiB1bmRlcmx5aW5nIFBDQSBkYXRhIHRoYXQgY2FuIGJlIHVzZWQgZm9yIG1vcmUgY3VzdG9taXplZCBwbG90cwpwY2FEYXRhIDwtIHBsb3RQQ0EocmxkLCBpbnRncm91cD1jKCJjb25kaXRpb24iKSwgcmV0dXJuRGF0YT1UUlVFKQpwZXJjZW50VmFyIDwtIHJvdW5kKDEwMCAqIGF0dHIocGNhRGF0YSwgInBlcmNlbnRWYXIiKSkgIyBzdG9yZSBQQyBheGVzICglIHZhcmlhbmNlKQoKaGVhZChwY2FEYXRhKSAjIHNlZSB0aGUgZGF0YQpzdHIocGNhRGF0YSkgIyBjaGVjayB0aGUgc3RydWN0dXJlCmBgYAoKCldpdGggdGhpcyB0YWJsZSBvZiBQQ0Egc3RhdGlzdGljcywgd2UgY2FuIHVzZSB3aGF0IHdlIGxlYXJuZWQgYXQgdGhlIGVuZCBvZiB0aGUgQ29tcHV0YXRpb25hbCBGb3VuZGF0aW9ucyBXb3Jrc2hvcCB0byBjdXN0b21pemUgcGxvdCBhcyB3ZSBtaWdodCBzZWUgbmVjZXNzYXJ5LiAKCioqV2hhdCBhcmUgc29tZSBtb2RpZmljYXRpb25zIHdlIG1pZ2h0IHdhbnQgdG8gbWFrZT8qKiBbdXNlIHNsYWNrIHBvbGwgdG8gcmFua106CgoqKkV4YW1wbGVzOioqCgotIENoYW5nZSB0aGUgb3ZlcmFsbCB0aGVtZSBvZiB0aGUgcGxvdAotIEFkZCBhbiBpbmZvcm1hdGl2ZSBwbG90IHRpdGxlIHRvIG1ha2UgaW50ZXJwcmV0YXRpb24vc2hhcmluZyBlYXNpZXIKLSBBZGQgbGFiZWxzIHRvIHNob3cgd2hpY2ggc2FtcGxlcyBjb3JyZXNwb25kIHRvIHdoaWNoIHBvaW50cwotIE1ha2Ugb3VyIGNvbG9yIHBhbGV0dGUgY29sb3ItYmxpbmQgZnJpZW5kbHkKLSBVc2Ugc2hhcGUgaW5zdGVhZCBvZiBjb2xvciBvZiB0aGUgcG9pbnRzIHRvIGluZGljYXRlIGdyb3VwcyBvbiB0aGUgUENBIHBsb3QKCjxicj4KCiMjIEN1c3RvbWl6aW5nIGEgUENBCgpCZWZvcmUgd29ya2luZyBpbmRlcGVuZGVudGx5IG9uIGFuIGV4ZXJjaXNlLCB3ZSdsbCB3b3JrIHRvZ2V0aGVyIHRvIGJ1aWxkIGEgY29tbWFuZCB0byBwbG90IG91ciBgcGNhRGF0YWAgd2l0aCBtb3JlIGZhbWlsaWFyIGBnZ3Bsb3QyYCBzeW50YXguIAoKSW4gdGhpcyBleGFtcGxlLCB3ZSdsbCBzdGlsbCB1c2UgY29sb3IgdG8gaW5kaWNhdGUgb3VyIGdyb3VwcyBidXQgd2UnbGwgY3VzdG9taXplIHRoZSBwbG90IHRvIGhhdmUgdGhlIHNhbWUgYmxhY2sgYW5kIHdoaXRlIHRoZW1lIHRoYXQgd2UgdXNlZCBpbiBDb21wdXRhdGlvbmFsIEZvdW5kYXRpb25zIGFuZCBhZGQgYW4gaW5mb3JtYXRpdmUgdGl0bGUuIFJlY2FsbCB0aGF0IGBnZ3Bsb3QyYCBhZGRzIHBsb3QgY29tcG9uZW50cyBpbiBsYXllcnMsIGFuZCB3ZSBjYW4gYWRkIGFkZGl0aW9uYWwgbGF5ZXJzIHdpdGggdGhlIGArYCBzaWduLgoKYGBge3IgUENBQ3VzdG9tRGVtb30KIyBjcmVhdGUgY3VzdG9tIHBsb3Qgb2JqZWN0ClBDQUN1c3RvbSA8LSBnZ3Bsb3QocGNhRGF0YSwgYWVzKFBDMSwgUEMyLCBjb2xvcj1jb25kaXRpb24pKSArCiAgZ2VvbV9wb2ludChzaXplPTMpICsKICBjb29yZF9maXhlZCgpICsKICB0aGVtZV9idygpICsgCiAgbGFicyh0aXRsZSA9ICJQQzEgYW5kIFBDMiBmb3IgaXJvbiBkZWZpY2llbnQgbW91c2Ugc2FtcGxlcyIpCgojIGFkZCBwZXJjZW50VmFyIGxhYmVscyB0byAqZGlzcGxheWVkIHBsb3QqClBDQUN1c3RvbSArIAogIHhsYWIocGFzdGUwKCJQQzE6ICIscGVyY2VudFZhclsxXSwiJSB2YXJpYW5jZSIpKSArCiAgeWxhYihwYXN0ZTAoIlBDMjogIixwZXJjZW50VmFyWzJdLCIlIHZhcmlhbmNlIikpCgojIGFkZCBwZXJjZW50VmFyIGxhYmVscyB0byAqc3RvcmVkIHBsb3Qgb2JqZWN0KgpQQ0FDdXN0b20yIDwtIFBDQUN1c3RvbSArIAogIHhsYWIocGFzdGUwKCJQQzE6ICIscGVyY2VudFZhclsxXSwiJSB2YXJpYW5jZSIpKSArCiAgeWxhYihwYXN0ZTAoIlBDMjogIixwZXJjZW50VmFyWzJdLCIlIHZhcmlhbmNlIikpCgpgYGAKCk5vdyB3ZSBoYXZlIG91ciBQQ0EgcGxvdHRlZCB3aXRoIGdncGxvdCBmdW5jdGlvbnMgdGhhdCBtaWdodCBsb29rIG1vcmUgZmFtaWxpYXIuCgoKCj4gIyMgSW5kZXBlbmRlbnQgRXhlcmNpc2UgLSBDdXN0b21pemUgYSBQQ0EgCj4gKDEwLTE1IG1pbnV0ZXMpCj4gCj4gTGlrZSBlYXJsaWVyIC0gd2UnbGwgcGxhbiB0byB3b3JrIGluZGVwZW5kZW50bHkgaW4gdGhlIG1haW4gcm9vbS4gVGhpcyBpcyBhIHRpbWUgdG8gcmVhZCBmdW5jdGlvbiBkb2N1bWVudGF0aW9uLCB0ZXN0IG91dCBpZGVhcywgbWFrZSBtaXN0YWtlcywgYW5kIHVzZSBhIHNlYXJjaCBlbmdpbmUgdG8gbG9vayB1cCBlcnJvcnMgb3IgcG9zc2libGUgZXhhbXBsZSBzb2x1dGlvbnMuIFBsZWFzZSBwb3N0IGFueSBxdWVzdGlvbnMgb3IgZXJyb3JzIHRoYXQgYXJpc2UgdG8gc2xhY2suIFdlJ2xsIHJldmlldyBwb3NzaWJsZSBzb2x1dGlvbnMgdG9nZXRoZXIgYXQgdGhlIGVuZC4KPiAKPiAKPiBUcnkgZG9pbmcgdGhlIGZvbGxvd2luZyB0byB0aGUgYHBjYV9wbG90YCwgc3RhcnRpbmcgd2l0aCB0aGUgIm1vc3QgcG9wdWxhciIgcmVxdWVzdCBhbmQgbW92aW5nIG9uIHRvIG90aGVyIGN1c3RvbWl6YXRpb25zIGlmIHlvdSBoYXZlIHRpbWU6Cj4KPiAqIEFkZCBhIHRpdGxlIGFuZCBzdWJ0aXRsZSB0byB0aGUgcGxvdAo+ICogVXBkYXRlIHRoZSBjb2xvciBwYWxldHRlIHRvIGJlIGNvbG9yLWJsaW5kIGZyaWVuZGx5Cj4gKiBBZGQgbGFiZWxzIHRvIHNob3cgd2hpY2ggc2FtcGxlcyBjb3JyZXNwb25kIHRvIHdoaWNoIHBvaW50cwo+ICogVXNlIHNoYXBlIGluc3RlYWQgb2YgY29sb3IgdG8gaW5kaWNhdGUgZ3JvdXBzIG9uIHRoZSBQQ0EgcGxvdC4KPiAqIF9DaGFsbGVuZ2VfOiBDaGFuZ2UgdGhlIGxlZ2VuZCB0aXRsZSB0byAiSXJvbiBTdGF0dXMiLiAKPgo+IFtMaW5rIHRvIGV4ZXJjaXNlXShNb2R1bGUwOWFfYnJlYWtvdXQuaHRtbCkKCgo8ZGV0YWlscz4KPHN1bW1hcnk+UG9zc2libGUgc29sdXRpb25zIHRvIGV4ZXJjaXNlIHByb21wdHM8L3N1bW1hcnk+CgpIZXJlIGFyZSBleGFtcGxlcyBvZiBzb21lIHBvc3NpYmxlIGFwcHJvYWNoZXM6CgoqIEFkZCBhIHRpdGxlIGFuZCBzdWJ0aXRsZSB0byB0aGUgZ2dwbG90IHBsb3QKYGBge3IsIGV2YWw9IEZBTFNFfQojIGFkZCB0aXRsZSBhbmQgc3VidGl0bGUKUENBQ3VzdG9tMiArIAogIGxhYnModGl0bGUgPSAiSXJvbiBTdXBwbGVtZW50ZWQgTWljZSIsIHN1YnRpdGxlID0gIlBDQSBvZiB0b3AgNTAwIGdlbmVzIikKYGBgCgoKKiBBZGQgbGFiZWxzIHRvIHNob3cgd2hpY2ggc2FtcGxlcyBjb3JyZXNwb25kIHRvIHdoaWNoIHBvaW50cwoKYGBge3IsIGV2YWw9IEZBTFNFfQojIGRpc3BsYXkgd2l0aCBsYWJlbHMKUENBQ3VzdG9tMiArIAogIGdlb21fdGV4dF9yZXBlbChhZXMobGFiZWwgPSBuYW1lKSwgCiAgICAgICAgICAgICAgICAgIHBvaW50LnBhZGRpbmcgPSAwLjUsIAogICAgICAgICAgICAgICAgICBib3gucGFkZGluZyA9IDAuNSkKYGBgCgoKKiBNYWtlIG91ciBjb2xvciBwYWxldHRlIG1vcmUgY29sb3ItYmxpbmQgZnJpZW5kbHkKCmBgYHtyLCBldmFsPSBGQUxTRX0KIyBsb29rIGF0IHByZS1tYWRlIGNvbG9yIHBhbGV0dGVzIGZyb20gUkNvbG9yQnJld2VyCmRpc3BsYXkuYnJld2VyLmFsbChjb2xvcmJsaW5kRnJpZW5kbHkgPSBUUlVFKQojIHVzZSBSQ29sb3JCcmV3ZXIgcGFsZXR0ZQpQQ0FDdXN0b20yICsgCiAgc2NhbGVfY29sb3VyX2JyZXdlcihwYWxldHRlID0gIlNldDIiKQoKIyBPUiBjdXN0b21pemUgdXNpbmcgbWFudWFsIGNvbG9yIHBhbGV0dGUKIyBUaGUgUiBDb29rYm9vayBwYWxldHRlIHdpdGggZ3JleToKY2JQYWxldHRlIDwtIGMoIiM5OTk5OTkiLCAiI0U2OUYwMCIsICIjNTZCNEU5IiwgIiMwMDlFNzMiLCAiI0YwRTQ0MiIsICIjMDA3MkIyIiwgIiNENTVFMDAiLCAiI0NDNzlBNyIpCgojIFRvIHVzZSBmb3IgbGluZSBhbmQgcG9pbnQgY29sb3JzLCBhZGQgbWFudWFsIGNvbG9yIHNjYWxpbmcgd2l0aCBjdXN0b20gcGFsZXR0ZQpQQ0FDdXN0b20yICsgCiAgc2NhbGVfY29sb3VyX21hbnVhbCh2YWx1ZXM9Y2JQYWxldHRlWzI6M10pCmBgYAoKCiogVXNlIHNoYXBlIGluc3RlYWQgb2YgY29sb3IgdG8gaW5kaWNhdGUgZ3JvdXBzIG9uIHRoZSBQQ0EgcGxvdC4gCgpgYGB7ciwgZXZhbD0gRkFMU0V9CiMgZ2VuZXJhdGUgbmV3IGFlc3RoZXRpYyBtYXBwaW5nICh3aXRoIGRlZmF1bHQgc2hhcGVzIHNlbGVjdGVkKQpnZ3Bsb3QocGNhRGF0YSwgYWVzKFBDMSwgUEMyLCBzaGFwZT1jb25kaXRpb24pKSArCiAgZ2VvbV9wb2ludChzaXplPTMpICsKICBjb29yZF9maXhlZCgpICsKICB0aGVtZV9idygpICsgCiAgeGxhYihwYXN0ZTAoIlBDMTogIixwZXJjZW50VmFyWzFdLCIlIHZhcmlhbmNlIikpICsKICB5bGFiKHBhc3RlMCgiUEMyOiAiLHBlcmNlbnRWYXJbMl0sIiUgdmFyaWFuY2UiKSkKCiMgZ2VuZXJhdGUgbmV3IGFlc3RoZXRpYyBtYXBwaW5nICh3aXRoIG1hbnVhbGx5IHNlbGVjdGVkIHNoYXBlcykKZ2dwbG90KHBjYURhdGEsIGFlcyhQQzEsIFBDMiwgc2hhcGU9Y29uZGl0aW9uKSkgKwogIGdlb21fcG9pbnQoc2l6ZT0zKSArCiAgc2NhbGVfc2hhcGVfbWFudWFsKHZhbHVlcyA9IGMoMSwgNCkpICsKICBjb29yZF9maXhlZCgpICsKICB0aGVtZV9idygpICsgCiAgeGxhYihwYXN0ZTAoIlBDMTogIixwZXJjZW50VmFyWzFdLCIlIHZhcmlhbmNlIikpICsKICB5bGFiKHBhc3RlMCgiUEMyOiAiLHBlcmNlbnRWYXJbMl0sIiUgdmFyaWFuY2UiKSkKYGBgCgoKKiBfQ2hhbGxlbmdlXzogQ2hhbmdlIHRoZSBsZWdlbmQgdGl0bGUgdG8gIklyb24gU3RhdHVzIgoKYGBge3IsIGV2YWw9IEZBTFNFfQojICBjdXN0b21pemUgbGFiZWwgZm9yIGNvbG91ciBtYXBwaW5nClBDQUN1c3RvbTIgKyAKICBndWlkZXMoY29sb3VyPWd1aWRlX2xlZ2VuZCh0aXRsZT0iSXJvbiBzdXBwbGVtZW50YXRpb24gc3RhdHVzIikpIAoKIyBhbHRlcm5hdGl2ZWx5IHNwZWNpZnkgbGFiZWwgZm9yIGFlc3RoZXRpYyBtYXBwaW5nClBDQUN1c3RvbTIgKyAKICBsYWJzKGNvbG91cj0iSXJvbiBzdXBwbGVtZW50YXRpb24gc3RhdHVzIikKYGBgCgo8L2RldGFpbHM+Cjxicj4KCgotLS0tCgoKIyBEb3dubG9hZCBwbG90cwoKUnN0dWRpbyBzZXJ2ZXIgYWxsb3dzIHVzIHRvIGRvd25sb2FkIGZpbGVzIHRocm91Z2ggdGhlIGludGVyYWN0aXZlIGZpbGUgcGFuZWwgb24gdGhlIHJpZ2h0IHNpZGUuIElmIHdlIG5hdmlnYXRlIGludG8gdGhlIHBsb3Qgc3ViZm9sZGVyIGFuZCBzZWxlY3QgdGhlIGBQQ0FwbG90X3Jsb2dfY29uZGl0aW9uLnBkZmAgb3IgdGhlICBmaWxlLCB3ZSBjYW4gdGhlbiBjbGljayB0aGUgYmx1ZSBnZWFyIHN5bWJvbCBsYWJlbGVkIGBNb3JlYCBhbmQgc2VsZWN0IGBFeHBvcnQuLi5gLiBXZSBzaG91bGQgc2VlIGEgcHJvbXB0IHJlZ2FyZGluZyB0aGUgbmFtZSBvZiB0aGUgZmlsZSBhbmQgaWYgd2UgY2xpY2sgYERvd25sb2FkYCB0aGUgZmlsZSBzaG91bGQgc2hvdyB1cCBpbiB5b3VyIGxvY2FsICJEb3dubG9hZHMiIGZvbGRlci4KCiMgT3B0aW9uYWwgY29udGVudAoKPGRldGFpbHM+CiAgICA8c3VtbWFyeT4qQ2xpY2sgZm9yIGV4YW1wbGUgY29kZSBmb3IgZ2VuZXJhdGluZyBhIFNjcmVlUGxvdCB2aXN1YWxpemF0aW9uIG9mIHZhcmlhbmNlIGFjcm9zcyBhbGwgcHJpbmNpcGxlIGNvbXBvbmVudHMqPC9zdW1tYXJ5PgogICAgIEEgc2NyZWVwbG90IGlzIGEgd2F5IHRvIHZpc3VhbGl6ZSB0aGUgdmFyaWFuY2UgZXhwbGFpbmVkIGJ5IGFsbCBwcmluY2lwYWwgY29tcG9uZW50cy4KICAgICBUbyBnZW5lcmF0ZSBhIHNjcmVlIHBsb3QsIHRoZSBQQ0EgcmVzdWx0cyBuZWVkIHRvIGJlIHVzZWQgaW5kZXBlbmRlbnRseSBvZiBwbG90dGluZywgc3VjaCBhcyBkZXNjcmliZWQgYnkgW3RoaXMgc3RhdHF1ZXN0IHBvc3RdKGh0dHBzOi8vc3RhdHF1ZXN0Lm9yZy9wY2EtY2xlYXJseS1leHBsYWluZWQvKSBhbmQgcmVwbGljYXRlZCBiZWxvdy4KCmBgYHtyIFNjcmVlUGxvdH0KIyBnZW5lcmF0ZSBQQ0EgbG9hZGluZ3MKcGNhTG9hZGluZ3MgPSBwcmNvbXAodChhc3NheShybGQpKSwgc2NhbGUuID0gVFJVRSkKCiMjIGdldCB0aGUgc2NyZWUgaW5mb3JtYXRpb24KcGNhLnZhciA9IHBjYUxvYWRpbmdzJHNkZXZeMgpzY3JlZSA9IHBjYS52YXIvc3VtKHBjYS52YXIpCmJhcnBsb3QoKHNjcmVlWzE6MTBdKjEwMCksIG1haW49IlNjcmVlIFBsb3QiLCB4bGFiPSJQcmluY2lwYWwgQ29tcG9uZW50IiwgeWxhYj0iUGVyY2VudCBWYXJpYXRpb24iKQpgYGAKCiAgICBXZSBjYW4gc2VlIHRoYXQgdGhlIG1ham9yaXR5ICh+NjUlKSBvZiB0aGUgdmFyaWFuY2UgYWNyb3NzIG91ciBzYW1wbGVzIGlzIGV4cGxhaW5lZCBieSB0aGUgZmlyc3QgdGhyZWUgcHJpbmNpcGFsIGNvbXBvbmVudHMsIGdpdmluZyB1cyBzb21lIGFkZGl0aW9uYWwgY29uZmlkZW5jZSByZWdhcmRpbmcgdGhlIHF1YWxpdHkgb2Ygb3VyIGRhdGEuCiAgICBJbiB0aGVzZSBzY3JlZSBwbG90IGV4YW1wbGVzIGZyb20gQmlvVHVyaW5nLCB0aGUgcGxvdCBvbiB0aGUgbGVmdCBmaXRzIHdoYXQgd2Ugd291bGQgZXhwZWN0IGZvciBhIGRhdGFzZXQgd2l0aCBoaWdoIHNpZ25hbCBmcm9tIHRoZSBleHBlcmltZW50YWwgdHJlYXRtZW50LCB3aGVyZSB0aGUgbWFqb3JpdHkgb2YgdGhlIHZhcmlhbmNlIGlzIGV4cGxhaW5lZCBieSB0aGUgZmlyc3QgZmV3IHByaW5jaXBhbCBjb21wb25lbnRzLiBUaGUgcGxvdCBvbiB0aGUgcmlnaHQgaWxsdXN0cmF0ZXMgYSBzY2VuYXJpbyB3aGVyZSB0aGUgdmFyaWFuY2UgaXMgZGlzdHJpYnV0ZWQgYWNyb3NzIG1hbnkgY29tcG9uZW50cywgd2hpY2ggY291bGQgYmUgZHVlIHRvIGxvdyBzaWduYWwgZnJvbSB0aGUgZXhwZXJpbWVudGFsIHRyZWF0bWVudCwgY29tcGxleCBleHBlcmltZW50YWwgZGVzaWduLCBvciBjb25mb3VuZGluZyBmYWN0b3JzLgppbWFnZTogIVtdKC4vaW1hZ2VzL3Byb3BvcnRpb24tb2YtdmFyaWFuY2UtYmxvZy1ob3J6LmpwZykKPC9kZXRhaWxzPgo8YnI+CgojIFN1bW1hcnkKCkluIHRoaXMgc2VjdGlvbiwgd2U6CgoqIERpc2N1c3NlZCB2YXJpYW5jZSB3aXRoaW4gdHJlYXRtZW50IGdyb3VwcwoqIERpc2N1c3NlZCB0ZWNobmljYWwgYXJ0aWZhY3RzLCBpbmNsdWRpbmcgYmF0Y2hlcwoqIExlYXJuZWQgdG8gZ2VuZXJhdGUgUENBIHBsb3RzCgotLS0KCiMgU291cmNlcwoKKiBIQkMgUUMgdHV0b3JpYWw6IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzAzX0RHRV9RQ19hbmFseXNpcy5odG1sCiogRGV0YWlsZWQgSGVhdG1hcCB0dXRvcmlhbCBmcm9tIEdhbGF4eTogaHR0cHM6Ly90cmFpbmluZy5nYWxheHlwcm9qZWN0Lm9yZy90cmFpbmluZy1tYXRlcmlhbC90b3BpY3MvdHJhbnNjcmlwdG9taWNzL3R1dG9yaWFscy9ybmEtc2VxLXZpei13aXRoLWhlYXRtYXAyL3R1dG9yaWFsLmh0bWwKKiBQQ0EgT3ZlcnZpZXc6IGh0dHBzOi8vYmxvZy5iaW90dXJpbmcuY29tLzIwMTgvMDYvMTQvcHJpbmNpcGFsLWNvbXBvbmVudC1hbmFseXNpcy1leHBsYWluZWQtc2ltcGx5LwoKYGBge3IgV3JpdGVPdXQuUkRhdGEsIGV2YWw9RkFMU0UsIGVjaG89RkFMU0UsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CiNIaWRkZW4gY29kZSBibG9jayB0byB3cml0ZSBvdXQgZGF0YSBmb3Iga25pdHRpbmcKIyBzYXZlLmltYWdlKGZpbGUgPSAicmRhdGEvUnVubmluZ0RhdGEuUkRhdGEiKQpgYGAKCi0tLQoKClRoZXNlIG1hdGVyaWFscyBoYXZlIGJlZW4gYWRhcHRlZCBhbmQgZXh0ZW5kZWQgZnJvbSBtYXRlcmlhbHMgbGlzdGVkIGFib3ZlLiBUaGVzZSBhcmUgb3BlbiBhY2Nlc3MgbWF0ZXJpYWxzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgW0NyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24gbGljZW5zZSAoQ0MgQlkgNC4wKV0oaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvNC4wLyksIHdoaWNoIHBlcm1pdHMgdW5yZXN0cmljdGVkIHVzZSwgZGlzdHJpYnV0aW9uLCBhbmQgcmVwcm9kdWN0aW9uIGluIGFueSBtZWRpdW0sIHByb3ZpZGVkIHRoZSBvcmlnaW5hbCBhdXRob3IgYW5kIHNvdXJjZSBhcmUgY3JlZGl0ZWQuCgo8YnIvPgo8YnIvPgo8aHIvPgp8IFtQcmV2aW91cyBsZXNzb25dKE1vZHVsZTA4X0RFU2VxMkRFLmh0bWwpIHwgW1RvcCBvZiB0aGlzIGxlc3Nvbl0oI3RvcCkgfCBbTmV4dCBsZXNzb25dKE1vZHVsZTEwX0RFQ29tcGFyaXNvbnMuaHRtbCkgfAp8IDotLS0gfCA6LS0tLTogfCAtLS06IHw=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module09_SampleQCViz.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
