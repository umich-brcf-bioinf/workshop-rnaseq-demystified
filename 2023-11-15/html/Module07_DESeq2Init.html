<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2023-09-29" />

<title>DE Initialization</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_Sequence_QC.html">Sequence QC</a>
    </li>
    <li>
      <a href="Module02b_Trimming.html">Trimming</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03a_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module03b_Alignment.html">Alignment</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module04_Alignment_QC_and_Quantification.html">Alignment QC and Quantification</a>
    </li>
    <li>
      <a href="Module05_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">DE Introduction</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DE Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">DE Normalization and Modeling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">DE Testing</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visualization</a>
    </li>
    <li>
      <a href="Module12_DEAnnotations.html">DE Annotation</a>
    </li>
    <li>
      <a href="R_bonus_content.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">DE Initialization</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2023-09-29</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<p>In this module, we will learn:</p>
<ul>
<li>How to ‘unblind’ our samples</li>
<li>How to identify possible “confounding” factors</li>
<li>How batches or additional covariates may impact your data</li>
<li>How to ensure high quality count data with filtering</li>
</ul>
<p><br></p>
<div id="differential-expression-workflow"
class="section level1 unlisted unnumbered">
<h1 class="unlisted unnumbered">Differential Expression Workflow</h1>
<p>Here we will setup the inputs needed to initialize DESeq2 before
testing for differential expression.</p>
<p><img src="images/wayfinder/wayfinder-DESeq2Init.png"
style="width:75.0%" /></p>
<hr />
</div>
<div id="sample-information" class="section level1">
<h1>Sample Information</h1>
<p>As introduced at the beginning of the workshop, we have downloaded
and prepared data from an existing publication <a
href="https://elifesciences.org/articles/46976">(Zhang et al.,
2019)</a>, wherein one goal is to understand the gene expression
differences in wild-type mice that that were “iron replete” and fed a
control diet (we label these “control”) and “iron deficient” (we label
these “deficient”).</p>
<p><img src="images/Module00_top_down.jpg" /></p>
<div id="read-sample-table" class="section level2">
<h2>Read Sample Table</h2>
<p>Our next step will be to describe the samples within our R session,
so that we make the proper comparisons with DESeq2. Let’s check the
sample names from the count table.</p>
<pre class="r"><code>colnames(count_table)</code></pre>
<pre><code>[1] &quot;sample_A&quot; &quot;sample_B&quot; &quot;sample_C&quot; &quot;sample_D&quot; &quot;sample_E&quot; &quot;sample_F&quot;</code></pre>
<p>Based on the sample names that are the columns of
<code>count_table</code>, our samples are blinded, e.g. the sample names
don’t clearly correspond to treatment groups. We will need to specify
which sample IDs connect to which experimental conditions.</p>
<p>Typically sample phenotype data, including experimental conditions,
are stored as Excel or CSV files that we can read into R, and then use
when creating a DESeq2 object. If you are unfamilar with CSV files or
how to generate them, there are <a
href="https://www.wikihow.com/Create-a-CSV-File">tutorials</a> available
to guide you through the process.</p>
<blockquote>
<h1 id="tip-sample-naming-conventions" class="unlisted unnumbered">Tip:
Sample naming conventions</h1>
<p>Use only alpha-numeric characters (A-Z, a-z, 0-9), and separate parts
of the name with underscores (<code>_</code>) or dots (<code>.</code>).
Do not begin sample names with numbers.</p>
</blockquote>
<p>We’ll load our ‘pre-made’ sample information sheet,
<code>samplesheet.csv</code>, to unblind our samples.</p>
<pre class="r"><code>samplesheet = read.table(&quot;data/samplesheet.csv&quot;,
                       sep = &quot;,&quot;,
                       header = TRUE,
                       row.names = 1)</code></pre>
<p>Alternatively, we can manually create a sample sheet.</p>
<p>We can look at the object by typing its name and hitting Enter. Note,
for larger experiments, you may want to use <code>head()</code>.</p>
<pre class="r"><code>samplesheet</code></pre>
<pre><code>         genotype condition
sample_A       wt   control
sample_B       wt   control
sample_C       wt   control
sample_D       wt deficient
sample_E       wt deficient
sample_F       wt deficient</code></pre>
<p><strong>Checkpoint</strong>: <em>If you have loaded
<code>samplesheet</code>, please indicate with the green ‘check’ button.
Otherwise, please use the red ‘x’ button to have the command
repeated</em></p>
<p>In this example data, all mice are wild-type and the control diet
mice are labeled as “control” and the iron deficient diet fed mice are
labeled as “deficient”. Again, for larger experiments, you may want to
examine the coding of the samples by looking at the
<code>unique()</code> values of the relevant columns.</p>
<pre class="r"><code>unique(samplesheet$condition)</code></pre>
<pre><code>[1] &quot;control&quot;   &quot;deficient&quot;</code></pre>
<div id="replicates-and-sequencing-depth-in-rna-seq-experiments"
class="section level3">
<h3>Replicates and sequencing depth in RNA-seq experiments</h3>
<blockquote>
<p><strong>Question</strong> In this experiment, we only have samples
from three mice per each condition. Do we have enough replicates?</p>
</blockquote>
<p>The goal of our analysis is to separate the “interesting” biological
contributions from the “uninteresting” technical or other contributions
that either cannot be or were not controlled in the experimental design.
The more sources of variation, such as samples coming from heterogenous
tissues or experiments with incomplete knockdowns, the more replicates
(&gt;3) are recommended.</p>
<div class="float">
<img src="images/de_variation.png" style="width:75.0%"
alt="Image of technical, biological, and experimental contributors to gene expression, from HBC training materials" />
<div class="figcaption">Image of technical, biological, and experimental
contributors to gene expression, from HBC training materials</div>
</div>
<p>For a more in depth discussion of experimental design considerations,
particularly for the number of replicates, please read <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096346/">A
Beginner’s Guide to Analysis of RNA Sequencing Data</a> or papers like
this one by <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3842884/">Hart et
al</a> that focus on estimating statistical power for RNA-seq
experiments.</p>
</div>
<div id="sample-table-formatting" class="section level3">
<h3>Sample table formatting</h3>
<p>Next, we’ll format our table so that we have the appropriate data
type (an ordered <a
href="https://swcarpentry.github.io/r-novice-inflammation/12-supp-factors/">factor</a>)
for DESeq2 to recognize our treatment groups and appropriately compare
samples.</p>
<pre class="r"><code># tidy version
samplesheet_ready &lt;- samplesheet %&gt;% mutate(condition = factor(condition, 
                                          levels = c(&#39;control&#39;, &#39;deficient&#39;)))

# base version
samplesheet_ready &lt;- samplesheet
samplesheet_ready$condition = factor(samplesheet_ready$condition,
                            levels = c(&#39;control&#39;, &#39;deficient&#39;))

unique(samplesheet_ready$condition)</code></pre>
<pre><code>[1] control   deficient
Levels: control deficient</code></pre>
<p>Notice that we set the levels in a particular order. This is
important for setting the “Control” (or “Reference”) group as the
denominator in the default comparisons when we setup our DESeq2
model.</p>
<p>Before we proceed, we need to make sure that the sample labels
(column names) in the count table match the sample information table
(row names), including the order. If the sample labels don’t match, then
we will see an error and need to correct the labels prior to proceeding.
Checking the sample information table is extremely important to ensure
that the correct samples are grouped together for comparisons.</p>
<pre class="r"><code>all(colnames(count_table) == rownames(samplesheet_ready))</code></pre>
<pre><code>[1] TRUE</code></pre>
<p>This line of code checks if both the identity and order match between
our <code>count_table</code> and our <code>samplesheet</code>. If, in
the course of using your own data, this returns <code>FALSE</code>, try
using the <code>match()</code> function to rearrange the columns of
<code>count_table</code> (or the rows of <code>samplesheet</code>) to
get them to match.</p>
<p><strong>Checkpoint</strong>: <em>If you your sample info check
returns <code>TRUE</code>, please indicate with the green ‘yes’ button.
Otherwise, please use the red ‘x’ button to have the command
repeated</em></p>
</div>
</div>
</div>
<div id="creating-deseq2-object" class="section level1">
<h1>Creating DESeq2 object</h1>
<p>Bioconductor software packages often define and use custom structures
to store data in a way that suits biological data, such as illustrated
below from <a href="https://www.nature.com/articles/nmeth.3252">Huber et
al. 2015</a>.</p>
<div class="float">
<img src="images/SummarizedExperiment.jpg"
alt="A breakdown of the SummarizedExperiment class." />
<div class="figcaption">A breakdown of the SummarizedExperiment
class.</div>
</div>
<p>These custom data structures have pre-defined data slots, which hold
specific types/classes of data and therefore can be more easily accessed
by functions from the same package.</p>
<p>To create the DESeqDataSet we need two important inputs:</p>
<ol style="list-style-type: decimal">
<li>A table that assigns the condition labels for each sample (that we
read in and formatted)</li>
<li>A <em>raw</em> count matrix</li>
</ol>
<p>Is our count matrix from our RSEM outputs considered a “raw” count
matrix by DESeq2?</p>
<blockquote>
<h1 id="exercise-rsem-outputs-versus-deseq2-input-requirements"
class="unlisted unnumbered">Exercise: RSEM outputs versus DESeq2 input
requirements</h1>
<p>If we think back to the RSEM outputs, the ‘expected_counts’ table may
include fractional amounts due to how the alignment tool resolves reads
mapping to multiple locuses). DESeq2 is expecting the count matrix to
consist only of whole numbers. Recent versions of DESeq2 will handle
this for us, but previous versions did not.</p>
<p>What R function, that we saw in Computational Foundations, could we
use to convert the fractional values in <code>count_table</code> to
integers?</p>
</blockquote>
<details>
<summary>
Solution
</summary>
<p>We can use the <code>round()</code> function:</p>
<pre class="r"><code>counts_rounded = round(count_table)</code></pre>
</details>
<p><br></p>
<p>To create the <code>DESeqDataSet</code> we will need the
<code>count_table</code> and the <code>samplesheet</code>. We will also
need a <strong>design formula</strong> to specify our model.</p>
<div id="making-model-choices" class="section level2">
<h2>Making model choices</h2>
<p>The design formula specified informs many of the DESeq2 functions how
to treat the samples in the analysis, specifically which column(s) in
the sample metadata table are relevant to the experimental design.</p>
<p>In this case, we aren’t aware of any <a
href="https://methods-sagepub-com.proxy.lib.umich.edu/reference/encyc-of-research-design/n85.xml">covariates</a>
that should be considered in our comparisons. However, if there are
additional attributes of the samples that may impact the DE comparisons,
like date of collection, sex, or patient of origin, these should be
added as <a href="https://support.bioconductor.org/p/75309/">additional
columns</a> in the sample information table and <a
href="https://support.bioconductor.org/p/98700/">added to a design
formula</a>.</p>
<p>More complex questions, including adding “interaction terms” between
multiple group labels are helpfully described in <a
href="https://support.bioconductor.org/p/98628/">this support thread</a>
as well as in the <a
href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#interactions">DESeq2
vignette</a>, which is an excellent document.</p>
<p>The design formula specifies the column(s) in the metadata table and
how they should be used in the analysis. For our dataset we only have
one column we are interested in, that is <code>condition</code>. This
column has two factor levels, which tells DESeq2 that for each gene we
want to evaluate gene expression change with respect to these different
levels.</p>
<pre class="r"><code>## Create DESeq object, line by line
dds = DESeqDataSetFromMatrix(countData = counts_rounded,
                              colData = samplesheet_ready,
                              design = ~ condition)</code></pre>
<pre><code>converting counts to integer mode</code></pre>
<pre class="r"><code>dds</code></pre>
<pre><code>class: DESeqDataSet 
dim: 55492 6 
metadata(1): version
assays(1): counts
rownames(55492): ENSMUSG00000000001 ENSMUSG00000000003 ... mcherry tdtomato
rowData names(0):
colnames(6): sample_A sample_B ... sample_E sample_F
colData names(2): genotype condition</code></pre>
<p>Notice that printing the <code>dds</code> object helpfully shows us
some helpful information:</p>
<ul>
<li>The dimension (number of genes by number of samples),</li>
<li>The gene identifiers,</li>
<li>The sample identifiers,</li>
<li>The additional column names giving information about the
samples</li>
</ul>
<p><strong>Checkpoint</strong>: <em>If you see <code>dds</code> in your
environment panel, please indicate with the green ‘check’ button.
Otherwise, please use use the red ‘x’ button in your zoom reaction panel
to have this step repeated. You can use the red ‘x’ to be put in a
breakout room for help</em></p>
<hr />
</div>
</div>
<div id="pre-filtering" class="section level1">
<h1>Pre-filtering</h1>
<p>While not necessary, <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#pre-filtering">pre-filtering</a>
the count table helps to not only reduce the size of the DESeq2 object,
but also gives you a sense of how many genes were reasonably measured at
the sequencing depth generated for your samples.</p>
<p>Here we will filter out any genes that have less than 10 counts
across any of the samples. This is a fairly standard level of filtering,
but can filter data less/more depending on quality control metrics from
alignments and sequencing depth or total number of samples.</p>
<pre class="r"><code>keep = rowSums(counts(dds)) &gt;= 10
dds_filtered = dds[keep,]
dds_filtered</code></pre>
<pre><code>class: DESeqDataSet 
dim: 16249 6 
metadata(1): version
assays(1): counts
rownames(16249): ENSMUSG00000000001 ENSMUSG00000000028 ... ENSMUSG00000118651 ENSMUSG00000118653
rowData names(0):
colnames(6): sample_A sample_B ... sample_E sample_F
colData names(2): genotype condition</code></pre>
<p>Notice the <code>dds_filtered</code> object has less elements than
the unfiltered <code>dds</code> object, indicating that a number of
genes were not measured in our experiment.</p>
<p><strong>Checkpoint</strong>: <em>Questions?</em></p>
</div>
<div id="optional-content" class="section level1">
<h1>Optional content</h1>
<details>
<summary>
<em>Click for how to model batch effects with DESeq2</em>
</summary>
<p>Differences between samples can also be due to technical reasons,
such as collection on different days or different sequencing runs.
Differences between samples that are not due to biological factors as
called <strong>batch effects</strong>. We can include batch effects in
our design model in the same way as covariates, as long as the technical
groups do not overlap, or <strong>confound</strong>, the biological
treatment groups.</p>
<p>Let’s try add some additional meta-data information where we have
counfounding batch effects and create another DESeq2 object.</p>
<pre class="r"><code>samplesheet_batch = samplesheet_ready
samplesheet_batch$batch = factor(c(rep(c(&quot;Day1&quot;, &quot;Day2&quot;, &quot;Day3&quot;), 2)), 
                                 levels = c(&quot;Day1&quot;, &quot;Day2&quot;, &quot;Day3&quot;))

dds_batch = DESeqDataSetFromMatrix(countData = counts_rounded,
                      colData = samplesheet_batch,
                      design = ~ batch + condition)</code></pre>
<pre><code>converting counts to integer mode</code></pre>
</details>
<p><br></p>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Loaded the necessary input files into our R session</li>
<li>Discussed model design for DESeq2</li>
<li>Initialized a DESeq2 data set</li>
<li>Filtered our count data</li>
</ul>
<p>Now that we’ve created our DESeq2 objects, including specifying what
model is appropriate for our data, and filtered our data, we can proceed
with assessing the impact of the experimental conditions on gene
expression for our samples.</p>
<hr />
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<p>Training resources used to develop materials:</p>
<ul>
<li>HBC DGE setup: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/01_DGE_setup_and_overview.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/01_DGE_setup_and_overview.html</a></li>
<li>HBC Count Normalization: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html</a></li>
<li>DESeq2 standard vignette: <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html"
class="uri">http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html</a></li>
<li>DESeq2 beginners vignette: <a
href="https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf"
class="uri">https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf</a></li>
<li>Bioconductor RNA-seq Workflows: <a
href="https://www.bioconductor.org/help/course-materials/2015/LearnBioconductorFeb2015/B02.1_RNASeq.html"
class="uri">https://www.bioconductor.org/help/course-materials/2015/LearnBioconductorFeb2015/B02.1_RNASeq.html</a></li>
<li>CCDL Gastric cancer training materials: <a
href="https://alexslemonade.github.io/training-modules/RNA-seq/03-gastric_cancer_exploratory.nb.html"
class="uri">https://alexslemonade.github.io/training-modules/RNA-seq/03-gastric_cancer_exploratory.nb.html</a></li>
<li>CCDL Neuroblastoma training materials: <a
href="https://alexslemonade.github.io/training-modules/RNA-seq/05-nb_cell_line_DESeq2.nb.html"
class="uri">https://alexslemonade.github.io/training-modules/RNA-seq/05-nb_cell_line_DESeq2.nb.html</a></li>
</ul>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
<br/> <br/>
<hr/>
<table style="width:100%;">
<colgroup>
<col width="28%" />
<col width="42%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><a href="Module06_DEAnalysisSetup.html">Previous
lesson</a></th>
<th align="center"><a href="#top">Top of this lesson</a></th>
<th align="right"><a href="Module08_DESeq2DE.html">Next lesson</a></th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiREUgSW5pdGlhbGl6YXRpb24iCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIGluY2x1ZGVzOgogICAgICAgICAgICAgICAgaW5faGVhZGVyOiBoZWFkZXIuaHRtbAogICAgICAgICAgICB0aGVtZTogcGFwZXIKICAgICAgICAgICAgdG9jOiB0cnVlCiAgICAgICAgICAgIHRvY19kZXB0aDogNAogICAgICAgICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgICAgICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMThweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxMnB4Cn0KPC9zdHlsZT4KCmBgYHtyLCBpbmNsdWRlID0gRkFMU0V9CnNvdXJjZSgiLi4vYmluL2NodW5rLW9wdGlvbnMuUiIpCmtuaXRyX2ZpZ19wYXRoKCIwNy0iKQpgYGAKCmBgYHtyIExvYWRSdW5uaW5nRGF0YSwgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQpsaWJyYXJ5KERFU2VxMikKIyBsb2FkKCJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKSW4gdGhpcyBtb2R1bGUsIHdlIHdpbGwgbGVhcm46CgoqIEhvdyB0byAndW5ibGluZCcgb3VyIHNhbXBsZXMKKiBIb3cgdG8gaWRlbnRpZnkgcG9zc2libGUgImNvbmZvdW5kaW5nIiBmYWN0b3JzCiogSG93IGJhdGNoZXMgb3IgYWRkaXRpb25hbCBjb3ZhcmlhdGVzIG1heSBpbXBhY3QgeW91ciBkYXRhCiogSG93IHRvIGVuc3VyZSBoaWdoIHF1YWxpdHkgY291bnQgZGF0YSB3aXRoIGZpbHRlcmluZwoKPGJyPgoKIyBEaWZmZXJlbnRpYWwgRXhwcmVzc2lvbiBXb3JrZmxvdyB7LnVubGlzdGVkIC51bm51bWJlcmVkfQoKSGVyZSB3ZSB3aWxsIHNldHVwIHRoZSBpbnB1dHMgbmVlZGVkIHRvIGluaXRpYWxpemUgREVTZXEyIGJlZm9yZSB0ZXN0aW5nIGZvciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbi4KCiFbXSguL2ltYWdlcy93YXlmaW5kZXIvd2F5ZmluZGVyLURFU2VxMkluaXQucG5nKXt3aWR0aD03NSV9CgotLS0KCiMgU2FtcGxlIEluZm9ybWF0aW9uCgpBcyBpbnRyb2R1Y2VkIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHdvcmtzaG9wLCB3ZSBoYXZlIGRvd25sb2FkZWQgYW5kIHByZXBhcmVkIGRhdGEgZnJvbSBhbiBleGlzdGluZyBwdWJsaWNhdGlvbiBbKFpoYW5nIGV0IGFsLiwgMjAxOSldKGh0dHBzOi8vZWxpZmVzY2llbmNlcy5vcmcvYXJ0aWNsZXMvNDY5NzYpLCB3aGVyZWluIG9uZSBnb2FsIGlzIHRvIHVuZGVyc3RhbmQgdGhlIGdlbmUgZXhwcmVzc2lvbiBkaWZmZXJlbmNlcyBpbiB3aWxkLXR5cGUgbWljZSB0aGF0IHRoYXQgd2VyZSAiaXJvbiByZXBsZXRlIiBhbmQgZmVkIGEgY29udHJvbCBkaWV0ICh3ZSBsYWJlbCB0aGVzZSAiY29udHJvbCIpIGFuZCAiaXJvbiBkZWZpY2llbnQiICh3ZSBsYWJlbCB0aGVzZSAiZGVmaWNpZW50IikuCgohW10oaW1hZ2VzL01vZHVsZTAwX3RvcF9kb3duLmpwZykKCiMjIFJlYWQgU2FtcGxlIFRhYmxlCgpPdXIgbmV4dCBzdGVwIHdpbGwgYmUgdG8gZGVzY3JpYmUgdGhlIHNhbXBsZXMgd2l0aGluIG91ciBSIHNlc3Npb24sIHNvIHRoYXQgd2UgbWFrZSB0aGUgcHJvcGVyIGNvbXBhcmlzb25zIHdpdGggREVTZXEyLiBMZXQncyBjaGVjayB0aGUgc2FtcGxlIG5hbWVzIGZyb20gdGhlIGNvdW50IHRhYmxlLgoKYGBge3IgQ29sdW1uTmFtZXN9CmNvbG5hbWVzKGNvdW50X3RhYmxlKQpgYGAKCkJhc2VkIG9uIHRoZSBzYW1wbGUgbmFtZXMgdGhhdCBhcmUgdGhlIGNvbHVtbnMgb2YgYGNvdW50X3RhYmxlYCwgb3VyIHNhbXBsZXMgYXJlIGJsaW5kZWQsIGUuZy4gdGhlIHNhbXBsZSBuYW1lcyBkb24ndCBjbGVhcmx5IGNvcnJlc3BvbmQgdG8gdHJlYXRtZW50IGdyb3Vwcy4gV2Ugd2lsbCBuZWVkIHRvIHNwZWNpZnkgd2hpY2ggc2FtcGxlIElEcyBjb25uZWN0IHRvIHdoaWNoIGV4cGVyaW1lbnRhbCBjb25kaXRpb25zLgoKVHlwaWNhbGx5IHNhbXBsZSBwaGVub3R5cGUgZGF0YSwgaW5jbHVkaW5nIGV4cGVyaW1lbnRhbCBjb25kaXRpb25zLCBhcmUgc3RvcmVkIGFzIEV4Y2VsIG9yIENTViBmaWxlcyB0aGF0IHdlIGNhbiByZWFkIGludG8gUiwgYW5kIHRoZW4gdXNlIHdoZW4gY3JlYXRpbmcgYSBERVNlcTIgb2JqZWN0LiBJZiB5b3UgYXJlIHVuZmFtaWxhciB3aXRoIENTViBmaWxlcyBvciBob3cgdG8gZ2VuZXJhdGUgdGhlbSwgdGhlcmUgYXJlIFt0dXRvcmlhbHNdKGh0dHBzOi8vd3d3Lndpa2lob3cuY29tL0NyZWF0ZS1hLUNTVi1GaWxlKSBhdmFpbGFibGUgdG8gZ3VpZGUgeW91IHRocm91Z2ggdGhlIHByb2Nlc3MuCgo+ICMgVGlwOiBTYW1wbGUgbmFtaW5nIGNvbnZlbnRpb25zIHsudW5saXN0ZWQgLnVubnVtYmVyZWR9Cj4gVXNlIG9ubHkgYWxwaGEtbnVtZXJpYyBjaGFyYWN0ZXJzIChBLVosIGEteiwgMC05KSwgYW5kIHNlcGFyYXRlIHBhcnRzIG9mIHRoZSBuYW1lIHdpdGggdW5kZXJzY29yZXMgKGBfYCkgb3IgZG90cyAoYC5gKS4gRG8gbm90IGJlZ2luIHNhbXBsZSBuYW1lcyB3aXRoIG51bWJlcnMuCgpXZSdsbCBsb2FkIG91ciAncHJlLW1hZGUnIHNhbXBsZSBpbmZvcm1hdGlvbiBzaGVldCwgYHNhbXBsZXNoZWV0LmNzdmAsIHRvIHVuYmxpbmQgb3VyIHNhbXBsZXMuCgpgYGB7ciBTYW1wbGVzaGVldCwgZWNobyA9IEZBTFNFLCBldmFsID0gVFJVRX0Kc2FtcGxlc2hlZXQgPSByZWFkLnRhYmxlKCIuLi9kYXRhL1JfZGF0YS9zYW1wbGVzaGVldC5jc3YiLAogICAgICAgICAgICAgICAgICAgICAgIHNlcCA9ICIsIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgIHJvdy5uYW1lcyA9IDEpCmBgYAoKYGBge3IgU2FtcGxlc2hlZXQyLCBldmFsID0gRkFMU0V9CnNhbXBsZXNoZWV0ID0gcmVhZC50YWJsZSgiZGF0YS9zYW1wbGVzaGVldC5jc3YiLAogICAgICAgICAgICAgICAgICAgICAgIHNlcCA9ICIsIiwKICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICAgIHJvdy5uYW1lcyA9IDEpCmBgYAoKQWx0ZXJuYXRpdmVseSwgd2UgY2FuIG1hbnVhbGx5IGNyZWF0ZSBhIHNhbXBsZSBzaGVldC4KYGBge3IgU2FtcGxlc2hlZXQzLCBldmFsPUZBTFNFfQoKCmBgYAoKV2UgY2FuIGxvb2sgYXQgdGhlIG9iamVjdCBieSB0eXBpbmcgaXRzIG5hbWUgYW5kIGhpdHRpbmcgRW50ZXIuIE5vdGUsIGZvciBsYXJnZXIgZXhwZXJpbWVudHMsIHlvdSBtYXkgd2FudCB0byB1c2UgYGhlYWQoKWAuCgpgYGB7ciBTaG93U2FtcGxlc2hlZXR9CnNhbXBsZXNoZWV0CmBgYAoKKipDaGVja3BvaW50Kio6ICpJZiB5b3UgaGF2ZSBsb2FkZWQgYHNhbXBsZXNoZWV0YCwgcGxlYXNlIGluZGljYXRlIHdpdGggdGhlIGdyZWVuICdjaGVjaycgYnV0dG9uLiBPdGhlcndpc2UsIHBsZWFzZSB1c2UgdGhlIHJlZCAneCcgYnV0dG9uIHRvIGhhdmUgdGhlIGNvbW1hbmQgcmVwZWF0ZWQqCgoKSW4gdGhpcyBleGFtcGxlIGRhdGEsIGFsbCBtaWNlIGFyZSB3aWxkLXR5cGUgYW5kIHRoZSBjb250cm9sIGRpZXQgbWljZSBhcmUgbGFiZWxlZCBhcyAiY29udHJvbCIgYW5kIHRoZSBpcm9uIGRlZmljaWVudCBkaWV0IGZlZCBtaWNlIGFyZSBsYWJlbGVkIGFzICJkZWZpY2llbnQiLiBBZ2FpbiwgZm9yIGxhcmdlciBleHBlcmltZW50cywgeW91IG1heSB3YW50IHRvIGV4YW1pbmUgdGhlIGNvZGluZyBvZiB0aGUgc2FtcGxlcyBieSBsb29raW5nIGF0IHRoZSBgdW5pcXVlKClgIHZhbHVlcyBvZiB0aGUgcmVsZXZhbnQgY29sdW1ucy4KCmBgYHtyIFRyZWF0bWVudEdyb3VwVGFibGV9CnVuaXF1ZShzYW1wbGVzaGVldCRjb25kaXRpb24pCmBgYAoKCiMjIyBSZXBsaWNhdGVzIGFuZCBzZXF1ZW5jaW5nIGRlcHRoIGluIFJOQS1zZXEgZXhwZXJpbWVudHMKCj4gKipRdWVzdGlvbioqIEluIHRoaXMgZXhwZXJpbWVudCwgd2Ugb25seSBoYXZlIHNhbXBsZXMgZnJvbSB0aHJlZSBtaWNlIHBlciBlYWNoIGNvbmRpdGlvbi4gRG8gd2UgaGF2ZSBlbm91Z2ggcmVwbGljYXRlcz8KClRoZSBnb2FsIG9mIG91ciBhbmFseXNpcyBpcyB0byBzZXBhcmF0ZSB0aGUg4oCcaW50ZXJlc3RpbmfigJ0gYmlvbG9naWNhbCBjb250cmlidXRpb25zIGZyb20gdGhlIOKAnHVuaW50ZXJlc3RpbmfigJ0gdGVjaG5pY2FsIG9yIG90aGVyIGNvbnRyaWJ1dGlvbnMgdGhhdCBlaXRoZXIgY2Fubm90IGJlIG9yIHdlcmUgbm90IGNvbnRyb2xsZWQgaW4gdGhlIGV4cGVyaW1lbnRhbCBkZXNpZ24uIFRoZSBtb3JlIHNvdXJjZXMgb2YgdmFyaWF0aW9uLCBzdWNoIGFzIHNhbXBsZXMgY29taW5nIGZyb20gaGV0ZXJvZ2Vub3VzIHRpc3N1ZXMgb3IgZXhwZXJpbWVudHMgd2l0aCBpbmNvbXBsZXRlIGtub2NrZG93bnMsIHRoZSBtb3JlIHJlcGxpY2F0ZXMgKD4zKSBhcmUgcmVjb21tZW5kZWQuCgohW0ltYWdlIG9mIHRlY2huaWNhbCwgYmlvbG9naWNhbCwgYW5kIGV4cGVyaW1lbnRhbCBjb250cmlidXRvcnMgdG8gZ2VuZSBleHByZXNzaW9uLCBmcm9tIEhCQyB0cmFpbmluZyBtYXRlcmlhbHNdKGltYWdlcy9kZV92YXJpYXRpb24ucG5nKXt3aWR0aD03NSV9CgpGb3IgYSBtb3JlIGluIGRlcHRoIGRpc2N1c3Npb24gb2YgZXhwZXJpbWVudGFsIGRlc2lnbiBjb25zaWRlcmF0aW9ucywgcGFydGljdWxhcmx5IGZvciB0aGUgbnVtYmVyIG9mIHJlcGxpY2F0ZXMsIHBsZWFzZSByZWFkIFtBIEJlZ2lubmVy4oCZcyBHdWlkZSB0byBBbmFseXNpcyBvZiBSTkEgU2VxdWVuY2luZyBEYXRhXShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L3BtYy9hcnRpY2xlcy9QTUM2MDk2MzQ2Lykgb3IgcGFwZXJzIGxpa2UgdGhpcyBvbmUgYnkgW0hhcnQgZXQgYWxdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzM4NDI4ODQvKSB0aGF0IGZvY3VzIG9uIGVzdGltYXRpbmcgc3RhdGlzdGljYWwgcG93ZXIgZm9yIFJOQS1zZXEgZXhwZXJpbWVudHMuCgoKIyMjIFNhbXBsZSB0YWJsZSBmb3JtYXR0aW5nCgpOZXh0LCB3ZSdsbCBmb3JtYXQgb3VyIHRhYmxlIHNvIHRoYXQgd2UgaGF2ZSB0aGUgYXBwcm9wcmlhdGUgZGF0YSB0eXBlIChhbiBvcmRlcmVkIFtmYWN0b3JdKGh0dHBzOi8vc3djYXJwZW50cnkuZ2l0aHViLmlvL3Itbm92aWNlLWluZmxhbW1hdGlvbi8xMi1zdXBwLWZhY3RvcnMvKSkgZm9yIERFU2VxMiB0byByZWNvZ25pemUgb3VyIHRyZWF0bWVudCBncm91cHMgYW5kIGFwcHJvcHJpYXRlbHkgY29tcGFyZSBzYW1wbGVzLgoKYGBge3IgZWNobyA9IEZBTFNFLCBldmFsID0gRkFMU0V9CiMgQ29uc2lkZXIgY29weWluZyBzYW1wbGUgc2hlZXQgJiB1cGRhdGluZy9tdXRhdGluZyBjb25kaXRpb24gY29sdW1uIHRvIGJlIGEgZmFjdG9yCmBgYAoKYGBge3IgU2FtcGxlc2hlZXRGYWN0b3J9CiMgdGlkeSB2ZXJzaW9uCnNhbXBsZXNoZWV0X3JlYWR5IDwtIHNhbXBsZXNoZWV0ICU+JSBtdXRhdGUoY29uZGl0aW9uID0gZmFjdG9yKGNvbmRpdGlvbiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoJ2NvbnRyb2wnLCAnZGVmaWNpZW50JykpKQoKIyBiYXNlIHZlcnNpb24Kc2FtcGxlc2hlZXRfcmVhZHkgPC0gc2FtcGxlc2hlZXQKc2FtcGxlc2hlZXRfcmVhZHkkY29uZGl0aW9uID0gZmFjdG9yKHNhbXBsZXNoZWV0X3JlYWR5JGNvbmRpdGlvbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVscyA9IGMoJ2NvbnRyb2wnLCAnZGVmaWNpZW50JykpCgp1bmlxdWUoc2FtcGxlc2hlZXRfcmVhZHkkY29uZGl0aW9uKQpgYGAKCk5vdGljZSB0aGF0IHdlIHNldCB0aGUgbGV2ZWxzIGluIGEgcGFydGljdWxhciBvcmRlci4gVGhpcyBpcyBpbXBvcnRhbnQgZm9yIHNldHRpbmcgdGhlICJDb250cm9sIiAob3IgIlJlZmVyZW5jZSIpIGdyb3VwIGFzIHRoZSBkZW5vbWluYXRvciBpbiB0aGUgZGVmYXVsdCBjb21wYXJpc29ucyB3aGVuIHdlIHNldHVwIG91ciBERVNlcTIgbW9kZWwuCgpCZWZvcmUgd2UgcHJvY2VlZCwgd2UgbmVlZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgc2FtcGxlIGxhYmVscyAoY29sdW1uIG5hbWVzKSBpbiB0aGUgY291bnQgdGFibGUgbWF0Y2ggdGhlIHNhbXBsZSBpbmZvcm1hdGlvbiB0YWJsZSAocm93IG5hbWVzKSwgaW5jbHVkaW5nIHRoZSBvcmRlci4gSWYgdGhlIHNhbXBsZSBsYWJlbHMgZG9uJ3QgbWF0Y2gsIHRoZW4gd2Ugd2lsbCBzZWUgYW4gZXJyb3IgYW5kIG5lZWQgdG8gY29ycmVjdCB0aGUgbGFiZWxzIHByaW9yIHRvIHByb2NlZWRpbmcuIENoZWNraW5nIHRoZSBzYW1wbGUgaW5mb3JtYXRpb24gdGFibGUgaXMgZXh0cmVtZWx5IGltcG9ydGFudCB0byBlbnN1cmUgdGhhdCB0aGUgY29ycmVjdCBzYW1wbGVzIGFyZSBncm91cGVkIHRvZ2V0aGVyIGZvciBjb21wYXJpc29ucy4KCmBgYHtyIENoZWNrU2FtcGxlc2hlZXR9CmFsbChjb2xuYW1lcyhjb3VudF90YWJsZSkgPT0gcm93bmFtZXMoc2FtcGxlc2hlZXRfcmVhZHkpKQpgYGAKVGhpcyBsaW5lIG9mIGNvZGUgY2hlY2tzIGlmIGJvdGggdGhlIGlkZW50aXR5IGFuZCBvcmRlciBtYXRjaCBiZXR3ZWVuIG91ciBgY291bnRfdGFibGVgIGFuZCBvdXIgYHNhbXBsZXNoZWV0YC4gSWYsIGluIHRoZSBjb3Vyc2Ugb2YgdXNpbmcgeW91ciBvd24gZGF0YSwgdGhpcyByZXR1cm5zIGBGQUxTRWAsIHRyeSB1c2luZyB0aGUgYG1hdGNoKClgIGZ1bmN0aW9uIHRvIHJlYXJyYW5nZSB0aGUgY29sdW1ucyBvZiBgY291bnRfdGFibGVgIChvciB0aGUgcm93cyBvZiBgc2FtcGxlc2hlZXRgKSB0byBnZXQgdGhlbSB0byBtYXRjaC4KCioqQ2hlY2twb2ludCoqOiAqSWYgeW91IHlvdXIgc2FtcGxlIGluZm8gY2hlY2sgcmV0dXJucyBgVFJVRWAsIHBsZWFzZSBpbmRpY2F0ZSB3aXRoIHRoZSBncmVlbiAneWVzJyBidXR0b24uIE90aGVyd2lzZSwgcGxlYXNlIHVzZSB0aGUgcmVkICd4JyBidXR0b24gdG8gaGF2ZSB0aGUgY29tbWFuZCByZXBlYXRlZCoKCiMgQ3JlYXRpbmcgREVTZXEyIG9iamVjdAoKQmlvY29uZHVjdG9yIHNvZnR3YXJlIHBhY2thZ2VzIG9mdGVuIGRlZmluZSBhbmQgdXNlIGN1c3RvbSBzdHJ1Y3R1cmVzIHRvIHN0b3JlIGRhdGEgaW4gYSB3YXkgdGhhdCBzdWl0cyBiaW9sb2dpY2FsIGRhdGEsIHN1Y2ggYXMgaWxsdXN0cmF0ZWQgYmVsb3cgZnJvbSBbSHViZXIgZXQgYWwuIDIwMTVdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvbm1ldGguMzI1MikuCgohW0EgYnJlYWtkb3duIG9mIHRoZSBTdW1tYXJpemVkRXhwZXJpbWVudCBjbGFzcy5dKC4vaW1hZ2VzL1N1bW1hcml6ZWRFeHBlcmltZW50LmpwZykKClRoZXNlIGN1c3RvbSBkYXRhIHN0cnVjdHVyZXMgaGF2ZSBwcmUtZGVmaW5lZCBkYXRhIHNsb3RzLCB3aGljaCBob2xkIHNwZWNpZmljIHR5cGVzL2NsYXNzZXMgb2YgZGF0YSBhbmQgdGhlcmVmb3JlIGNhbiBiZSBtb3JlIGVhc2lseSBhY2Nlc3NlZCBieSBmdW5jdGlvbnMgZnJvbSB0aGUgc2FtZSBwYWNrYWdlLgoKVG8gY3JlYXRlIHRoZSBERVNlcURhdGFTZXQgd2UgbmVlZCB0d28gaW1wb3J0YW50IGlucHV0czoKCjEuIEEgdGFibGUgdGhhdCBhc3NpZ25zIHRoZSBjb25kaXRpb24gbGFiZWxzIGZvciBlYWNoIHNhbXBsZSAodGhhdCB3ZSByZWFkIGluIGFuZCBmb3JtYXR0ZWQpCjEuIEEgKnJhdyogY291bnQgbWF0cml4CgpJcyBvdXIgY291bnQgbWF0cml4IGZyb20gb3VyIFJTRU0gb3V0cHV0cyBjb25zaWRlcmVkIGEgInJhdyIgY291bnQgbWF0cml4IGJ5IERFU2VxMj8KCj4gIyBFeGVyY2lzZTogUlNFTSBvdXRwdXRzIHZlcnN1cyBERVNlcTIgaW5wdXQgcmVxdWlyZW1lbnRzIHsudW5saXN0ZWQgLnVubnVtYmVyZWR9Cj4KPiBJZiB3ZSB0aGluayBiYWNrIHRvIHRoZSBSU0VNIG91dHB1dHMsIHRoZSAnZXhwZWN0ZWRfY291bnRzJyB0YWJsZSBtYXkgaW5jbHVkZSBmcmFjdGlvbmFsIGFtb3VudHMgZHVlIHRvIGhvdyB0aGUgYWxpZ25tZW50IHRvb2wgcmVzb2x2ZXMgcmVhZHMgbWFwcGluZyB0byBtdWx0aXBsZSBsb2N1c2VzKS4gREVTZXEyIGlzIGV4cGVjdGluZyB0aGUgY291bnQgbWF0cml4IHRvIGNvbnNpc3Qgb25seSBvZiB3aG9sZSBudW1iZXJzLiBSZWNlbnQgdmVyc2lvbnMgb2YgREVTZXEyIHdpbGwgaGFuZGxlIHRoaXMgZm9yIHVzLCBidXQgcHJldmlvdXMgdmVyc2lvbnMgZGlkIG5vdC4KPgo+IFdoYXQgUiBmdW5jdGlvbiwgdGhhdCB3ZSBzYXcgaW4gQ29tcHV0YXRpb25hbCBGb3VuZGF0aW9ucywgY291bGQgd2UgdXNlIHRvIGNvbnZlcnQgdGhlIGZyYWN0aW9uYWwgdmFsdWVzIGluIGBjb3VudF90YWJsZWAgdG8gaW50ZWdlcnM/Cgo8ZGV0YWlscz4KPHN1bW1hcnk+U29sdXRpb248L3N1bW1hcnk+CgpXZSBjYW4gdXNlIHRoZSBgcm91bmQoKWAgZnVuY3Rpb246CgpgYGB7ciByb3VuZCBjb3VudF90YWJsZX0KY291bnRzX3JvdW5kZWQgPSByb3VuZChjb3VudF90YWJsZSkKYGBgCjwvZGV0YWlscz4KPGJyPgoKVG8gY3JlYXRlIHRoZSBgREVTZXFEYXRhU2V0YCB3ZSB3aWxsIG5lZWQgdGhlIGBjb3VudF90YWJsZWAgYW5kIHRoZSBgc2FtcGxlc2hlZXRgLiBXZSB3aWxsIGFsc28gbmVlZCBhICoqZGVzaWduIGZvcm11bGEqKiB0byBzcGVjaWZ5IG91ciBtb2RlbC4KCiMjIE1ha2luZyBtb2RlbCBjaG9pY2VzCgpUaGUgZGVzaWduIGZvcm11bGEgc3BlY2lmaWVkIGluZm9ybXMgbWFueSBvZiB0aGUgREVTZXEyIGZ1bmN0aW9ucyBob3cgdG8gdHJlYXQgdGhlIHNhbXBsZXMgaW4gdGhlIGFuYWx5c2lzLCBzcGVjaWZpY2FsbHkgd2hpY2ggY29sdW1uKHMpIGluIHRoZSBzYW1wbGUgbWV0YWRhdGEgdGFibGUgYXJlIHJlbGV2YW50IHRvIHRoZSBleHBlcmltZW50YWwgZGVzaWduLgoKSW4gdGhpcyBjYXNlLCB3ZSBhcmVuJ3QgYXdhcmUgb2YgYW55IFtjb3ZhcmlhdGVzXShodHRwczovL21ldGhvZHMtc2FnZXB1Yi1jb20ucHJveHkubGliLnVtaWNoLmVkdS9yZWZlcmVuY2UvZW5jeWMtb2YtcmVzZWFyY2gtZGVzaWduL244NS54bWwpIHRoYXQgc2hvdWxkIGJlIGNvbnNpZGVyZWQgaW4gb3VyIGNvbXBhcmlzb25zLiBIb3dldmVyLCBpZiB0aGVyZSBhcmUgYWRkaXRpb25hbCBhdHRyaWJ1dGVzIG9mIHRoZSBzYW1wbGVzIHRoYXQgbWF5IGltcGFjdCB0aGUgREUgY29tcGFyaXNvbnMsIGxpa2UgZGF0ZSBvZiBjb2xsZWN0aW9uLCBzZXgsIG9yIHBhdGllbnQgb2Ygb3JpZ2luLCB0aGVzZSBzaG91bGQgYmUgYWRkZWQgYXMgW2FkZGl0aW9uYWwgY29sdW1uc10oaHR0cHM6Ly9zdXBwb3J0LmJpb2NvbmR1Y3Rvci5vcmcvcC83NTMwOS8pIGluIHRoZSBzYW1wbGUgaW5mb3JtYXRpb24gdGFibGUgYW5kIFthZGRlZCB0byBhIGRlc2lnbiBmb3JtdWxhXShodHRwczovL3N1cHBvcnQuYmlvY29uZHVjdG9yLm9yZy9wLzk4NzAwLykuCgpNb3JlIGNvbXBsZXggcXVlc3Rpb25zLCBpbmNsdWRpbmcgYWRkaW5nICJpbnRlcmFjdGlvbiB0ZXJtcyIgYmV0d2VlbiBtdWx0aXBsZSBncm91cCBsYWJlbHMgYXJlIGhlbHBmdWxseSBkZXNjcmliZWQgaW4gW3RoaXMgc3VwcG9ydCB0aHJlYWRdKGh0dHBzOi8vc3VwcG9ydC5iaW9jb25kdWN0b3Iub3JnL3AvOTg2MjgvKSBhcyB3ZWxsIGFzIGluIHRoZSBbREVTZXEyIHZpZ25ldHRlXShodHRwczovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvcmVsZWFzZS9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwjaW50ZXJhY3Rpb25zKSwgd2hpY2ggaXMgYW4gZXhjZWxsZW50IGRvY3VtZW50LgoKVGhlIGRlc2lnbiBmb3JtdWxhIHNwZWNpZmllcyB0aGUgY29sdW1uKHMpIGluIHRoZSBtZXRhZGF0YSB0YWJsZSBhbmQgaG93IHRoZXkgc2hvdWxkIGJlIHVzZWQgaW4gdGhlIGFuYWx5c2lzLiBGb3Igb3VyIGRhdGFzZXQgd2Ugb25seSBoYXZlIG9uZSBjb2x1bW4gd2UgYXJlIGludGVyZXN0ZWQgaW4sIHRoYXQgaXMgYGNvbmRpdGlvbmAuIFRoaXMgY29sdW1uIGhhcyB0d28gZmFjdG9yIGxldmVscywgd2hpY2ggdGVsbHMgREVTZXEyIHRoYXQgZm9yIGVhY2ggZ2VuZSB3ZSB3YW50IHRvIGV2YWx1YXRlIGdlbmUgZXhwcmVzc2lvbiBjaGFuZ2Ugd2l0aCByZXNwZWN0IHRvIHRoZXNlIGRpZmZlcmVudCBsZXZlbHMuCgpgYGB7ciBERVNlcTJPYmplY3R9CiMjIENyZWF0ZSBERVNlcSBvYmplY3QsIGxpbmUgYnkgbGluZQpkZHMgPSBERVNlcURhdGFTZXRGcm9tTWF0cml4KGNvdW50RGF0YSA9IGNvdW50c19yb3VuZGVkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xEYXRhID0gc2FtcGxlc2hlZXRfcmVhZHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2lnbiA9IH4gY29uZGl0aW9uKQpkZHMKYGBgCgpOb3RpY2UgdGhhdCBwcmludGluZyB0aGUgYGRkc2Agb2JqZWN0IGhlbHBmdWxseSBzaG93cyB1cyBzb21lIGhlbHBmdWwgaW5mb3JtYXRpb246CgoqIFRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBnZW5lcyBieSBudW1iZXIgb2Ygc2FtcGxlcyksCiogVGhlIGdlbmUgaWRlbnRpZmllcnMsCiogVGhlIHNhbXBsZSBpZGVudGlmaWVycywKKiBUaGUgYWRkaXRpb25hbCBjb2x1bW4gbmFtZXMgZ2l2aW5nIGluZm9ybWF0aW9uIGFib3V0IHRoZSBzYW1wbGVzCgoqKkNoZWNrcG9pbnQqKjogKklmIHlvdSBzZWUgYGRkc2AgaW4geW91ciBlbnZpcm9ubWVudCBwYW5lbCwgcGxlYXNlIGluZGljYXRlIHdpdGggdGhlIGdyZWVuICdjaGVjaycgYnV0dG9uLiBPdGhlcndpc2UsIHBsZWFzZSB1c2UgIHVzZSB0aGUgcmVkICd4JyBidXR0b24gaW4geW91ciB6b29tIHJlYWN0aW9uIHBhbmVsIHRvIGhhdmUgdGhpcyBzdGVwIHJlcGVhdGVkLiBZb3UgY2FuIHVzZSB0aGUgcmVkICd4JyB0byBiZSBwdXQgaW4gYSBicmVha291dCByb29tIGZvciBoZWxwKgoKLS0tCgoKIyBQcmUtZmlsdGVyaW5nCgpXaGlsZSBub3QgbmVjZXNzYXJ5LCBbcHJlLWZpbHRlcmluZ10oaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI3ByZS1maWx0ZXJpbmcpIHRoZSBjb3VudCB0YWJsZSBoZWxwcyB0byBub3Qgb25seSByZWR1Y2UgdGhlIHNpemUgb2YgdGhlIERFU2VxMiBvYmplY3QsIGJ1dCBhbHNvIGdpdmVzIHlvdSBhIHNlbnNlIG9mIGhvdyBtYW55IGdlbmVzIHdlcmUgcmVhc29uYWJseSBtZWFzdXJlZCBhdCB0aGUgc2VxdWVuY2luZyBkZXB0aCBnZW5lcmF0ZWQgZm9yIHlvdXIgc2FtcGxlcy4KCkhlcmUgd2Ugd2lsbCBmaWx0ZXIgb3V0IGFueSBnZW5lcyB0aGF0IGhhdmUgbGVzcyB0aGFuIDEwIGNvdW50cyBhY3Jvc3MgYW55IG9mIHRoZSBzYW1wbGVzLiBUaGlzIGlzIGEgZmFpcmx5IHN0YW5kYXJkIGxldmVsIG9mIGZpbHRlcmluZywgYnV0IGNhbiBmaWx0ZXIgZGF0YSBsZXNzL21vcmUgZGVwZW5kaW5nIG9uIHF1YWxpdHkgY29udHJvbCBtZXRyaWNzIGZyb20gYWxpZ25tZW50cyBhbmQgc2VxdWVuY2luZyBkZXB0aCBvciB0b3RhbCBudW1iZXIgb2Ygc2FtcGxlcy4KCmBgYHtyIFByZUZpbHRlcn0Ka2VlcCA9IHJvd1N1bXMoY291bnRzKGRkcykpID49IDEwCmRkc19maWx0ZXJlZCA9IGRkc1trZWVwLF0KZGRzX2ZpbHRlcmVkCmBgYAoKTm90aWNlIHRoZSBgZGRzX2ZpbHRlcmVkYCBvYmplY3QgaGFzIGxlc3MgZWxlbWVudHMgdGhhbiB0aGUgdW5maWx0ZXJlZCBgZGRzYCBvYmplY3QsIGluZGljYXRpbmcgdGhhdCBhIG51bWJlciBvZiBnZW5lcyB3ZXJlIG5vdCBtZWFzdXJlZCBpbiBvdXIgZXhwZXJpbWVudC4KCioqQ2hlY2twb2ludCoqOiAqUXVlc3Rpb25zPyoKCiMgT3B0aW9uYWwgY29udGVudAoKPGRldGFpbHM+CiAgICA8c3VtbWFyeT4qQ2xpY2sgZm9yIGhvdyB0byBtb2RlbCBiYXRjaCBlZmZlY3RzIHdpdGggREVTZXEyKjwvc3VtbWFyeT4KCiAgICBEaWZmZXJlbmNlcyBiZXR3ZWVuIHNhbXBsZXMgY2FuIGFsc28gYmUgZHVlIHRvIHRlY2huaWNhbCByZWFzb25zLCBzdWNoIGFzIGNvbGxlY3Rpb24gb24gZGlmZmVyZW50IGRheXMgb3IgZGlmZmVyZW50IHNlcXVlbmNpbmcgcnVucy4gRGlmZmVyZW5jZXMgYmV0d2VlbiBzYW1wbGVzIHRoYXQgYXJlIG5vdCBkdWUgdG8gYmlvbG9naWNhbCBmYWN0b3JzIGFzIGNhbGxlZCAqKmJhdGNoIGVmZmVjdHMqKi4gV2UgY2FuIGluY2x1ZGUgYmF0Y2ggZWZmZWN0cyBpbiBvdXIgZGVzaWduIG1vZGVsIGluIHRoZSBzYW1lIHdheSBhcyBjb3ZhcmlhdGVzLCBhcyBsb25nIGFzIHRoZSB0ZWNobmljYWwgZ3JvdXBzIGRvIG5vdCBvdmVybGFwLCBvciAqKmNvbmZvdW5kKiosIHRoZSBiaW9sb2dpY2FsIHRyZWF0bWVudCBncm91cHMuCgogICAgTGV0J3MgdHJ5IGFkZCBzb21lIGFkZGl0aW9uYWwgbWV0YS1kYXRhIGluZm9ybWF0aW9uIHdoZXJlIHdlIGhhdmUgY291bmZvdW5kaW5nIGJhdGNoIGVmZmVjdHMgYW5kIGNyZWF0ZSBhbm90aGVyIERFU2VxMiBvYmplY3QuCgpgYGB7ciBDb25mb3VuZGVyc30Kc2FtcGxlc2hlZXRfYmF0Y2ggPSBzYW1wbGVzaGVldF9yZWFkeQpzYW1wbGVzaGVldF9iYXRjaCRiYXRjaCA9IGZhY3RvcihjKHJlcChjKCJEYXkxIiwgIkRheTIiLCAiRGF5MyIpLCAyKSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCJEYXkxIiwgIkRheTIiLCAiRGF5MyIpKQoKZGRzX2JhdGNoID0gREVTZXFEYXRhU2V0RnJvbU1hdHJpeChjb3VudERhdGEgPSBjb3VudHNfcm91bmRlZCwKICAgICAgICAgICAgICAgICAgICAgIGNvbERhdGEgPSBzYW1wbGVzaGVldF9iYXRjaCwKICAgICAgICAgICAgICAgICAgICAgIGRlc2lnbiA9IH4gYmF0Y2ggKyBjb25kaXRpb24pCmBgYAo8L2RldGFpbHM+Cjxicj4KCiMgU3VtbWFyeQoKSW4gdGhpcyBzZWN0aW9uLCB3ZToKCiogTG9hZGVkIHRoZSBuZWNlc3NhcnkgaW5wdXQgZmlsZXMgaW50byBvdXIgUiBzZXNzaW9uCiogRGlzY3Vzc2VkIG1vZGVsIGRlc2lnbiBmb3IgREVTZXEyCiogSW5pdGlhbGl6ZWQgYSBERVNlcTIgZGF0YSBzZXQKKiBGaWx0ZXJlZCBvdXIgY291bnQgZGF0YQoKTm93IHRoYXQgd2UndmUgY3JlYXRlZCBvdXIgREVTZXEyIG9iamVjdHMsIGluY2x1ZGluZyBzcGVjaWZ5aW5nIHdoYXQgbW9kZWwgaXMgYXBwcm9wcmlhdGUgZm9yIG91ciBkYXRhLCBhbmQgZmlsdGVyZWQgb3VyIGRhdGEsIHdlIGNhbiBwcm9jZWVkIHdpdGggYXNzZXNzaW5nIHRoZSBpbXBhY3Qgb2YgdGhlIGV4cGVyaW1lbnRhbCBjb25kaXRpb25zIG9uIGdlbmUgZXhwcmVzc2lvbiBmb3Igb3VyIHNhbXBsZXMuCgotLS0KCiMgU291cmNlcwoKVHJhaW5pbmcgcmVzb3VyY2VzIHVzZWQgdG8gZGV2ZWxvcCBtYXRlcmlhbHM6CgoqIEhCQyBER0Ugc2V0dXA6IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzAxX0RHRV9zZXR1cF9hbmRfb3ZlcnZpZXcuaHRtbAoqIEhCQyBDb3VudCBOb3JtYWxpemF0aW9uOiBodHRwczovL2hiY3RyYWluaW5nLmdpdGh1Yi5pby9ER0Vfd29ya3Nob3AvbGVzc29ucy8wMl9ER0VfY291bnRfbm9ybWFsaXphdGlvbi5odG1sCiogREVTZXEyIHN0YW5kYXJkIHZpZ25ldHRlOiBodHRwOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9kZXZlbC9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwKKiBERVNlcTIgYmVnaW5uZXJzIHZpZ25ldHRlOiBodHRwczovL2Jpb2MuaXNtLmFjLmpwL3BhY2thZ2VzLzIuMTQvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL2JlZ2lubmVyLnBkZgoqIEJpb2NvbmR1Y3RvciBSTkEtc2VxIFdvcmtmbG93czogaHR0cHM6Ly93d3cuYmlvY29uZHVjdG9yLm9yZy9oZWxwL2NvdXJzZS1tYXRlcmlhbHMvMjAxNS9MZWFybkJpb2NvbmR1Y3RvckZlYjIwMTUvQjAyLjFfUk5BU2VxLmh0bWwKKiBDQ0RMIEdhc3RyaWMgY2FuY2VyIHRyYWluaW5nIG1hdGVyaWFsczogaHR0cHM6Ly9hbGV4c2xlbW9uYWRlLmdpdGh1Yi5pby90cmFpbmluZy1tb2R1bGVzL1JOQS1zZXEvMDMtZ2FzdHJpY19jYW5jZXJfZXhwbG9yYXRvcnkubmIuaHRtbAoqIENDREwgTmV1cm9ibGFzdG9tYSB0cmFpbmluZyBtYXRlcmlhbHM6IGh0dHBzOi8vYWxleHNsZW1vbmFkZS5naXRodWIuaW8vdHJhaW5pbmctbW9kdWxlcy9STkEtc2VxLzA1LW5iX2NlbGxfbGluZV9ERVNlcTIubmIuaHRtbAoKCgpgYGB7ciBXcml0ZU91dC5SRGF0YSwgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQojIEhpZGRlbiBjb2RlIGJsb2NrIHRvIHdyaXRlIG91dCBkYXRhIGZvciBrbml0dGluZwojIHNhdmUuaW1hZ2UoZmlsZSA9ICJyZGF0YS9SdW5uaW5nRGF0YS5SRGF0YSIpCmBgYAoKLS0tCgpUaGVzZSBtYXRlcmlhbHMgaGF2ZSBiZWVuIGFkYXB0ZWQgYW5kIGV4dGVuZGVkIGZyb20gbWF0ZXJpYWxzIGxpc3RlZCBhYm92ZS4gVGhlc2UgYXJlIG9wZW4gYWNjZXNzIG1hdGVyaWFscyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIFtDcmVhdGl2ZSBDb21tb25zIEF0dHJpYnV0aW9uIGxpY2Vuc2UgKENDIEJZIDQuMCldKGh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzQuMC8pLCB3aGljaCBwZXJtaXRzIHVucmVzdHJpY3RlZCB1c2UsIGRpc3RyaWJ1dGlvbiwgYW5kIHJlcHJvZHVjdGlvbiBpbiBhbnkgbWVkaXVtLCBwcm92aWRlZCB0aGUgb3JpZ2luYWwgYXV0aG9yIGFuZCBzb3VyY2UgYXJlIGNyZWRpdGVkLgoKPGJyLz4KPGJyLz4KPGhyLz4KfCBbUHJldmlvdXMgbGVzc29uXShNb2R1bGUwNl9ERUFuYWx5c2lzU2V0dXAuaHRtbCkgfCBbVG9wIG9mIHRoaXMgbGVzc29uXSgjdG9wKSB8IFtOZXh0IGxlc3Nvbl0oTW9kdWxlMDhfREVTZXEyREUuaHRtbCkgfAp8IDotLS0gfCA6LS0tLTogfCAtLS06IHwK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module07_DESeq2Init.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
